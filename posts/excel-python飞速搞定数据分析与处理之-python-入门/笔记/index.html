<!doctype html>
<html
  lang="zh-cn"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="light"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="zh-cn">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  <title> &middot; Cloud_Shy</title>
    <meta name="title" content=" &middot; Cloud_Shy">

  
  
  
  
  
  <link rel="canonical" href="http://localhost:1313/posts/excel-python%E9%A3%9E%E9%80%9F%E6%90%9E%E5%AE%9A%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%84%E7%90%86%E4%B9%8B-python-%E5%85%A5%E9%97%A8/%E7%AC%94%E8%AE%B0/">
  
  
  
  
  
  
  
  
  
  
    
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.d7672814413dccdcf76c504d9b0ebb8d0f964dbe6b30a3d4b25b15809a94c2eb732d99898aded2009aacdd1fa8b17cea1369fd81560790cd355aee00bbd142fd.css"
    integrity="sha512-12coFEE9zNz3bFBNmw67jQ&#43;WTb5rMKPUslsVgJqUwutzLZmJit7SAJqs3R&#43;osXzqE2n9gVYHkM01Wu4Au9FC/Q==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
    
    
    
  
  
    
    
  
  
  
  
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.98bb8ce8f123e03c4d2171eeec151dd404b5c476beb5ef1068d0e8b1a2afb923065e6552fc14b2d867c85ee4bd8529a43193f729f874d3908517ba03b5d1cc57.js"
      integrity="sha512-mLuM6PEj4DxNIXHu7BUd1AS1xHa&#43;te8QaNDosaKvuSMGXmVS/BSy2GfIXuS9hSmkMZP3Kfh005CFF7oDtdHMVw=="
      data-copy="复制"
      data-copied="已复制"></script>
  
  
    
    <script src="/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js" integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7&#43;kfJ6kKCJxQGC&#43;8wm&#43;Bz9JucDjDTGNew=="></script>
  

  
  
    
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">

<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">

<link rel="manifest" href="/site.webmanifest">

<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<link rel="shortcut icon" href="/favicon.ico">

<meta name="msapplication-TileColor" content="#2b5797">
<meta name="msapplication-TileImage" content="/mstile-150x150.png">
<meta name="theme-color" content="#ffffff">

  

  
  
  
  
  
  

  
  <meta property="og:url" content="http://localhost:1313/posts/excel-python%E9%A3%9E%E9%80%9F%E6%90%9E%E5%AE%9A%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%84%E7%90%86%E4%B9%8B-python-%E5%85%A5%E9%97%A8/%E7%AC%94%E8%AE%B0/">
  <meta property="og:site_name" content="Cloud_Shy">
  <meta property="og:title" content="Cloud_Shy">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Cloud_Shy">

  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "",
    "headline": "",
    
    
    "inLanguage": "zh-cn",
    "url" : "http:\/\/localhost:1313\/posts\/excel-python%E9%A3%9E%E9%80%9F%E6%90%9E%E5%AE%9A%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%84%E7%90%86%E4%B9%8B-python-%E5%85%A5%E9%97%A8\/%E7%AC%94%E8%AE%B0\/",
    "author" : {
      "@type": "Person",
      "name": "Cloud_Shy"
    },
    
    
    
    
    
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "5032"
  }]
  </script>



  
  
    <meta name="author" content="Cloud_Shy">
  
  

  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>























  
  





  
  

  
  

  
  
    
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script>

    const firebaseConfig = {
      apiKey: "AIzaSyCdOq7GCWM9mQ6wcPBrZownl3-Vvuu9sDY",
      authDomain: "AIzaSyCdOq7GCWM9mQ6wcPBrZownl3-Vvuu9sDY",
      projectId: "cloudshy-c7aef",
      storageBucket: "cloudshy-c7aef.firebasestorage.app",
      messagingSenderId: "95154075478",
      appId: "1:95154075478:web:9440ee157af53a714388f7",
      measurementId: "G-9DTZD8RRGP"
    };

    var app = firebase.initializeApp(firebaseConfig);
    var db = firebase.firestore();
    var auth = firebase.auth();

  </script>
    
  

  
  
</head>
<body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>
        跳过正文
      </a>
    </div>
    
    
      <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px] z-100">
  <div
    id="menu-blur"
    class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom bg-neutral dark:bg-neutral-800"></div>
  <div class="relative max-w-[64rem] ml-auto mr-auto">
    













<div
  class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0">
  
  
    
    
      <div>
        <a href="/" class="flex">
          <span class="sr-only">Cloud_Shy</span>
          
            <img
              src="/img/logo.png"
              width="32"
              height="32"
              class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom"
              alt="Cloud_Shy">
          
        </a>
      </div>
    

  <div class="flex flex-1 items-center justify-between">
    <nav class="flex space-x-3">
      
        <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">
          Cloud_Shy
        </a>
      
    </nav>
    
  <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">
    
      
        
  <a
  href="/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="欢迎来到 Cloud_Shy! :tada:">
    主页
  </p>
</a>



      
        
  <a
  href="/archives/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="历史文档">
    归档
  </p>
</a>



      
        
  <div>
  <div class="cursor-pointer flex items-center nested-menu">
    
    <a
      
        href="/categories/"
        
      
      class="text-base font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"
      title="Categories">
      <p>
        分类
      </p>
    </a>
    <span>
      <span class="relative block icon"><svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>
</span>
    </span>
  </div>
  <div class="absolute menuhide">
    <div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl">
      <div class="flex flex-col space-y-3">
        
          <a
            href="/posts/"
            
            class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
            
            <p class="text-sm font-sm" title="Posts">
              我的学习笔记
            </p>
          </a>
        
          <a
            href="/posts/"
            
            class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
            
            <p class="text-sm font-sm" title="Posts">
              新手入门教程集合
            </p>
          </a>
        
      </div>
    </div>
  </div>
</div>



      
        
  <a
  href="/tags/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="Tags">
    标签
  </p>
</a>



      
    

    

    

    
      <button
        id="search-button"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="搜索 (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <div class=" flex items-center">
        <button
          id="appearance-switcher"
          aria-label="Dark mode switcher"
          type="button"
          class="text-base hover:text-primary-600 dark:hover:text-primary-400">
          <div class="flex items-center justify-center dark:hidden">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
          </div>
          <div class="items-center justify-center hidden dark:flex">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
          </div>
        </button>
      </div>
    
  </nav>

    
  <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">
    <span></span>

    

    

    
      <button
        id="search-button-mobile"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="搜索 (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <button
        id="appearance-switcher-mobile"
        aria-label="Dark mode switcher"
        type="button"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1">
        <div class="flex items-center justify-center dark:hidden">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
        </div>
        <div class="items-center justify-center hidden dark:flex">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
        </div>
      </button>
    
  </div>

  </div>
  
  <div class="-my-2 md:hidden">
    <div id="menu-button" class="block">
      
        <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
        </div>
        <div
          id="menu-wrapper"
          class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]">
          <ul
            class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">
            <li id="menu-close-button">
              <span
                class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
                <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
              </span>
            </li>

            
              
  <li class="mt-1">
  <a
    href="/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="欢迎来到 Cloud_Shy! :tada:">
      主页
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/archives/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="历史文档">
      归档
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/categories/"
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="Categories">
      分类
    </p>
    <span>
      <span class="relative block icon"><svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>
</span>
    </span>
  </a>
</li>

  <li class="mt-1">
    <a
      href="/posts/"
      
      class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
      
      <p class="text-sm font-small" title="Posts">
        我的学习笔记
      </p>
    </a>
  </li>

  <li class="mt-1">
    <a
      href="/posts/"
      
      class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
      
      <p class="text-sm font-small" title="Posts">
        新手入门教程集合
      </p>
    </a>
  </li>

<li class="mb-2"></li>



            
              
  <li class="mt-1">
  <a
    href="/tags/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="Tags">
      标签
    </p>
  </a>
</li>



            

          </ul>
          
        </div>
      
    </div>
  </div>

</div>





  </div>
</div>


<script
  type="text/javascript"
  src="/js/background-blur.min.0ad33cb9c066f652728b2cc09c9ceaf32645544f48e8b6b38f120d86f433ed997da275a49e6151fe0176430c45376812708d84727f3f969101fb44a4345b3f34.js"
  integrity="sha512-CtM8ucBm9lJyiyzAnJzq8yZFVE9I6LazjxINhvQz7Zl9onWknmFR/gF2QwxFN2gScI2Ecn8/lpEB&#43;0SkNFs/NA=="
  data-target-id="menu-blur"></script>

    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  
    
  

  
  
    
  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="0001-01-01T00:00:00&#43;00:00">0001-01-1</time><span class="px-2 text-primary-500">&middot;</span><span>5032 字</span><span class="px-2 text-primary-500">&middot;</span><span title="预计阅读">24 分钟</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span
    id="views_posts\Excel Python：飞速搞定数据分析与处理之 Python 入门\笔记.md"
    class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400"
    title="views"
    >loading</span
  >
  <span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span>
</span>
<span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span
    id="likes_posts\Excel Python：飞速搞定数据分析与处理之 Python 入门\笔记.md"
    class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400"
    title="likes"
    >loading</span
  >
  <span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg></span></span>
</span>
<span class="px-2 text-primary-500">&middot;</span><span>
  <button
    id="button_likes"
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    <span id="button_likes_heart" class="inline-block align-text-bottom hidden"
      ><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg></span>
    </span>
    <span id="button_likes_emtpty_heart" class="inline-block align-text-bottom"
      ><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M244 84L255.1 96L267.1 84.02C300.6 51.37 347 36.51 392.6 44.1C461.5 55.58 512 115.2 512 185.1V190.9C512 232.4 494.8 272.1 464.4 300.4L283.7 469.1C276.2 476.1 266.3 480 256 480C245.7 480 235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1 0 232.4 0 190.9V185.1C0 115.2 50.52 55.58 119.4 44.1C164.1 36.51 211.4 51.37 244 84C243.1 84 244 84.01 244 84L244 84zM255.1 163.9L210.1 117.1C188.4 96.28 157.6 86.4 127.3 91.44C81.55 99.07 48 138.7 48 185.1V190.9C48 219.1 59.71 246.1 80.34 265.3L256 429.3L431.7 265.3C452.3 246.1 464 219.1 464 190.9V185.1C464 138.7 430.4 99.07 384.7 91.44C354.4 86.4 323.6 96.28 301.9 117.1L255.1 163.9z"/></svg></span></span
    >
    <span id="button_likes_text">&nbsp;Like</span>
  </button>
</span>
    

    
    
  </div>

  

  
  
    <div class="flex flex-row flex-wrap items-center">
      
        
      
        
          
        
      
        
      
        
          
        
      
    </div>
  

  
  



      </div>
      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      
        <div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
          <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]">
            
              <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    目录
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#第一章-为什么要用python为excel编程">第一章 为什么要用Python为Excel编程</a>
      <ul>
        <li><a href="#11-excel作为一门编程语言">1.1 Excel作为一门编程语言</a>
          <ul>
            <li><a href="#112-编程最佳实践">1.1.2 编程最佳实践</a></li>
            <li><a href="#113-现代excel">1.1.3 现代Excel</a></li>
          </ul>
        </li>
        <li><a href="#12-用在excel上的python">1.2 用在Excel上的Python</a>
          <ul>
            <li><a href="#121-可读性和可维护性">1.2.1 可读性和可维护性</a></li>
            <li><a href="#122-标准库和包管理器">1.2.2 标准库和包管理器</a></li>
            <li><a href="#123-科学计算">1.2.3 科学计算</a></li>
            <li><a href="#125-跨平台兼容性">1.2.5 跨平台兼容性</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#第二章-开发环境">第二章 开发环境</a>
      <ul>
        <li><a href="#21-anaconda-python发行版">2.1 Anaconda Python发行版</a>
          <ul>
            <li><a href="#212-anaconda-prompt">2.1.2 Anaconda Prompt</a></li>
            <li><a href="#213-python-repl交互式python会话">2.1.3 Python REPL：交互式Python会话</a></li>
            <li><a href="#214-包管理器conda-和-pip">2.1.4 包管理器：Conda 和 pip</a></li>
            <li><a href="#215-conda-环境">2.1.5 Conda 环境</a></li>
          </ul>
        </li>
        <li><a href="#22-jupyter笔记本">2.2 Jupyter笔记本</a>
          <ul>
            <li><a href="#221-运行jupyter笔记本">2.2.1 运行Jupyter笔记本</a></li>
            <li><a href="#222-笔记本单元格">2.2.2 笔记本单元格</a></li>
            <li><a href="#223-编辑模式与命令模式">2.2.3 编辑模式与命令模式</a></li>
            <li><a href="#224-执行顺序很重要">2.2.4 执行顺序很重要</a></li>
            <li><a href="#225-关闭jupyter笔记本">2.2.5 关闭Jupyter笔记本</a></li>
          </ul>
        </li>
        <li><a href="#23-vs-code">2.3 VS Code</a>
          <ul>
            <li><a href="#231-安装和配置">2.3.1 安装和配置</a></li>
            <li><a href="#232-执行python脚本">2.3.2 执行Python脚本</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#第三章-python-入门">第三章 Python 入门</a>
      <ul>
        <li><a href="#31-数据类型">3.1 数据类型</a>
          <ul>
            <li><a href="#311-对象">3.1.1 对象</a></li>
            <li><a href="#312-数值类型">3.1.2 数值类型</a></li>
            <li><a href="#313-布尔值">3.1.3 布尔值</a></li>
            <li><a href="#314-字符串">3.1.4 字符串</a></li>
          </ul>
        </li>
        <li><a href="#32-索引和切片">3.2 索引和切片</a>
          <ul>
            <li><a href="#321-索引">3.2.1 索引</a></li>
            <li><a href="#322-切片">3.2.2 切片</a></li>
          </ul>
        </li>
        <li><a href="#33-数据结构">3.3 数据结构</a>
          <ul>
            <li><a href="#331-列表">3.3.1 列表</a></li>
            <li><a href="#332-字典">3.3.2 字典</a></li>
            <li><a href="#333-元组">3.3.3 元组</a></li>
            <li><a href="#334-集合">3.3.4 集合</a></li>
          </ul>
        </li>
        <li><a href="#34-控制流">3.4 控制流</a>
          <ul>
            <li><a href="#341-代码块和pass语句">3.4.1 代码块和pass语句</a></li>
            <li><a href="#342-if语句和条件表达式">3.4.2 if语句和条件表达式</a></li>
            <li><a href="#343-for-循环和-while-循环">3.4.3 for 循环和 while 循环</a></li>
            <li><a href="#344-列表字典和集合推导式">3.4.4 列表、字典和集合推导式</a></li>
          </ul>
        </li>
        <li><a href="#35-组织代码">3.5 组织代码</a>
          <ul>
            <li><a href="#351-函数">3.5.1 函数</a></li>
            <li><a href="#352-模块和import语句">3.5.2 模块和import语句</a></li>
            <li><a href="#353-datetime类">3.5.3 datetime类</a></li>
          </ul>
        </li>
        <li><a href="#36-pep-8python风格指南">3.6 PEP 8：Python风格指南</a>
          <ul>
            <li><a href="#361-pep-8-和-vs-code">3.6.1 PEP 8 和 VS Code</a></li>
            <li><a href="#362-类型提示">3.6.2 类型提示</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#第四章-numpy-基础">第四章 NumPy 基础</a>
      <ul>
        <li><a href="#41-numpy入门">4.1 NumPy入门</a>
          <ul>
            <li><a href="#411-numpy数组">4.1.1 NumPy数组</a></li>
            <li><a href="#412-向量化和广播">4.1.2 向量化和广播</a></li>
            <li><a href="#413-通用函数">4.1.3 通用函数</a></li>
          </ul>
        </li>
        <li><a href="#42-创建和操作数组">4.2 创建和操作数组</a>
          <ul>
            <li><a href="#421-存取元素">4.2.1 存取元素</a></li>
            <li><a href="#422-方便的数组构造器">4.2.2 方便的数组构造器</a></li>
            <li><a href="#423-视图和副本">4.2.3 视图和副本</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#第五章-使用-pandas-进行数据分析">第五章 使用 <strong>pandas</strong> 进行数据分析</a>
      <ul>
        <li><a href="#51-dataframe-和-series">5.1 DataFrame 和 Series</a>
          <ul>
            <li><a href="#511-索引">5.1.1 索引</a></li>
            <li><a href="#512-列">5.1.2 列</a></li>
          </ul>
        </li>
        <li><a href="#52-数据操作">5.2 数据操作</a>
          <ul>
            <li><a href="#521-选取数据">5.2.1 选取数据</a></li>
            <li><a href="#522-设置数据">5.2.2 设置数据</a></li>
            <li><a href="#523-缺失数据">5.2.3 缺失数据</a></li>
            <li><a href="#524-重复数据">5.2.4 重复数据</a></li>
            <li><a href="#525-算术运算">5.2.5 算术运算</a></li>
            <li><a href="#526-处理文本列">5.2.6 处理文本列</a></li>
            <li><a href="#527-应用函数">5.2.7 应用函数</a></li>
            <li><a href="#528-视图和副本">5.2.8 视图和副本</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#附录-a-conda-环境">附录 A Conda 环境</a>
      <ul>
        <li><a href="#a1-创建新的conda环境">A.1 创建新的Conda环境</a></li>
        <li><a href="#a2-禁用自动激活">A.2 禁用自动激活</a></li>
      </ul>
    </li>
    <li><a href="#附录-b-高级-vs-code-功能">附录 B 高级 VS Code 功能</a>
      <ul>
        <li><a href="#b1-调试器">B.1 调试器</a></li>
        <li><a href="#b2-vs-code中的jupyter笔记本">B.2 VS Code中的Jupyter笔记本</a>
          <ul>
            <li><a href="#b21-运行jupyter笔记本">B.2.1 运行Jupyter笔记本</a></li>
            <li><a href="#b22-带有代码单元格的python脚本">B.2.2 带有代码单元格的Python脚本</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    目录
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#第一章-为什么要用python为excel编程">第一章 为什么要用Python为Excel编程</a>
      <ul>
        <li><a href="#11-excel作为一门编程语言">1.1 Excel作为一门编程语言</a>
          <ul>
            <li><a href="#112-编程最佳实践">1.1.2 编程最佳实践</a></li>
            <li><a href="#113-现代excel">1.1.3 现代Excel</a></li>
          </ul>
        </li>
        <li><a href="#12-用在excel上的python">1.2 用在Excel上的Python</a>
          <ul>
            <li><a href="#121-可读性和可维护性">1.2.1 可读性和可维护性</a></li>
            <li><a href="#122-标准库和包管理器">1.2.2 标准库和包管理器</a></li>
            <li><a href="#123-科学计算">1.2.3 科学计算</a></li>
            <li><a href="#125-跨平台兼容性">1.2.5 跨平台兼容性</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#第二章-开发环境">第二章 开发环境</a>
      <ul>
        <li><a href="#21-anaconda-python发行版">2.1 Anaconda Python发行版</a>
          <ul>
            <li><a href="#212-anaconda-prompt">2.1.2 Anaconda Prompt</a></li>
            <li><a href="#213-python-repl交互式python会话">2.1.3 Python REPL：交互式Python会话</a></li>
            <li><a href="#214-包管理器conda-和-pip">2.1.4 包管理器：Conda 和 pip</a></li>
            <li><a href="#215-conda-环境">2.1.5 Conda 环境</a></li>
          </ul>
        </li>
        <li><a href="#22-jupyter笔记本">2.2 Jupyter笔记本</a>
          <ul>
            <li><a href="#221-运行jupyter笔记本">2.2.1 运行Jupyter笔记本</a></li>
            <li><a href="#222-笔记本单元格">2.2.2 笔记本单元格</a></li>
            <li><a href="#223-编辑模式与命令模式">2.2.3 编辑模式与命令模式</a></li>
            <li><a href="#224-执行顺序很重要">2.2.4 执行顺序很重要</a></li>
            <li><a href="#225-关闭jupyter笔记本">2.2.5 关闭Jupyter笔记本</a></li>
          </ul>
        </li>
        <li><a href="#23-vs-code">2.3 VS Code</a>
          <ul>
            <li><a href="#231-安装和配置">2.3.1 安装和配置</a></li>
            <li><a href="#232-执行python脚本">2.3.2 执行Python脚本</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#第三章-python-入门">第三章 Python 入门</a>
      <ul>
        <li><a href="#31-数据类型">3.1 数据类型</a>
          <ul>
            <li><a href="#311-对象">3.1.1 对象</a></li>
            <li><a href="#312-数值类型">3.1.2 数值类型</a></li>
            <li><a href="#313-布尔值">3.1.3 布尔值</a></li>
            <li><a href="#314-字符串">3.1.4 字符串</a></li>
          </ul>
        </li>
        <li><a href="#32-索引和切片">3.2 索引和切片</a>
          <ul>
            <li><a href="#321-索引">3.2.1 索引</a></li>
            <li><a href="#322-切片">3.2.2 切片</a></li>
          </ul>
        </li>
        <li><a href="#33-数据结构">3.3 数据结构</a>
          <ul>
            <li><a href="#331-列表">3.3.1 列表</a></li>
            <li><a href="#332-字典">3.3.2 字典</a></li>
            <li><a href="#333-元组">3.3.3 元组</a></li>
            <li><a href="#334-集合">3.3.4 集合</a></li>
          </ul>
        </li>
        <li><a href="#34-控制流">3.4 控制流</a>
          <ul>
            <li><a href="#341-代码块和pass语句">3.4.1 代码块和pass语句</a></li>
            <li><a href="#342-if语句和条件表达式">3.4.2 if语句和条件表达式</a></li>
            <li><a href="#343-for-循环和-while-循环">3.4.3 for 循环和 while 循环</a></li>
            <li><a href="#344-列表字典和集合推导式">3.4.4 列表、字典和集合推导式</a></li>
          </ul>
        </li>
        <li><a href="#35-组织代码">3.5 组织代码</a>
          <ul>
            <li><a href="#351-函数">3.5.1 函数</a></li>
            <li><a href="#352-模块和import语句">3.5.2 模块和import语句</a></li>
            <li><a href="#353-datetime类">3.5.3 datetime类</a></li>
          </ul>
        </li>
        <li><a href="#36-pep-8python风格指南">3.6 PEP 8：Python风格指南</a>
          <ul>
            <li><a href="#361-pep-8-和-vs-code">3.6.1 PEP 8 和 VS Code</a></li>
            <li><a href="#362-类型提示">3.6.2 类型提示</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#第四章-numpy-基础">第四章 NumPy 基础</a>
      <ul>
        <li><a href="#41-numpy入门">4.1 NumPy入门</a>
          <ul>
            <li><a href="#411-numpy数组">4.1.1 NumPy数组</a></li>
            <li><a href="#412-向量化和广播">4.1.2 向量化和广播</a></li>
            <li><a href="#413-通用函数">4.1.3 通用函数</a></li>
          </ul>
        </li>
        <li><a href="#42-创建和操作数组">4.2 创建和操作数组</a>
          <ul>
            <li><a href="#421-存取元素">4.2.1 存取元素</a></li>
            <li><a href="#422-方便的数组构造器">4.2.2 方便的数组构造器</a></li>
            <li><a href="#423-视图和副本">4.2.3 视图和副本</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#第五章-使用-pandas-进行数据分析">第五章 使用 <strong>pandas</strong> 进行数据分析</a>
      <ul>
        <li><a href="#51-dataframe-和-series">5.1 DataFrame 和 Series</a>
          <ul>
            <li><a href="#511-索引">5.1.1 索引</a></li>
            <li><a href="#512-列">5.1.2 列</a></li>
          </ul>
        </li>
        <li><a href="#52-数据操作">5.2 数据操作</a>
          <ul>
            <li><a href="#521-选取数据">5.2.1 选取数据</a></li>
            <li><a href="#522-设置数据">5.2.2 设置数据</a></li>
            <li><a href="#523-缺失数据">5.2.3 缺失数据</a></li>
            <li><a href="#524-重复数据">5.2.4 重复数据</a></li>
            <li><a href="#525-算术运算">5.2.5 算术运算</a></li>
            <li><a href="#526-处理文本列">5.2.6 处理文本列</a></li>
            <li><a href="#527-应用函数">5.2.7 应用函数</a></li>
            <li><a href="#528-视图和副本">5.2.8 视图和副本</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#附录-a-conda-环境">附录 A Conda 环境</a>
      <ul>
        <li><a href="#a1-创建新的conda环境">A.1 创建新的Conda环境</a></li>
        <li><a href="#a2-禁用自动激活">A.2 禁用自动激活</a></li>
      </ul>
    </li>
    <li><a href="#附录-b-高级-vs-code-功能">附录 B 高级 VS Code 功能</a>
      <ul>
        <li><a href="#b1-调试器">B.1 调试器</a></li>
        <li><a href="#b2-vs-code中的jupyter笔记本">B.2 VS Code中的Jupyter笔记本</a>
          <ul>
            <li><a href="#b21-运行jupyter笔记本">B.2.1 运行Jupyter笔记本</a></li>
            <li><a href="#b22-带有代码单元格的python脚本">B.2.2 带有代码单元格的Python脚本</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>



            
            
          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        

        <div class="article-content max-w-prose mb-20">
          
<h1 class="relative group">Excel Python：飞速搞定数据分析与处理 
    <div id="excel-python飞速搞定数据分析与处理" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#excel-python%e9%a3%9e%e9%80%9f%e6%90%9e%e5%ae%9a%e6%95%b0%e6%8d%ae%e5%88%86%e6%9e%90%e4%b8%8e%e5%a4%84%e7%90%86" aria-label="锚点">#</a>
    </span>        
    
</h1>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250808003536259" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250808003536259.png">

  
</figure>
</p>
<hr>

<h1 class="relative group">第一部分 Python 入门 
    <div id="第一部分-python-入门" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e7%ac%ac%e4%b8%80%e9%83%a8%e5%88%86-python-%e5%85%a5%e9%97%a8" aria-label="锚点">#</a>
    </span>        
    
</h1>

<h2 class="relative group">第一章 为什么要用Python为Excel编程 
    <div id="第一章-为什么要用python为excel编程" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e7%ac%ac%e4%b8%80%e7%ab%a0-%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e7%94%a8python%e4%b8%baexcel%e7%bc%96%e7%a8%8b" aria-label="锚点">#</a>
    </span>        
    
</h2>

<h3 class="relative group">1.1 Excel作为一门编程语言 
    <div id="11-excel作为一门编程语言" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#11-excel%e4%bd%9c%e4%b8%ba%e4%b8%80%e9%97%a8%e7%bc%96%e7%a8%8b%e8%af%ad%e8%a8%80" aria-label="锚点">#</a>
    </span>        
    
</h3>

<h4 class="relative group">1.1.2 编程最佳实践 
    <div id="112-编程最佳实践" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#112-%e7%bc%96%e7%a8%8b%e6%9c%80%e4%bd%b3%e5%ae%9e%e8%b7%b5" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>最重要的编程最佳实践，涉及<strong>关注点分离、DRY原则、测试和版本控制</strong>。</p>

<h5 class="relative group">1. 关注点分离 
    <div id="1-关注点分离" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#1-%e5%85%b3%e6%b3%a8%e7%82%b9%e5%88%86%e7%a6%bb" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>编程最重要的设计原则之一就是关注点分离（<strong>separation of concerns</strong>），有时候也称作模块化（<strong>modularity</strong>）。一系列<strong>相关的功能</strong>应当被视作程序中一个<strong>独立的部分</strong>来处 理，从而可以在不影响应用程序其他部分的情况下，轻松地<strong>替换</strong>这一部分.</p>
<p>一个应用程序通常被分为如下3层:</p>
<p>• <strong>表示层</strong>（presentation layer）：这一层是你可以看到并与之交互的部分，也就是所谓的用户界面。</p>
<p>• <strong>业务层</strong>（business layer）：这一层负责特定应用程序的逻辑。</p>
<p>• <strong>数据层</strong>（data layer）：这一层负责访问数据。</p>

<h5 class="relative group">2. DRY 原则 
    <div id="2-dry-原则" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#2-dry-%e5%8e%9f%e5%88%99" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>意思是“<strong>不要自我重复</strong>”（don’t repeat yourself），没有重复的代码意味着代码行数更少，错误也更少，代码自然也就更容易维护。</p>

<h5 class="relative group">3. 测试 
    <div id="3-测试" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#3-%e6%b5%8b%e8%af%95" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>专业软件开发人员测试代码，会写<strong>单元测试</strong>（unit test）。 这是一种可以测试程序各个组件的机制。单元测试会确保程序中的每一个函数都正常工作。大部分编程语言会提供一种自动执行单元测试的方法。执行自动测试可以使代码库的可靠性大幅提升，并且在一定程度上，测试会确保在编辑代码时不会破坏当前正常工作的代码。</p>
<p>通常程序员会对单元测试进行配置，每当代码被提交到版本控制系统的时候，它就会自动运行。</p>

<h5 class="relative group">4. 版本控制 
    <div id="4-版本控制" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#4-%e7%89%88%e6%9c%ac%e6%8e%a7%e5%88%b6" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>专业程序员会使用版本控制（version control）系统，或者称为源代码控制（source control）系统。<strong>版本控制系统</strong>（version control system，VCS）会不断跟踪源代码的更改，让你能够看到是谁进行了更改，更改了什么，什么时候更改的，为什么更改， 并且在任何时候都能还原到过去的版本。当今<strong>最受欢迎的版本控制系统是Git</strong>。</p>
<p>通常专业程序员都会结合像<strong>GitHub、GitLab、Bitbucket 和Azure DevOps 这样的Web 平台</strong>来使用Git，这些平台可以让你提出所谓的拉取请求 （pull request）和合并请求（merge request）。这些操作可以让开发者正式地请求负责人将他 们的更改合并到主数据库中。一次拉取请求会提供如下信息：</p>
<p>• 更改的作者； • 更改发生的时间； • 在提交信息（commit message）中描述的更改目的； • 在diff 视图（其中新代码以绿色高亮显示，删掉的代码以红色高亮显示）中展示的更改细节。</p>

<h4 class="relative group">1.1.3 现代Excel 
    <div id="113-现代excel" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#113-%e7%8e%b0%e4%bb%a3excel" aria-label="锚点">#</a>
    </span>        
    
</h4>

<h5 class="relative group">1. Power Query 和 Power Pivot 
    <div id="1-power-query-和-power-pivot" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#1-power-query-%e5%92%8c-power-pivot" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>Power Query 可以连接各种数据源，包括 Excel 工作簿、CSV 文件、SQL 数据库，等等。核心功能是处理一张工作表装不下的数据集。在加载数据之后，你还可以通过额外的操作来清理、操作数据，使之成为 Excel 可用的形式。</p>
<p>Power Pivot 和 Power Query 联系密切，利用 Power Query 获取和清理数据之后，就该Power Pivot 上场了。Power Pivot 以一种引人入胜的方式直接在 Excel 中分析和呈现数据。可以把它视作一种传统意义上的<strong>数据透视表</strong>。和 Power Query 一样， 它也可以处理大型数据集。Power Pivot 可以用关系和层次来定义形式上的数据模型， 并且可以通过 DAX 公式语言添加计算列。</p>

<h5 class="relative group">2. Power BI 
    <div id="2-power-bi" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#2-power-bi" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>Power BI 是在2015 年发布的一个独立应用程序。Power BI 通过在交互式仪表板中可视化巨大的数据集使其更容易理解。Power BI 的商业版可以让你在线和他人合作，并共享仪表板。Power BI 自2018年起就支持 Python 脚本了。</p>

<h3 class="relative group">1.2 用在Excel上的Python 
    <div id="12-用在excel上的python" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#12-%e7%94%a8%e5%9c%a8excel%e4%b8%8a%e7%9a%84python" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>Excel 的主要功能是存储数据、分析数据和可视化数据。而 Python 在科学计算方面也极其</p>
<p>强大，天生就适合搭配 Excel 工作。</p>

<h4 class="relative group">1.2.1 可读性和可维护性 
    <div id="121-可读性和可维护性" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#121-%e5%8f%af%e8%af%bb%e6%80%a7%e5%92%8c%e5%8f%af%e7%bb%b4%e6%8a%a4%e6%80%a7" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>良好的可读性使得发现错误和维护代码更加容易，Python 会强制将视觉缩进和代码逻辑对齐，从而避免可读性问题。当你在 if 语句或 for 循环中使用代码块时，Python 依靠缩进来定义代码块。</p>
<p>使用缩进定义代码块的原因在于，编程时大部分时间是花费在维护代码而不是现写新的代码上。可读性好的代码可以帮助新进程序员回顾过去、了解现状。</p>

<h4 class="relative group">1.2.2 标准库和包管理器 
    <div id="122-标准库和包管理器" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#122-%e6%a0%87%e5%87%86%e5%ba%93%e5%92%8c%e5%8c%85%e7%ae%a1%e7%90%86%e5%99%a8" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>Python 通过标准库提供了丰富的内置工具。Python 社群喜欢称之为“自带电池”。尽管 Python 标准库涵盖了大量的功能，但还是有一些功能难以编写，又或是使用标准库来实现效率很低。这个时候就该 PyPI 上场了。PyPI 代表 Python Package Index（Python 包目录），它是任何人（包括你！）都可以上传开源 Python 包的巨大仓库，利用这些包可以扩展Python 的功能。</p>
<p>如果想更方便地从互联网上获取数据，可以安装 Requests 包来获取一系列强大又好用的命令。要安装一个包，需要在命令提示符或者终端中使用 Python 的包管理器，即 pip。pip 是 pip installs packages 的递归缩写。</p>
<p>为什么包管理器如此重要。一个主要原因是，任何优质的包可能不仅依赖于 Python 标准库，还会依赖于 PyPI 上的其他开源包。而这些依赖项又可能会依赖其他的包，层层递进。pip 会递归地检查一个包的依赖项和子依赖项，并逐一下载安装。你还可以使用 pip 轻松地更新包，以保持各个依赖项都是最新版本。pip 让你能够坚守 DRY 原则，因为不用重新发明轮子或者复制粘贴 PyPI 上已有的包。有了 pip 和 PyPI，你就有了一套统一的机制来分发和安装依赖项——这正是 Excel 的插件所欠缺的。</p>

<h4 class="relative group">1.2.3 科学计算 
    <div id="123-科学计算" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#123-%e7%a7%91%e5%ad%a6%e8%ae%a1%e7%ae%97" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>诸如 NumPy、SciPy 和 pandas 之类的科学计算库提供了一种简洁的方式来表达数学问题。</p>

<h4 class="relative group">1.2.5 跨平台兼容性 
    <div id="125-跨平台兼容性" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#125-%e8%b7%a8%e5%b9%b3%e5%8f%b0%e5%85%bc%e5%ae%b9%e6%80%a7" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>即便在一台运行着 Windows 或者 macOS 的本地计算机上开发，在某个时候你也可能会想让代码在一台服务器或者云端上运行。服务器会通过其运算能力，让代码按计划执行，并使应用程序可以从任何地方访问。</p>
<hr>

<h2 class="relative group">第二章 开发环境 
    <div id="第二章-开发环境" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e7%ac%ac%e4%ba%8c%e7%ab%a0-%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83" aria-label="锚点">#</a>
    </span>        
    
</h2>
<p>先安装好 Anaconda Python 发行版。除了安装 Python，Anaconda 还会安装 Anaconda Prompt 和 Jupyter 笔记本。它们是贯穿本书的两种关键工具。<strong>Anaconda Prompt</strong> 是一种特殊的命令提示符（用 Windows 的话来说）或者终端（用 macOS 的话来说），我们可以通过它来运行 Python 脚本和一些本书中会用到的命令行工具。<strong>Jupyter</strong> 笔记本让我们可以交互地处理数据、代码和图表，可以说它是 Excel 工作簿的强力竞争者。在体验了 Jupyter 笔记本之后，我们会安装一个强大的文本编辑器——<strong>Visual Studio Code</strong>（VS Code）。VS Code 内置了集成终端，用它来编写、执行和调试 Python 代码非常方便。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250804104916305" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250804104916305.png">

  
</figure>
</p>

<h3 class="relative group">2.1 Anaconda Python发行版 
    <div id="21-anaconda-python发行版" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#21-anaconda-python%e5%8f%91%e8%a1%8c%e7%89%88" aria-label="锚点">#</a>
    </span>        
    
</h3>

<h4 class="relative group">2.1.2 Anaconda Prompt 
    <div id="212-anaconda-prompt" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#212-anaconda-prompt" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>Anaconda Prompt 实际上就是 Windows 中的一个<strong>命令提示符</strong>或者 macOS 中的终端，只不过它<strong>配置好了 Python 解释器和第三方包</strong>。Anaconda Prompt 是执行 Python 代码的最基本的工具，本书会大量使用它来执行 Python 脚本和各种包提供的命令行工具。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250804105734894" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250804105734894.png">

  
</figure>
</p>
<p>在 Windows 中，输入 <strong>dir</strong> 并按回车键。命令提示符会<strong>打印出当前所在目录的内容</strong>。</p>
<p>输入 <strong>cd Down</strong> 并按 tab 键。<strong>cd 代表切换目录</strong>。如果位于 home 文件夹中，那么 Anaconda Prompt 极有可能会将刚才输入的内容自动补全为 cd Downloads。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250804105838313" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250804105838313.png">

  
</figure>
</p>
<p>注意，如果路径以你当前所在目录中的文件夹名或文件名开始，那么你用的就是<strong>相对路径</strong>，比如 cd Downloads。如果想离开当前目录，可以输入<strong>绝对路径</strong>，比如在 Windows中输入 cd C:\Users。</p>
<p>切换至父目录（上一级目录），需要输入 <strong>cd ..</strong> 然后按回车键（确保在 cd 和两点之间有一个空格）。将这个命令和目录名相结合，如果你想先返回上一级目录，然后进入 Desktop，可以输入 <strong>cd ..\Desktop</strong>。</p>

<h4 class="relative group">2.1.3 Python REPL：交互式Python会话 
    <div id="213-python-repl交互式python会话" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#213-python-repl%e4%ba%a4%e4%ba%92%e5%bc%8fpython%e4%bc%9a%e8%af%9d" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>交互式 Python 会话也被称为 REPL，意思是<strong>读取 – 求值 – 输出循环</strong>（read-eval-print loop），Python 会读取你的输入，对其求值，然后立即输出结果并等待下一次输入。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250804112018662" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250804112018662.png">

  
</figure>
</p>
<p>要退出 Python 会话，需要输入 <strong>quit()</strong> 并按回车键。也可以在 Windows 中按下快捷键</p>
<p>Ctrl+Z，然后按回车键。</p>

<h4 class="relative group">2.1.4 包管理器：Conda 和 pip 
    <div id="214-包管理器conda-和-pip" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#214-%e5%8c%85%e7%ae%a1%e7%90%86%e5%99%a8conda-%e5%92%8c-pip" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>Python 的包管理器 pip，它负责下载、安装、更新和卸载 Python 包及其依赖项和子依赖项。虽然 Anaconda 也可以配合 pip 工作，但是它还有一个名为 Conda 的内置包管理器。Conda 的一大<strong>优势</strong>是不仅可以安装 Python 包，还可以<strong>安装多种版本的 Python解释器</strong>。一言以蔽之：软件包可以为 Python 添加标准库中所没有的功能。</p>
<p><strong>在使用 Anaconda 的情况下，应该尽可能地用 Conda 安装各种软件包。而 pip 只是用来安装那些在 Conda 中找不到的软件包。不然的话 Conda 可能会覆盖你用 pip 安装的包。</strong></p>
<p>表 2-2 列出了最常用的命令。这些命令必须在 Anaconda Prompt 中输入，可以让你安装、更新和卸载第三方包。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250804112349083" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250804112349083.png">

  
</figure>
</p>
<p>查看安装的 Anaconda 发行版中已经安装了哪些包，可以输入以下代码：</p>
<pre tabindex="0"><code>(base)&gt; conda list
</code></pre><p>安装 Plotly 和 xlutils，这两个包都可以在 Conda 中找到：</p>
<pre tabindex="0"><code>(base)&gt; conda install plotly xlutils
</code></pre><p>执行这条命令之后，Conda 会向你表明它要干些什么，你需要输入 <strong>y</strong> 并按回车键表示确认。</p>
<p>通过 pip 来安装 pyxlsb 和 pytrends，这两个包 Conda 中没有：</p>
<pre tabindex="0"><code>(base)&gt; pip install pyxlsb pytrends
</code></pre><p>和 Conda 不一样，pip 在你按回车键之后会立即开始安装而不需要确认。</p>

<h4 class="relative group">2.1.5 Conda 环境 
    <div id="215-conda-环境" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#215-conda-%e7%8e%af%e5%a2%83" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>Anaconda Prompt 每行开头的 (base) 到底是什么。它是<strong>当前激活的 Conda 环境</strong>的名称。Conda 环境是一个被隔离的“Python 世界”，有着<strong>特定版本的 Python 和一系列安装好的包</strong>。为什么非要这么做呢？当你同时开发多个项目的时候，各个项目会有不同的需求：一个项目可能需要 Python 3.8 和 pandas 0.25.0，而另一个项目可能需要 Python 3.9 和 pandas 1.0.0。由于为 pandas 0.25.0 编写的代码往往需要进行修改才能用到 pandas 1.0.0 上，因此不能只更新 Python 和 pandas 而保持代码原封不动。为每个项目都配置一个 Conda 环境可以保证它们使用正确的依赖项运行。Conda 环境虽然是 Anaconda 发行版的专有概念，但<strong>虚拟环境是所有 Python 发行版的通用概念</strong>。相比之下 Conda 环境更加强大，因为它不仅可以管理多个版本的软件包，还可以轻松管理不同版本的 Python 解释器。</p>
<p>创建新项目时，为每个项目使用单独的 Conda 环境或者虚拟环境是很好的实践方式，这可以让你规避不同项目之间的依赖冲突。</p>
<p><strong>详情可见附录 A</strong></p>

<h3 class="relative group">2.2 Jupyter笔记本 
    <div id="22-jupyter笔记本" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#22-jupyter%e7%ac%94%e8%ae%b0%e6%9c%ac" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>在数据科学领域，人们热衷于使用 Jupyter 笔记本来运行代码。它把格式规整的可执行 Python 代码、图片和图表融合到一个交互式笔记本中，并且这个笔记本是运行在浏览器中的。Jupyter 笔记本对初学者很友好，在教学、原型开发、研究等领域极为受欢迎，极大地方便了可重现的研究。</p>
<p>Jupyter 笔记本可以快速准备、分析和可视化数据，这和工作簿的用例几乎相同。它已然成了 Excel 的竞争者。但和 Excel 不同，Jupyter 笔记本是用 Python 代码来完成这些工作的，而不是用鼠标在 Excel 中点来点去。Jupyter 笔记本的另一个优势是，它<strong>不会把数据和业务逻辑混在一起</strong>。Jupyter 笔记本会负责代码和图表，使用来自外部 CSV 文件或者数据库中的数据。Jupyter 笔记本在<strong>本地和远程服务器</strong>上都可以运行，一般来说，服务器要比本地机器性能更强，它可以在无人值守的情况下运行代码。</p>

<h4 class="relative group">2.2.1 运行Jupyter笔记本 
    <div id="221-运行jupyter笔记本" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#221-%e8%bf%90%e8%a1%8cjupyter%e7%ac%94%e8%ae%b0%e6%9c%ac" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>在 Anaconda Prompt 中，切换至配套代码库所在目录，这里使用创建的虚拟环境 xl38，然后启动 Jupyter 笔记本服务器：</p>
<pre tabindex="0"><code>(xl38)&gt; cd ..
(xl38)&gt; cd ..
(xl38)&gt; F:
(xl38)&gt; cd F:\Python\python-for-excel-1st-edition
(xl38)&gt; jupyter notebook
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805103537299" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805103537299.png">

  
</figure>
</p>
<p>打开的 Jupyter 仪表板会显示执行命令时所在目录中的文件。在 Jupyter 仪表板的右上方，点击新建，在下拉列表中选择 xl38，这里需要激活连接新建的虚拟环境 xl38（具体可见文档：Python开发环境安装流程.md 中的 Jupyter 代码编辑器的<strong>虚拟环境连接 Jupyter</strong>），过程如下：</p>
<pre tabindex="0"><code>(xl38) C:\Users\SHY&gt;pip install ipykernel -i https://pypi.tuna.tsinghua.edu.cn/simple
(xl38) C:\Users\SHY&gt;python -m ipykernel install --user --name=xl38
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805104800576" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805104800576.png">

  
</figure>
</p>
<p>浏览器会为你的第一个空白笔记本打开新的标签页：</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805105640108" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805105640108.png">

  
</figure>
</p>
<p>点击 Jupyter logo 旁边的 Untitled，为工作簿取一个更有意义的名字，比如 first_notebook。</p>

<h4 class="relative group">2.2.2 笔记本单元格 
    <div id="222-笔记本单元格" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#222-%e7%ac%94%e8%ae%b0%e6%9c%ac%e5%8d%95%e5%85%83%e6%a0%bc" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>输入 <strong>3 + 4</strong>，然后点击上面菜单栏中的运行按钮，或者用更方便的快捷键：<strong>Shift+ 回车</strong>。单元格中的代码将会执行，并把<strong>结果输出到单元格下方</strong>，然后<strong>跳到下一个单元格</strong>。由于目前我们只有一个单元格，因此笔记本会<strong>在下面插入一个空白单元格</strong>。现在再仔细看一下，当单元格<strong>正在计算时</strong>，会<strong>显示 In [*]</strong>；在<strong>计算完成时</strong>，<strong>星号就变成了数字</strong>，也就是 In [1]。在这个单元格下方你会看到对应的<strong>输出单元格</strong>，而且和输入单元格有相同的编号：Out [1]。每当你运行一个单元格，编号就会加 1，这个编号可以帮助你识别单元格执行的顺序。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805110006081" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805110006081.png">

  
</figure>
</p>
<p>**注意：**如果单元格的最后一行返回了一个值，那么它会自动输出到 Jupyter 笔记本的 Out [ ] 单元格中。然而，如果你使用的是 print 函数或者发生了异常，则相应的输出会直接显示在 In 单元格下方而没有 Out [ ] 标签。</p>
<p>单元格有不同的类型，我们需要关注以下两种。</p>
<p>1、代码：默认类型。需要执行 Python 代码时就会用到它。</p>
<p>2、Markdown：Markdown 是一种<strong>格式化语法</strong>，它使用标准的文本字符来格式化文本。可以用它在笔记本中添加格式规整的解释和说明。</p>
<p>要把单元格的类型<strong>切换为 Markdown</strong>，先选中单元格，然后在单元格模式下拉菜单中选 Markdown</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805110524568" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805110524568.png">

  
</figure>
</p>
<p>在将一个空单元格切换为 Markdown 单元格后，输入下列文本，这是对 Markdown 语法规则的介绍</p>
<pre tabindex="0"><code># 这是一级标题
## 这是二级标题
你可以让你的文本变成*斜体*、**粗体**或`等宽字体`
* 这是项目符号
* 又一个项目符号
</code></pre><p>按下快捷键 Shift+ 回车之后，这段文本会被渲染成格式规整的 HTML。Markdown 单元格还可以添加图片、视频或公式。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805111529207" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805111529207.png">

  
</figure>
</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805111540910" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805111540910.png">

  
</figure>
</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805111209821" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805111209821.png">

  
</figure>
</p>

<h4 class="relative group">2.2.3 编辑模式与命令模式 
    <div id="223-编辑模式与命令模式" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#223-%e7%bc%96%e8%be%91%e6%a8%a1%e5%bc%8f%e4%b8%8e%e5%91%bd%e4%bb%a4%e6%a8%a1%e5%bc%8f" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>当和 Jupyter 笔记本中的单元格互动时，你要么处于<strong>编辑模式</strong>（editing mode），要么处于<strong>命令模式</strong>（command mode）。</p>
<p>编辑模式：点击一个单元格以启动编辑模式。被选中的单元格边缘会变成<strong>绿色</strong>，单元格中的光标也会开始闪烁。除了点击单元格，还可以在选中单元格时按回车键。</p>
<p>命令模式：要切换至命令模式，需要按下 <strong>Esc 键</strong>。被选中的单元格边缘会变成<strong>蓝色</strong>且不会出现光标。</p>

<h4 class="relative group">2.2.4 执行顺序很重要 
    <div id="224-执行顺序很重要" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#224-%e6%89%a7%e8%a1%8c%e9%a1%ba%e5%ba%8f%e5%be%88%e9%87%8d%e8%a6%81" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>假设你的笔记本中有下面这样几个单元格，从上往下执行：</p>
<pre tabindex="0"><code>In [2]: a = 1
In [3]: a
Out[3]: 1
In [4]: a = 2
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805113306676" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805113306676.png">

  
</figure>
</p>
<p>单元格 Out[3] 会按照预期输出 1。然而，如果你回去再一次执行 In[3]，就会得到下面的结果：</p>
<pre tabindex="0"><code>In [2]: a = 1
In [5]: a
Out[5]: 2
In [4]: a = 2
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805113346626" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805113346626.png">

  
</figure>
</p>

<h4 class="relative group">2.2.5 关闭Jupyter笔记本 
    <div id="225-关闭jupyter笔记本" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#225-%e5%85%b3%e9%97%adjupyter%e7%ac%94%e8%ae%b0%e6%9c%ac" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>每个笔记本都在一个独立的 Jupyter <strong>内核</strong>中运行。内核是运行单元格中 Python 代码的“引擎”。每个内核都会<strong>消耗</strong>操作系统提供的 <strong>CPU 和 RAM 资源</strong>。在关闭笔记本时，还需要<strong>关闭</strong>它的内核，以便内核所占用的资源可以被其他任务重用——从而防止系统变慢。</p>
<p>最简单的方法是选择菜单中的“文件 &gt; 关闭”。如果只是关闭了浏览器标签页，那么内核并不会自动关闭。另外，在 Jupyter 仪表板中，也可以从运行标签页中关闭正在运行的笔记本。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805113719432" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805113719432.png">

  
</figure>
</p>
<p>要关闭整个 Jupyter 服务器，可以点击 Jupyter 仪表板右上方的<strong>退出按钮</strong>（logout）。如果已经关闭了浏览器，可以在运行笔记本服务器的 Anaconda Prompt 中<strong>按两次快捷键 Ctrl+C</strong>，或者连同Anaconda Prompt 一起关闭。</p>

<h3 class="relative group">2.3 VS Code 
    <div id="23-vs-code" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#23-vs-code" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>安装并配置 VS Code，它是微软开发的一个免费且开源的<strong>文本编辑器</strong>。</p>
<p>Jupyter 笔记本虽然对于研究、教学和实验这类互动型的工作流程来说很好用，但是如果想编写针对<strong>生产环境</strong>的 Python 脚本（这类脚本用不到笔记本的可视化功能），Jupyter 笔记本并非理想之选。对于一些涉及大量文件和多位开发者的复杂项目，Jupyter 笔记本也不是那么好用。</p>
<p>理论上来讲，可以使用任何文本编辑器（哪怕是记事本也行），但实际上你需要的是一个可以“<strong>理解</strong>”Python 的编辑器。这样的编辑器至少应该有如下特性。</p>
<p>1、<strong>语法高亮</strong>：编辑器会为具有不同语义（函数、字符串、数字，等等）的单词赋予不同的颜色，从而使得代码更容易阅读和理解。</p>
<p>2、<strong>自动补全</strong>：自动补全（autocomplete），或者用微软的话来讲叫智能感知（intelliSense），可以为文本组件提供建议，以便你少打字、少打错字。</p>
<p>VS Code 自 2015 年发布以来就深受开发者喜爱，其融合了<strong>纯文本编辑器和全功能 IDE</strong>：VS Code 是一个<strong>迷你 IDE</strong>，囊括了编程所需要的所有工具。除此之外，它还具有如下特性。</p>
<p>1、<strong>跨平台</strong>：VS Code 可以在 Windows、macOS 和 Linux 中运行，也有像 GitHub Codespaces 这样的云托管版本。</p>
<p>2、<strong>集成工具</strong>：VS Code 内置调试器，支持 Git 版本控制，还有可以用作 Anaconda Prompt 的集成终端。</p>
<p>3、<strong>扩展</strong>：包括 Python 支持在内的其他所有功能，都可以以扩展的形式一键安装。</p>
<p>4、<strong>轻量</strong>：根据操作系统的不同，VS Code 的安装包仅有 50MB~100MB 大小。</p>
<p><strong>VS Code 和 Visual Studio</strong></p>
<p>不要把 VS Code 和名为 Visual Studio 的 IDE 搞混了！虽然也可以用 Visual Studio 来进行 Python 开 发 [Visual Studio 有 PTVS（Python Tools for Visual Studio，适用于 Visual Studio 的 Python 工具）]，但是需要安装很多东西。传统上 Visual Studio 是用来做 .NET 语言（如 C#）开发的。</p>

<h4 class="relative group">2.3.1 安装和配置 
    <div id="231-安装和配置" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#231-%e5%ae%89%e8%a3%85%e5%92%8c%e9%85%8d%e7%bd%ae" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>下载官网：<a
  href="https://code.visualstudio.com/"
    target="_blank"
  >Visual Studio Code - Code Editing. Redefined</a></p>
<p>安装的时候注意安装位置，避免安装到 C 盘。VS Code 确实是一个开箱即用的优秀文本编辑器，但是要让它完美配合 Python，还需要进行一些配置。点击活动栏上的扩展图标，然后搜索 Python。安装作者显示为微软（Microsoft）的官方 Python 插件。待其安装完成之后，可以点击需要重新加载按钮来完成安装。或者也可以完全重启 VS Code。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805220205684" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805220205684.png">

  
</figure>
</p>
<p><strong>命令面板</strong>：按下 F1 键或者快捷键：Ctrl+Shift+P（Windows 系统）或者 Command-Shift-P（macOS系统），可以打开命令面板。如果对某些东西拿不准，你首先就应该想到命令面板。VS Code 所有功能的快捷入口都在其中。</p>
<p>Windows中，打开命令面板，输入 <strong>default profile</strong>。选择“终端：选择默认配置文件”这一项，然后按回车键。在下拉菜单中，选择命令提示符并按回车键确认。我们需要这样设置，以便 VS Code 正常激活 Conda 环境。</p>

<h4 class="relative group">2.3.2 执行Python脚本 
    <div id="232-执行python脚本" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#232-%e6%89%a7%e8%a1%8cpython%e8%84%9a%e6%9c%ac" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>虽然可以从 Windows 的开始菜单或者 macOS 的启动台打开 VS Code，但是直接<strong>从 Anaconda Prompt 中打开</strong>会更快——可以<strong>直接用 code 命令启动 VS Code</strong>。接下来，打开一个新的 Anaconda Prompt，通过 cd 命令将目录切换到你希望进行操作的地方，然后让 VS Code 打开当前目录（<strong>用点表示</strong>）：</p>
<pre tabindex="0"><code>(base) C:\Users\SHY&gt;conda activate xl38
(xl38) C:\Users\SHY&gt;cd ..
(xl38) C:\Users&gt;cd ..
(xl38) C:\&gt;D:
(xl38) D:\&gt;cd D:\DevTools\Jupyter\python-for-excel-1st-edition
(xl38) D:\DevTools\Jupyter\python-for-excel-1st-edition&gt;
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805221321701" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805221321701.png">

  
</figure>
</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805221715061" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805221715061.png">

  
</figure>
</p>
<p>以这种方式启动 VS Code 可以让活动栏中的<strong>资源浏览器</strong>自动<strong>显示启动目录中的内容</strong>。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805221649702" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805221649702.png">

  
</figure>
</p>
<p>把鼠标悬停在活动栏的资源管理器中的文件上时，会看到<strong>新建文件</strong>按钮。点击新建文件，取名为 hello_world.py，然后按回车键。当文件在编辑器中打开之后，输入下面这行代码：</p>
<pre tabindex="0"><code>print(&#34;hello world!&#34;)
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805222237473" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805222237473.png">

  
</figure>
</p>
<p>状态栏中，应该可以看到 Python 的版本，比如“Python 3.8.5 64-bit (conda)”。如果点一下，命令面板会显示让你选择一个不同的 Python 解释器（如果你有好几个的话），也包括不同的 Conda 环境。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805222630367" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805222630367.png">

  
</figure>
</p>
<p>在执行脚本之前，一定要先保存。在 Windows 中可以按快捷键 Ctrl+S 进行保存。</p>
<p>在 VS Code 中，可以通过 Anaconda Prompt运行，也可以直接点运行按钮。当你要执行一个服务器上的脚本时，可能更多地还是从Anaconda Prompt 中执行，所以有必要知道具体如何操作。</p>
<p><strong>Anaconda Prompt</strong>：打开 Anaconda Prompt，将 cd 放入脚本所在的文件夹中，按如下方式运行脚本：</p>
<pre tabindex="0"><code>(xl38)&gt; cd cd D:\DevTools\Jupyter\python-for-excel-1st-edition
(xl38)&gt; python hello_world.py
hello world!
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805223104738" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805223104738.png">

  
</figure>
</p>
<p>注意，如果你当前不在 Python 文件所在的目录，则需要使用完整路径。</p>
<p><strong>1、VS Code 中的 Anaconda Prompt：</strong></p>
<p>不必为了使用 Anaconda Prompt 而从 VS Code 中切换出去。在 VS Code 中可以直接通过<strong>快捷键 Ctrl+`</strong> 或者“<strong>查看 &gt; 终端”菜单项显示集成终端</strong>。由于集成终端会在项目所在文件夹中打开，因此也不需要切换目录</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805224408386" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805224408386.png">

  
</figure>
</p>
<p><strong>2、VS Code 中的运行按钮</strong></p>
<p>在 VS Code 中，有一种无须使用 Anaconda Prompt 也能运行代码的简单方法。在编辑Python 文件时，你会在右上方看到一个播放图标，这就是运行文件按钮。点击这个按钮会自动在底部打开终端并运行代码。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805224615719" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805224615719.png">

  
</figure>
</p>
<p><strong>3、在 VS Code 中打开文件</strong></p>
<p>当你在资源管理器（位于活动栏）中单击一个文件时，VS Code 会有一些令人意外的默认行为。<strong>单击文件后，文件会以预览模式打开</strong>，意思就是说如果没有对这个文件进行更改，那么你下一次单击打开的文件会替换掉这个文件的标签页。如果想<strong>关掉单击操作</strong>的这种行为（变成单击选定文件，双击打开），可以在“首选项 &gt; 设置”中（或者用快捷键，在 Windows 中是 Ctrl+,，在 macOS中是 Command-,）将“工作台 &gt;‘List: Open Mode’”设置为“doubleClick”。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805225422372" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805225422372.png">

  
</figure>
</p>
<p>拓展：</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805225802396" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805225802396.png">

  
</figure>
</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250805225841756" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250805225841756.png">

  
</figure>
</p>
<hr>

<h2 class="relative group">第三章 Python 入门 
    <div id="第三章-python-入门" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e7%ac%ac%e4%b8%89%e7%ab%a0-python-%e5%85%a5%e9%97%a8" aria-label="锚点">#</a>
    </span>        
    
</h2>
<p>本章首先会介绍 Python 的<strong>基本数据类型，<strong>比如整型和字符串。然后会介绍 Python 的核心概念——<strong>索引和切片</strong>，使你可以访问一个序列的指定元素。接下来会讲到</strong>列表和字典等数据结构</strong>，它们可以保存多个对象。之后会介绍 Python 中的<strong>控制流</strong>：if 语句、for 循环和 while 循环。紧接着是<strong>函数和模块</strong>的相关知识，它们可以用来组织和架构你的代码。最后会展示应该如何正确<strong>格式化 Python 代码</strong>。</p>

<h3 class="relative group">3.1 数据类型 
    <div id="31-数据类型" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#31-%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>最常用的数据类型有<strong>整型</strong>、<strong>浮点型</strong>、<strong>布尔值</strong>和<strong>字符串</strong>。要理解什么是数据类型，需要先解释一下什么是对象。</p>

<h4 class="relative group">3.1.1 对象 
    <div id="311-对象" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#311-%e5%af%b9%e8%b1%a1" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>在 Python 中，<strong>一切皆对象（object）</strong>。数字、字符串、函数，以及我们会在本章中见到的其他所有东西，它们都是对象。通过提供一系列变量和函数，对象可以让复杂的东西简单化。先来看看变量和函数。</p>
<p>1、<strong>变量</strong>：</p>
<p>在 Python 中，变量（<strong>variable</strong>）是通过<strong>等号</strong>给对象<strong>赋予</strong>的一个名字。 Python 中，可以通过给变量赋值一个新的对象来<strong>改变变量的类型</strong>。这种行为被称作<strong>动态类型</strong>：</p>
<pre tabindex="0"><code>In [2]: a = 3
 print(a)
 a = &#34;three&#34;
 print(a)
 
3
three
</code></pre><p>Python 是区分大小写的，因此 a 和 A 是不同的变量。变量名必须遵守下列规则：</p>
<p>​	• 必须以字母或下划线开头；</p>
<p>​	• 只能由字母、数字和下划线组成。</p>
<p>2、<strong>函数</strong></p>
<p>要调用一个函数，需要在函数名后跟上一对圆括号，并在圆括号中提供参数，和数学记法几乎一模一样：</p>
<pre tabindex="0"><code>function_name(argument1, argument2, ...)
</code></pre><p>3、<strong>属性和方法</strong></p>
<p>谈到对象时，<strong>变量</strong>被称作<strong>属性</strong>（attribute）1 ，<strong>函数</strong>被称作<strong>方法</strong>（method）。你可以通过<strong>属性</strong>来<strong>访问</strong>对象的<strong>数据</strong>，而<strong>方法</strong>可以用来<strong>执行</strong>某种<strong>操作</strong>。你可以通过<strong>点号</strong>来<strong>访问属性和方法</strong>，比如 myobject.attribute 和 myobject.method()。</p>
<p>如果你在写一个赛车游戏，那么很可能需要表示车的对象。<strong>car 对象</strong>应该有一个 <strong>speed 属性</strong>，这样你就可以通过 car.speed 来获取车辆的当前速度。或许还可以通过<strong>调用加速方法</strong> car.acc.accelerate(10) 来让车辆加速，即让车速增加到每小时 10 英里。</p>
<p><strong>对象的类型及其行为是由类（class）定义的</strong>，因此在前面的例子中，你可能需要编写一个 Car 类。从 Car <strong>类构造</strong> car <strong>对象</strong>的过程叫作<strong>实例化</strong>（instantiation）。要<strong>实例化一个对象</strong>，需要<strong>像调用函数那样去调用类</strong>：car = Car()。</p>

<h4 class="relative group">3.1.2 数值类型 
    <div id="312-数值类型" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#312-%e6%95%b0%e5%80%bc%e7%b1%bb%e5%9e%8b" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>int 和 float 分别表示整数（integer）和浮点数（floating-point number）。通过内置的 type 函数可以获得指定对象的类型：</p>
<pre tabindex="0"><code>In [3]: type(4)
Out[3]: int
In [4]: type(4.4)
Out[4]: float
</code></pre><p>强制让一个数字成为 float 类型而不是 int 类型，可以在后面加一个小数点，或者使用 float 构造器：</p>
<pre tabindex="0"><code>In [5]: type(4.)
Out[5]: float
In [6]: float(4)
Out[6]: 4.0
</code></pre><p>对于整型也是一样的，int 构造器可以将一个 float 值转换为 int。如果小数部分不为零，那么转换时会直接舍去。</p>
<pre tabindex="0"><code>In [7]: int(4.9)
Out[7]: 4
</code></pre><p><strong>Excel 单元格永远保存的是浮点数</strong>：从 Excel 单元格读取数字的时候，可能需要先把 float 转换为 int，然后才能把它传给一个需要整型参数的函数。原因是即使 Excel 显示的是整数，但在背后它总是以浮点数形式存储。</p>

<h4 class="relative group">3.1.3 布尔值 
    <div id="313-布尔值" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#313-%e5%b8%83%e5%b0%94%e5%80%bc" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>Python 中，布尔类型只有 True 和 False 两种取值，Python 中的布尔运算符 and、or 和 not 全是小写形式。每个 Python 对象都可以被视作 True 或 False。大部分的对象会被视作 True，但 None、False、0 或<strong>空数据类型</strong> [ 比如空字符串（下一节中会讲到字符串）] 会被视作 False。</p>
<p>None 是一个<strong>内置的常量</strong>，按照官方文档的说法，它代表“没有值”（the absence of a value）。如果一个函数没有显式地返回值，那么它实际上返回的就是 None。None 可以用来表示 Excel 中的空单元格。</p>

<h4 class="relative group">3.1.4 字符串 
    <div id="314-字符串" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#314-%e5%ad%97%e7%ac%a6%e4%b8%b2" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>Python 中的字符串既可以用双引号（&quot;）来表示，也可以用单引号（&rsquo;）来表示。唯一的要求是字符串的首尾必须是同一种引号。可以用 + 来拼接字符串，或者用 * 来重复字符串的内容。如果发现字符串的内容还是需要转义，可以用反斜杠来转义字符：</p>
<pre tabindex="0"><code>In [31]: print(&#34;Don&#39;t wait! &#34; + &#39;Learn how to &#34;speak&#34; Python.&#39;)
Don&#39;t wait! Learn how to &#34;speak&#34; Python.
In [32]: print(&#34;It&#39;s easy to \&#34;escape\&#34; characters with a leading \\.&#34;)
It&#39;s easy to &#34;escape&#34; characters with a leading \.
</code></pre><p>当字符串中<strong>包含变量</strong>的值时，通常可以使用 <strong>f 字符串</strong>（f-string，格式化字符串字面量，formatted string literal 的缩写）来处理。</p>
<pre tabindex="0"><code>In [33]: # 注意Python如何在一行中为多个变量赋予多个值
 first_adjective, second_adjective = &#34;free&#34;, &#34;open source&#34;
 f&#34;Python is {first_adjective} and {second_adjective}.&#34;
Out[33]: &#39;Python is free and open source.&#39;
</code></pre><p>转换大小写：</p>
<pre tabindex="0"><code>In [34]: &#34;PYTHON&#34;.lower()
Out[34]: &#39;python&#39;
In [35]: &#34;python&#34;.upper()
Out[35]: &#39;PYTHON&#39;
</code></pre><p><strong>获取帮助</strong>：在 Jupyter 笔记本中，敲入对象后面的点之后按 Tab 键，比如 &ldquo;python&rdquo;.<Tab>。画面上会出现一个下拉菜单，其中包含了这个对象提供的所有属性和方法。如果你的光标停在一个方法上，比如停在 &ldquo;python&rdquo;.upper() 的括号中，按下快捷键 <strong>Shift+Tab</strong> 就可以获得这个函数的描述信息。VS Code 会以提示的形式自动显示这些信息。如果你在 Anaconda Prompt 中运行 Python REPL，使用dir(&ldquo;python&rdquo;) 可以获得可用的属性，而使用 help(&ldquo;python&rdquo;,upper) 可以打印 upper 方法的描述信息。除此之外，也应该经常看一下 Python 的在线文档。如果你在找 pandas 之类的第三方包的文档，可以在 PyPI（Python 包索引）中搜索对应的包，在这里可以找到这些包的主页和文档的链接。</p>

<h3 class="relative group">3.2 索引和切片 
    <div id="32-索引和切片" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#32-%e7%b4%a2%e5%bc%95%e5%92%8c%e5%88%87%e7%89%87" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>索引和切片让你可以访问一个序列的指定元素。</p>

<h4 class="relative group">3.2.1 索引 
    <div id="321-索引" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#321-%e7%b4%a2%e5%bc%95" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>Python 的索引从 0 开始，意思就是说序列的第一个元素通过 0 来引用。负索引从 -1 开始，你可以用负索引从序列末端引用元素。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250806181948712" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250806181948712.png">

  
</figure>
</p>
<p>索引的语法如下：</p>
<pre tabindex="0"><code>sequence[index]
</code></pre><p>访问字符串的指定元素：</p>
<pre tabindex="0"><code>In [36]: language = &#34;PYTHON&#34;
In [37]: language[0]
Out[37]: &#39;P&#39;
In [38]: language[1]
Out[38]: &#39;Y&#39;
In [39]: language[-1]
Out[39]: &#39;N&#39;
In [40]: language[-2]
Out[40]: &#39;O&#39;
</code></pre>
<h4 class="relative group">3.2.2 切片 
    <div id="322-切片" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#322-%e5%88%87%e7%89%87" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>如果你想从一个序列中获取一个以上的元素，就要用到切片（<strong>slicing</strong>）语法：</p>
<pre tabindex="0"><code>sequence[start:stop:step]
</code></pre><p>Python 使用的是<strong>左闭右开区间</strong>，意思是切片<strong>区间包含 start，但不包含 stop</strong>。如果省略了 start 或者 stop，则切片会分别包含从头开始或者从末尾开始的所有元素。step 决定了切片的方向和步长。如果令步长为 2，那么切片就会从左到右每两个元素取一个值；如果令步长为 -3，则切片会从右到左每 3 个元素取一个值。默认步长为 1:</p>
<pre tabindex="0"><code>In [41]: language[:3] # 同language[0:3]
Out[41]: &#39;PYT&#39;
In [42]: language[1:3]
Out[42]: &#39;YT&#39;
In [43]: language[-3:] # 同language[-3:6]
Out[43]: &#39;HON&#39;
In [44]: language[-3:-1]
Out[44]: &#39;HO&#39;
In [45]: language[::2] # 每两个元素取一个
Out[45]: &#39;PTO&#39;
In [46]: language[-1:-4:-1] # 负步长从右到左
Out[46]: &#39;NOH&#39;
</code></pre><p>Python 也可以将<strong>多次索引和切片操作串联</strong>起来。如果你想获得最后 3 个字符中的第二个，可以像下面这样做：</p>
<pre tabindex="0"><code>In [47]: language[-3:][1]
Out[47]: &#39;O&#39;
</code></pre><p>上述代码和 language[-2] 是等价的，连续索引并不会简单到哪儿去。但是在索引和切片列表的时候，连续索引会显得更有条理一些。</p>

<h3 class="relative group">3.3 数据结构 
    <div id="33-数据结构" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#33-%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>Python 提供了强大的数据结构以便于<strong>处理对象集合</strong>。本节会介绍<strong>列表</strong>、<strong>字典</strong>、<strong>元组</strong>和<strong>集合</strong>。虽然每种数据结构有各自的特点，但它们有一个<strong>共同特点</strong>，即都能<strong>存储多个对象</strong>。</p>

<h4 class="relative group">3.3.1 列表 
    <div id="331-列表" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#331-%e5%88%97%e8%a1%a8" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>列表（list）可以存储<strong>不同数据类型</strong>的多个对象。用途广泛，可以随时使用。创建列表的语法如下：</p>
<pre tabindex="0"><code>[element1, element2, ...]
</code></pre><p>实例，下面是两个列表，一个保存了一些 Excel 文件的名称，另一个保存了几个数字：</p>
<pre tabindex="0"><code>In [48]: file_names = [&#34;one.xlsx&#34;, &#34;two.xlsx&#34;, &#34;three.xlsx&#34;]
 		 numbers = [1, 2, 3]
</code></pre><p>和字符串一样，列表也可以<strong>用加号进行拼接</strong>。下面的代码还体现了列表的一个<strong>特性</strong>，那就是它可以保存<strong>不同类型</strong>的对象：</p>
<pre tabindex="0"><code>In [49]: file_names + numbers
Out[49]: [&#39;one.xlsx&#39;, &#39;two.xlsx&#39;, &#39;three.xlsx&#39;, 1, 2, 3]
</code></pre><p>列表也是对象，也可以<strong>包含其他列表作为元素</strong>。我称之为<strong>嵌套列表</strong>（nested list）：</p>
<pre tabindex="0"><code>In [50]: nested_list = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]
</code></pre><p>把这种<strong>嵌套列表写成多行</strong>，你就会发现列表可以很好地<strong>表示矩阵和工作表单元格</strong>。注意，这些方括号会隐式地让代码<strong>跨行</strong>（参见“跨行”）。通过<strong>索引和切片</strong>，你可以获得想要的任何元素。</p>
<pre tabindex="0"><code>In [51]: cells = [[1, 2, 3],
 				  [4, 5, 6],
 				  [7, 8, 9]]
In [52]: cells[1] # 第二行
Out[52]: [4, 5, 6]
In [53]: cells[1][1:] # 第二行的第二列和第三列
Out[53]: [5, 6]
</code></pre><p>更改列表中的元素：</p>
<pre tabindex="0"><code>In [56]: users = [&#34;Linda&#34;, &#34;Brian&#34;]
In [57]: users.append(&#34;Jennifer&#34;) # 最常用的操作是向列表末尾追加元素
		 users
Out[57]: [&#39;Linda&#39;, &#39;Brian&#39;, &#39;Jennifer&#39;]
In [58]: users.insert(0, &#34;Kim&#34;) # 在索引0处插入&#34;Kim&#34;
		 users
Out[58]: [&#39;Kim&#39;, &#39;Linda&#39;, &#39;Brian&#39;, &#39;Jennifer&#39;]
</code></pre><p>要删除一个元素，可以使用 pop 或者 del。pop 是一个方法，而 del 是一种 Python 语句：</p>
<pre tabindex="0"><code>In [59]: users.pop() # 在默认情况下，移除并返回最后一个元素
Out[59]: &#39;Jennifer&#39;
In [60]: users
Out[60]: [&#39;Kim&#39;, &#39;Linda&#39;, &#39;Brian&#39;]
In [61]: del users[0] # del会移除指定索引处的元素
</code></pre><p>可以对列表进行以下操作：</p>
<pre tabindex="0"><code>In [62]: len(users) # 长度
Out[62]: 2
In [63]: &#34;Linda&#34; in users # 检查users是否包含&#34;Linda&#34;
Out[63]: True
In [64]: print(sorted(users)) # 返回新的排好序的列表
 		 print(users) # 原列表保持不变
		 [&#39;Brian&#39;, &#39;Linda&#39;]
		 [&#39;Linda&#39;, &#39;Brian&#39;]
In [65]: users.sort() # 对原列表进行排序
 		 users
Out[65]: [&#39;Brian&#39;, &#39;Linda&#39;]
</code></pre><p>也可以把 len 和 in 用在字符串上：</p>
<pre tabindex="0"><code>In [66]: len(&#34;Python&#34;)
Out[66]: 6
In [67]: &#34;free&#34; in &#34;Python is free and open source.&#34;
Out[67]: True
</code></pre><p>要访问列表中的元素，可以通过元素的**位置（索引）**来引用一个元素——但并非任何时候都能知道元素的位置。</p>

<h4 class="relative group">3.3.2 字典 
    <div id="332-字典" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#332-%e5%ad%97%e5%85%b8" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>字典（dictionary）是<strong>键到值的映射</strong>。你会经常遇到<strong>键 – 值对</strong>。创建字典最简单的方法如下：</p>
<pre tabindex="0"><code>{key1: value1, key2: value2, ...}
</code></pre><p>和索引一样，<strong>键也被放在方括号中</strong>。下面的代码中，一对货币（键）映射到了汇率（值）：</p>
<pre tabindex="0"><code>In [68]: exchange_rates = {&#34;EURUSD&#34;: 1.1152,
						   &#34;GBPUSD&#34;: 1.2454,
						   &#34;AUDUSD&#34;: 0.6161}
In [69]: exchange_rates[&#34;EURUSD&#34;] # 访问EURUSD的汇率
Out[69]: 1.1152
</code></pre><p>下面的代码展示了如何修改既存的值以及添加新的键 – 值对：</p>
<pre tabindex="0"><code>In [70]: exchange_rates[&#34;EURUSD&#34;] = 1.2 # 修改已经存在的值
 		 exchange_rates
Out[70]: {&#39;EURUSD&#39;: 1.2, &#39;GBPUSD&#39;: 1.2454, &#39;AUDUSD&#39;: 0.6161}
In [71]: exchange_rates[&#34;CADUSD&#34;] = 0.714 # 添加新的键–值对
 		 exchange_rates
Out[71]: {&#39;EURUSD&#39;: 1.2, &#39;GBPUSD&#39;: 1.2454, &#39;AUDUSD&#39;: 0.6161, &#39;CADUSD&#39;: 0.714}
</code></pre><p>合并两个或多个字典的最简单的办法是将<strong>字典解包</strong>（unpack）后<strong>再合并</strong>到一个<strong>新的字典</strong>中。在字典前<strong>加上两个星号就可以进行解包</strong>。如果第二个字典包含第一个字典中的键，那么第一个字典中对应的值会被覆盖。</p>
<pre tabindex="0"><code>In [72]: {**exchange_rates, **{&#34;SGDUSD&#34;: 0.7004, &#34;GBPUSD&#34;: 1.2222}}
Out[72]: {&#39;EURUSD&#39;: 1.2,
 		  &#39;GBPUSD&#39;: 1.2222,
 		  &#39;AUDUSD&#39;: 0.6161,
		  &#39;CADUSD&#39;: 0.714,
		  &#39;SGDUSD&#39;: 0.7004}
</code></pre><p>Python 3.9 引入了<strong>管道符号</strong> 作为专门的<strong>字典合并运算符</strong>。上面的表达式可以简化成如下代码：</p>
<pre tabindex="0"><code>exchange_rates | {&#34;SGDUSD&#34;: 0.7004, &#34;GBPUSD&#34;: 1.2222}
</code></pre><p>get 方法可以在键不存在时返回一个默认值：</p>
<pre tabindex="0"><code>In [75]: # currencies[100]会引发异常
		 # 除了100，还可以尝试任何不存在的键
		 currencies.get(100, &#34;N/A&#34;)
Out[75]: &#39;N/A&#39;
</code></pre>
<h4 class="relative group">3.3.3 元组 
    <div id="333-元组" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#333-%e5%85%83%e7%bb%84" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>元组（tuple）和列表类似，只不过它们是<strong>不可变</strong>的（immutable）：一旦被创建，它们的元素就无法被修改。虽然很多时候元组和列表可以<strong>互换使用</strong>，但对于那些在整个程序中都不会发生改变的集合来说，元组是不二之选。元组是通过<strong>多个被逗号分隔的值</strong>创建的：</p>
<pre tabindex="0"><code>mytuple = element1, element2, ...
</code></pre><p>使用圆括号通常更易于阅读：</p>
<pre tabindex="0"><code>In [76]: currencies = (&#34;EUR&#34;, &#34;GBP&#34;, &#34;AUD&#34;)
</code></pre><p>可以使用访问数组的方法来访问元组，只是不能修改元组的元素。拼接元组会在“暗地里”创建一个新的元组，然后再把新元组绑定到你的变量上：</p>
<pre tabindex="0"><code>In [77]: currencies[0] # 访问第一个元素
Out[77]: &#39;EUR&#39;
In [78]: # 拼接元组会返回一个新元组
 		 currencies + (&#34;SGD&#34;,)
Out[78]: (&#39;EUR&#39;, &#39;GBP&#39;, &#39;AUD&#39;, &#39;SGD&#39;)
</code></pre><p>附录 C 中会解释<strong>可变对象</strong>和<strong>不可变对象</strong>之间的<strong>区别</strong>。</p>

<h4 class="relative group">3.3.4 集合 
    <div id="334-集合" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#334-%e9%9b%86%e5%90%88" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>集合（set）是一种<strong>没有重复元素</strong>的集合（collection）。你自然可以把集合用于集合论的运算中，但在<strong>实践中</strong>它们经常被<strong>用于列表去重</strong>或者<strong>元组去重</strong>。使用花括号创建集合：</p>
<pre tabindex="0"><code>{element1, element2, ...}
</code></pre><p>要对列表或者元组进行去重，可以像下面这样使用 <strong>set 构造器</strong>：</p>
<pre tabindex="0"><code>In [79]: set([&#34;USD&#34;, &#34;USD&#34;, &#34;SGD&#34;, &#34;EUR&#34;, &#34;USD&#34;, &#34;EUR&#34;])
Out[79]: {&#39;EUR&#39;, &#39;SGD&#39;, &#39;USD&#39;}
</code></pre><p>还可以进行像交集和并集之类的集合论运算：</p>
<pre tabindex="0"><code>In [80]: portfolio1 = {&#34;USD&#34;, &#34;EUR&#34;, &#34;SGD&#34;, &#34;CHF&#34;}
		 portfolio2 = {&#34;EUR&#34;, &#34;SGD&#34;, &#34;CAD&#34;}
In [81]: # 同 portfolio2.union(portfolio1)
		 portfolio1.union(portfolio2)
Out[81]: {&#39;CAD&#39;, &#39;CHF&#39;, &#39;EUR&#39;, &#39;SGD&#39;, &#39;USD&#39;}
In [82]: # 同 portfolio2.intersection(portfolio1)
		 portfolio1.intersection(portfolio2)
Out[82]: {&#39;EUR&#39;, &#39;SGD&#39;}
</code></pre><p>回顾一下刚刚认识的 4 种数据结构，使用前面用过的<strong>字面量（literal）记法</strong>。另外，列出它们的构造器。和字面量一样，<strong>构造器可以创建对应的数据结构</strong>，并且通常用于数据结构之间的相互<strong>转换</strong>。例如，要把元组转换为列表，可以执行以下操作：</p>
<pre tabindex="0"><code>In [83]: currencies = &#34;USD&#34;, &#34;EUR&#34;, &#34;CHF&#34;
 		 currencies
Out[83]: (&#39;USD&#39;, &#39;EUR&#39;, &#39;CHF&#39;)
In [84]: list(currencies)
Out[84]: [&#39;USD&#39;, &#39;EUR&#39;, &#39;CHF&#39;]
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250806230125779" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250806230125779.png">

  
</figure>
</p>

<h3 class="relative group">3.4 控制流 
    <div id="34-控制流" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#34-%e6%8e%a7%e5%88%b6%e6%b5%81" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>介绍 if 语句、for 循环和 while 循环。if 只会在满足特定条件时执行特定的代码，for 循环和 while 循环会反复执行代码块中的代码。</p>

<h4 class="relative group">3.4.1 代码块和pass语句 
    <div id="341-代码块和pass语句" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#341-%e4%bb%a3%e7%a0%81%e5%9d%97%e5%92%8cpass%e8%af%ad%e5%8f%a5" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p><strong>代码块</strong>（code block）界定了一段源代码，这段代码会用于一些特定的目的。在 Python 中，代码块通过缩进来体现，而不像包括 VBA 在内的大部分编程语言那样——使用花括号。这就是所谓的有特殊含义的空白（significant white space）。Python 社区坚持<strong>使用 4 个空格作为缩进</strong>，不过你通常只需要敲一次 Tab 键就行了。Jupyter 笔记本和 VS Code 都会自动将 Tab 键转换为 4 个空格。代码块的前一行总是会<strong>以冒号结尾</strong>。一旦<strong>某一行没有被缩进</strong>，代码块就<strong>自然结束</strong>了。</p>

<h4 class="relative group">3.4.2 if语句和条件表达式 
    <div id="342-if语句和条件表达式" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#342-if%e8%af%ad%e5%8f%a5%e5%92%8c%e6%9d%a1%e4%bb%b6%e8%a1%a8%e8%be%be%e5%bc%8f" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>在 Python 中，if 语句本身不需要任何的圆括号。要检查一个值是否为 True，并不需要显式地写这样一个表达式。</p>
<p><strong>条件表达式</strong>（conditional expression）或者<strong>三元运算符</strong>（ternary operator）可以以一种更紧凑的形式编写 if/else 语句：</p>
<pre tabindex="0"><code>In [88]: is_important = False
		 print(&#34;important&#34;) if is_important else print(&#34;not important&#34;)
not important
</code></pre>
<h4 class="relative group">3.4.3 for 循环和 while 循环 
    <div id="343-for-循环和-while-循环" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#343-for-%e5%be%aa%e7%8e%af%e5%92%8c-while-%e5%be%aa%e7%8e%af" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>for 循环会对一个<strong>序列</strong> [ 比如<strong>列表</strong>、<strong>元组</strong>、<strong>字符串</strong>（记住，字符串就是字符的序列）] 进行迭代。</p>
<pre tabindex="0"><code>In [89]: currencies = [&#34;USD&#34;, &#34;GBP&#34;, &#34;AUD&#34;]
		 for currency in currencies:
		 	 print(currency)
USD 
GBP
AUD
</code></pre><p>在 Python 中，如果你在 for 循环中需要一个<strong>计数器变量</strong>，那么可以用<strong>内置的 range 函数</strong>和<strong>enumerate 函数</strong>。先来看看 range，它会提供一连串的数字。你可以只提供一个 stop 参数，也可以同时提供 start 参数和 stop 参数，还可以提供一个可选的 step 参数。和切片类似，range 产生的区间<strong>包含 start</strong>，但<strong>不包含 stop</strong>，step 决定了步长，默认为 1：</p>
<pre tabindex="0"><code>range(stop)
range(start, stop, step)
</code></pre><p>range 会延迟求值，意思就是说只要你不明确要求求值，它就不会产生指定的序列：</p>
<pre tabindex="0"><code>In [90]: range(5)
Out[90]: range(0, 5)
</code></pre><p>将 range 转换为列表可以解决这个问题：</p>
<pre tabindex="0"><code>In [91]: list(range(5)) # stop参数
Out[91]: [0, 1, 2, 3, 4]
In [92]: list(range(2, 5, 2)) # start、stop和step 3个参数
Out[92]: [2, 4]
</code></pre><p>不过大部分时候没必要把 range 包装成一个列表：</p>
<pre tabindex="0"><code>for i in range(3):
	print(i)
# 输出结果 	
0
1
2
</code></pre><p>如果在迭代序列时需要一个<strong>计数器变量</strong>，那么可以使用 enumerate。它会返回一系列 (index, element) 元组。 在默认情况下，索引从 0 开始，每次循环加 1。在循环中可以这样使用 enumerate：</p>
<pre tabindex="0"><code>for i, currency in enumerate(currencies):
    print(i, currency)
# 输出结果     
0 USD
1 GBP
2 AUD
</code></pre><p>在元组和集合中进行循环与在列表中类似。在字典中进行循环时，Python 会按照键进行循环：</p>
<pre tabindex="0"><code>exchange_rates = {&#34;EURUSD&#34;: 1.1152,
                  &#34;GBPUSD&#34;: 1.2454,
                  &#34;AUDUSD&#34;: 0.6161}
for currency_pair in exchange_rates:
    print(currency_pair)
# 输出结果    
EURUSD
GBPUSD
AUDUSD
</code></pre><p>items 方法可以以元组的形式同时获得键和对应的值：</p>
<pre tabindex="0"><code>for currency_pair, exchange_rate in exchange_rates.items():
    print(currency_pair, exchange_rate)
    
# 输出结果 
EURUSD 1.1152
GBPUSD 1.2454
AUDUSD 0.6161
</code></pre><p>break 语句可以跳出循环：</p>
<pre tabindex="0"><code>for i in range(15):
    if i == 2:
        break 
    else:
        print(i)
        
# 输出结果
0
1
</code></pre><p>可以使用 continue 语句跳过本轮循环的剩余部分。即程序会使用下一个元素进入下一轮迭代：</p>
<pre tabindex="0"><code>for i in range(4):
    if i == 2:
        continue
    else:
        print(i)
        
# 输出结果
0 
1
3
</code></pre><p>使用 while 循环，循环会在条件不满足时停止：</p>
<pre tabindex="0"><code>n = 0
while n &lt;= 2:
    print(n)
    n += 1
    
# 输出结果
0
1
2
</code></pre><p><strong>增强赋值</strong>：上一个例子中使用了增强赋值（augmented assignment）的写法：n += 1。这和 n = n + 1 是一样的。前面介绍过的其他算术运算符也可以采用同样的写法，比如，可以写成 n -= 1。</p>

<h4 class="relative group">3.4.4 列表、字典和集合推导式 
    <div id="344-列表字典和集合推导式" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#344-%e5%88%97%e8%a1%a8%e5%ad%97%e5%85%b8%e5%92%8c%e9%9b%86%e5%90%88%e6%8e%a8%e5%af%bc%e5%bc%8f" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>假设有如下的货币名称对，你想把美元在后面的元素挑出来。你可能会写下面这样一个 for 循环：</p>
<pre tabindex="0"><code>currency_pairs = [&#34;USDJPY&#34;, &#34;USDGBP&#34;, &#34;USDCHF&#34;,
                  &#34;USDCAD&#34;, &#34;AUDUSD&#34;, &#34;NZDUSD&#34;]
usd_quote = []
for pair in currency_pairs:
    if pair[3:] == &#34;USD&#34;:
        usd_quote.append(pair[:3])
usd_quote、
# 输出结果
[&#39;AUD&#39;, &#39;NZD&#39;]
</code></pre><p>这种情况用<strong>列表推导式</strong>（list comprehension）会更简单。列表推导式是一种更简洁的列表创建方法。</p>
<pre tabindex="0"><code>[pair[:3] for pair in currency_pairs if pair[3:] == &#34;USD&#34;]
# 输出结果
[&#39;AUD&#39;, &#39;NZD&#39;]
</code></pre><p>字典也有字典推导式：</p>
<pre tabindex="0"><code>In [105]: exchange_rates = {&#34;EURUSD&#34;: 1.1152,
 							&#34;GBPUSD&#34;: 1.2454,
							&#34;AUDUSD&#34;: 0.6161}	
		  {k: v * 100 for (k, v) in exchange_rates.items()}
Out[105]: {&#39;EURUSD&#39;: 111.52, &#39;GBPUSD&#39;: 124.54, &#39;AUDUSD&#39;: 61.61}
</code></pre><p>集合也有集合推导式：</p>
<pre tabindex="0"><code>In [106]: {s + &#34;USD&#34; for s in [&#34;EUR&#34;, &#34;GBP&#34;, &#34;EUR&#34;, &#34;NZD&#34;, &#34;NZD&#34;]}
Out[106]: {&#39;EURUSD&#39;, &#39;GBPUSD&#39;, &#39;NZDUSD&#39;}
</code></pre>
<h3 class="relative group">3.5 组织代码 
    <div id="35-组织代码" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#35-%e7%bb%84%e7%bb%87%e4%bb%a3%e7%a0%81" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>如何让代码形成可维护的结构：首先会介绍函数的核心知识，然后如何将代码分成不同的 Python 模块。</p>

<h4 class="relative group">3.5.1 函数 
    <div id="351-函数" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#351-%e5%87%bd%e6%95%b0" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>即使只是用 Python 来写一些简单的脚本，你仍然会经常编写函数。函数是所有编程语言中最重要的构造，它们可以让你在程序的任何地方重用同样的代码。</p>

<h5 class="relative group">1. 定义函数 
    <div id="1-定义函数" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#1-%e5%ae%9a%e4%b9%89%e5%87%bd%e6%95%b0" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>在 Python 中，需要使用 def 关键字来自定义函数，def 代表函数定义。函数定义的第一行以冒号结束，函数的主体需要缩进。</p>
<pre tabindex="0"><code>def function_name(required_argument, optional_argument=default_value, ...):
 	return value1, value2, ...
</code></pre><p><strong>必需参数</strong>：必需参数（required argument）没有默认值。参数之间用逗号隔开。</p>
<p><strong>可选参数</strong>：为参数提供默认值之后，它就成了可选参数（optional argument）。如果没有有意义的默认值，则通常用 None 作为可选参数的默认值。</p>
<p><strong>返回值</strong>：return 语句定义了函数的返回值。如果<strong>省略了返回值</strong>，那么函数就会<strong>自动返回 None</strong>。Python 允许你返回以逗号隔开的多个返回值，这很方便。</p>
<p>来定义一个函数练习一下，这个函数可以将华氏度或者开氏度转换为摄氏度：</p>
<pre tabindex="0"><code>In [107]: def convert_to_celsius(degrees, source=&#34;fahrenheit&#34;):
			  if source.lower() == &#34;fahrenheit&#34;:
				  return (degrees-32) * (5/9)
			  elif source.lower() == &#34;kelvin&#34;:
				  return degrees - 273.15
 			  else:
 				  return f&#34;Don&#39;t know how to convert from {source}&#34;
</code></pre><p>字符串的 lower 方法可以将给定字符串转换为小写，这样就可以在保持比较字符串的代码照常工作的前提下，接受任何大小写形式的 source 字符串了。完成 convert_to_celsius 的定义后，来看看如何调用它。</p>

<h5 class="relative group">2. 调用函数 
    <div id="2-调用函数" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#2-%e8%b0%83%e7%94%a8%e5%87%bd%e6%95%b0" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>调用一个函数，可以在函数名后加上一对圆括号，并在其中给出参数。</p>
<pre tabindex="0"><code>value1, value2, ... = function_name(positional_arg, arg_name=value, ...)
</code></pre><p><strong>位置参数</strong>：如果将一个值作为位置参数（positional argument，即上面的 positional_arg）传递，那么这个值会被传递给对应位置上的参数。</p>
<p><strong>关键字参数</strong>：以 arg_name=value 这种形式传递的参数，就是关键字参数（keyword argument）。关键字参数的好处是可以以<strong>任意顺序传递参数</strong>，并且对于读者来说更加直观易懂。如果函数被定义成 f(a, b)，则可以像这样调用：f(b=1, a=2)。</p>
<p>下面来尝试一下 convert_to_celsius 函数，看看它是如何工作的：</p>
<pre tabindex="0"><code>In [108]: convert_to_celsius(100, &#34;fahrenheit&#34;) # 位置参数
Out[108]: 37.77777777777778
In [109]: convert_to_celsius(50) # 使用默认值（fahrenheit）
Out[109]: 10.0
In [110]: convert_to_celsius(source=&#34;kelvin&#34;, degrees=0) # 关键字参数
Out[110]: -273.15
</code></pre>
<h4 class="relative group">3.5.2 模块和import语句 
    <div id="352-模块和import语句" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#352-%e6%a8%a1%e5%9d%97%e5%92%8cimport%e8%af%ad%e5%8f%a5" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>为大型项目编写代码时，在一定的时候会需要将代码分成不同的文件，从而保持一种可维护的结构。</p>
<p>Python 文件的扩展名为 .py，通常我们会把<strong>主要的文件</strong>称作<strong>脚本</strong>（script）。如果你想让你的主脚本获得来自其他文件的概念，则需要先<strong>导入</strong>（import）那个功能。在这种情况下，Python 源文件被称为<strong>模块</strong>（module）。</p>
<p><strong>模块只会被导入一次</strong>：如果再一次运行 import temperature 单元格，你会注意到 print 函数不会输出任何内容。这是因为 Python 模块在每个会话中只会被导入一次。如果你要导入的模块发生了更改，则需要重启 Python 解释器才能让更改体现出来。在 Jupyter 笔记本中，需要点击“内核 &gt; 重启”。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250807165717081" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250807165717081.png">

  
</figure>
</p>
<p>在使用 import x from y 这样的语法时，你只导入了指定的对象。这些对象被直接导入主脚本的<strong>命名空间</strong>（namespace）中，也就是说，如果不看这些 import 语句，你就说不清被导入的对象是在你的 Python 脚本（或者 Jupyter 笔记本）中还是在另一个模块中定义的。</p>
<p><strong>不要让你的脚本和既存的包重名</strong>：一个常见的错误根源是给你的 Python 文件取一个和既存的包同样的名字。如果你要创建一个测试 pandas 功能的文件，那么不要将其命名为 pandas.py，因为这会造成冲突。</p>

<h4 class="relative group">3.5.3 datetime类 
    <div id="353-datetime类" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#353-datetime%e7%b1%bb" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>要在 Python 中处理日期和时间，可以导入标准库中的 datetime <strong>模块</strong>。这个模块包含了一个也叫 datetime 的类，可用于创建 datetime 对象。由于这个类和它所在的模块同名，可能会造成混淆，因此在本书中我会遵循这样的导入规则：import datetime as dt。这样可以更容易<strong>区分模块（dt）和类（datetime）</strong>。</p>
<p>到目前为止，我们大部分时候是用<strong>字面量</strong>（literal）来创建列表和字典之类的对象。字面量指的是一种会被 Python 识别为<strong>特定类型对象</strong>的语法。对于列表来说就是像 [1, 2, 3] 这种写法。然而，大部分的<strong>对象需要调用对应的类来创建</strong>——这个过程被称为<strong>实例化</strong>（instantiation），因此<strong>对象也被称作类实例</strong>（class instance）。和调用函数一样，<strong>调用类也需要在类名后跟上一对圆括号</strong>，并在圆括号中<strong>提供参数</strong>。要实例化 datetime 对象，需要像下面这样调用对应的类：</p>
<pre tabindex="0"><code>import datetime as dt
dt.datetime(year, month, day, hour, minute, second, microsecond, timezone)
</code></pre><pre tabindex="0"><code>In [118]: # 将datetime模块导入为dt
		  import datetime as dt
In [119]: # 调用timestamp以创建datetime对象
 		  timestamp = dt.datetime(2020, 1, 31, 14, 30)
		  timestamp
Out[119]: datetime.datetime(2020, 1, 31, 14, 30)
In [120]: # datetime对象提供了多种属性，比如，想要知道它是几号
		  timestamp.day
Out[120]: 31 
In [121]: # 两个datetime对象求差会返回一个timedelta对象
		  timestamp - dt.datetime(2020, 1, 14, 12, 0)
Out[121]: datetime.timedelta(days=17, seconds=9000)
In [122]: # 也可以对timedelta进行同样的操作
		  timestamp + dt.timedelta(days=1, hours=4, minutes=11)
Out[122]: datetime.datetime(2020, 2, 1, 18, 41)
</code></pre><p>要将 datetime 对象<strong>格式化（format）成字符串</strong>，可以使用 <strong>strftime</strong> 方法；要<strong>解析（parse）字符串并将其转换为 datetime 对象</strong>，可以使用 <strong>strptime</strong> 函数：</p>
<pre tabindex="0"><code>In [123]: # 以特定方式格式化datetime对象
 		  # 也可以使用f字符串: f&#34;{timestamp:%d/%m/%Y %H:%M}&#34;
		  timestamp.strftime(&#34;%d/%m/%Y %H:%M&#34;)
Out[123]: &#39;31/01/2020 14:30&#39;
In [124]: # 将字符串解析为datetime对象
 		  dt.datetime.strptime(&#34;12.1.2020&#34;, &#34;%d.%m.%Y&#34;)
Out[124]: datetime.datetime(2020, 1, 12, 0, 0)
</code></pre>
<h3 class="relative group">3.6 PEP 8：Python风格指南 
    <div id="36-pep-8python风格指南" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#36-pep-8python%e9%a3%8e%e6%a0%bc%e6%8c%87%e5%8d%97" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>Python使用所谓的 Python <strong>改进提案</strong>（<strong>Python Enhancement Proposals</strong>，<strong>PEP</strong>）来讨论新语言特性的引入。Python 代码的<strong>风格指南</strong>就是其中之一。这些提案一般用数字来表示，代码风格指南就被称作 PEP 8。PEP 8 是一系列提供给 Python 社区的风格建议。如果使用相同代码的所有人都遵循相同的代码风格，那么写出的<strong>代码可读性就会更高</strong>。在开源的世界中，会有很多互不相识的程序员开发同一个项目，此时<strong>遵循相同的代码风格</strong>会显得尤为重要。</p>
<pre tabindex="0"><code>&#34;&#34;&#34;这个脚本展示了一些PEP 8的规则 ➊ 
&#34;&#34;&#34;
import datetime as dt ➋

TEMPERATURE_SCALES = (&#34;fahrenheit&#34;, &#34;kelvin&#34;,
 					  &#34;celsius&#34;) ➌ 					  
➍

class TemperatureConverter: ➎
 	pass # 暂时不做任何事 ➏
def convert_to_celsius(degrees, source=&#34;fahrenheit&#34;): ➐
 	&#34;&#34;&#34;这个函数将华氏度或开氏度转化为摄氏度 ➑
 	&#34;&#34;&#34;
 	if source.lower() == &#34;fahrenheit&#34;: ➒
 		return (degrees-32) * (5/9) ➓
 	elif source.lower() == &#34;kelvin&#34;:
 		return degrees - 273.15
 	else:
 		return f&#34;Don&#39;t know how to convert from {source}&#34;
 		
celsius = convert_to_celsius(44, source=&#34;fahrenheit&#34;)	11
non_celsius_scales = TEMPERATURE_SCALES[:-1]	12

print(&#34;Current time: &#34; + dt.datetime.now().isoformat())
print(f&#34;The temperature in Celsius is: {celsius}&#34;)
</code></pre><p>➊ 在文件顶部用<strong>文档字符串</strong>（docstring）解释这个脚本或者模块做了些什么。文档字符串是一种特殊的字符串，它用 <strong>3 个引号</strong>引用。除了作为代码的文档，它还可以用来编写<strong>跨越多行</strong>的字符串。如果你的字符串中有很多双引号或单引号，那么也可以用文档字符串来避免转义。</p>
<p>➋ 所有的导入语句都应该放在文件顶部，一行一个导入。从标准库导入的内容放在前面，然后是第三方包，最后是自己编写的模块。</p>
<p>➌ 用<strong>大写字母和下划线表示常量</strong>。每行的长度不超过 79 个字符。尽可能地利用<strong>圆括号、方括号或花括号隐式跨行</strong>。</p>
<p>➍ 类、函数和其他代码之间用<strong>两个空行</strong>隔开。</p>
<p>➎ 尽管很多类像 datetime 一样使用小写字母命名，但是你自己编写的类也应该使用<strong>首字母大写</strong>的名称（CapitalizedWords）。有关类的更多内容请参见附录 C。</p>
<p>➏ <strong>行内注释</strong>应该和代码间隔<strong>至少两个空格</strong>。代码块应该用 4 个空格缩进。</p>
<p>➐ 在能够<strong>提高可读性</strong>的情况下，<strong>函数和参数</strong>应该使用<strong>小写字母和下划线</strong>命名。不要在参数名和默认值之间使用空格。</p>
<p>➑ 函数的文档字符串应当列出<strong>函数参数并解释其意义</strong>。</p>
<p>➒ 冒号前后不要使用空格。</p>
<p>➓ 可以在算术运算符前后使用空格。如果同时使用了优先级不同的运算符，则应当考虑在优先级最低的运算符前后添加空格。在本例中，由于乘号的优先级最低，因此它的前后被添加了空格。</p>
<p>11：变量名称使用小写字母。在可以提升可读性的前提下使用下划线。为变量赋值时，在等号前后添加空格。不过在调用函数时，不要在关键字参数前后使用空格。</p>
<p>12：在进行索引和切片时，不要在方括号前后使用空格。</p>

<h4 class="relative group">3.6.1 PEP 8 和 VS Code 
    <div id="361-pep-8-和-vs-code" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#361-pep-8-%e5%92%8c-vs-code" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>在使用 VS Code 时，确保代码严格遵循 PEP 8 的最简单方法是使用<strong>代码检查器</strong>（linter）。代码检查器会检查源代码中的语法和风格错误。<a
  href="https://worktile.com/kb/ask/561905.html"
    target="_blank"
  >vscode怎么检查代码 • Worktile社区</a></p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250807175520647" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250807175520647.png">

  
</figure>
</p>

<h4 class="relative group">3.6.2 类型提示 
    <div id="362-类型提示" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#362-%e7%b1%bb%e5%9e%8b%e6%8f%90%e7%a4%ba" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>Python 3.5 引入了一个叫作类型提示（type hint）的特性。类型提示也被称为<strong>类型标注</strong>（type annotation），它允许你<strong>声明变量的数据类型</strong>。类型提示并不是强制性的，它也不会影响 Python 解释器执行代码。其主要目的是让 VS Code 之类的文本编辑器可以在代码执行前捕获更多错误，不过它也可以<strong>增强</strong>编辑器的<strong>自动补全功能</strong>。</p>
<p>mypy 是用于有类型标注的 Python 代码的最受欢迎的类型检查器，是 VS Code 提供的一种代码检查器。要理解类型标注如何工作，先来看下面这段没有类型提示的代码：</p>
<pre tabindex="0"><code>x = 1 
def hello(name):
 	return f&#34;Hello {name}!&#34;
</code></pre><p>现在加上类型提示：</p>
<pre tabindex="0"><code>x: int = 1 
def hello(name: str) -&gt; str:
 	return f&#34;Hello {name}!&#34;
</code></pre><p>一般来说，类型提示在较大的项目中才会更有用。</p>
<hr>

<h1 class="relative group">第二部分 pandas 入门 
    <div id="第二部分-pandas-入门" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e7%ac%ac%e4%ba%8c%e9%83%a8%e5%88%86-pandas-%e5%85%a5%e9%97%a8" aria-label="锚点">#</a>
    </span>        
    
</h1>

<h2 class="relative group">第四章 NumPy 基础 
    <div id="第四章-numpy-基础" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e7%ac%ac%e5%9b%9b%e7%ab%a0-numpy-%e5%9f%ba%e7%a1%80" aria-label="锚点">#</a>
    </span>        
    
</h2>
<p>NumPy 是 Python 科学计算的<strong>关键包</strong>，为<strong>数组运算</strong>和<strong>线性代数运算</strong>提供了支持。因为 pandas 是在 NumPy 之上建立起来的，所以本章会先介绍 NumPy 的基础知识。在解释了什么是 NumPy 数组之后，我们会学习<strong>向量化</strong>和<strong>广播</strong>这两个重要概念。利用向量化和广播，我们可以写出简洁的数学运算代码，并且它们在 pandas 中也有广泛运用。之后，介绍为什么 NumPy 会提供叫作“<strong>全局函数</strong>”的特殊函数。最后，通过解释 NumPy <strong>视图和副本</strong>之间的区别，学习如何存取 NumPy 数组的值。</p>

<h3 class="relative group">4.1 NumPy入门 
    <div id="41-numpy入门" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#41-numpy%e5%85%a5%e9%97%a8" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>介绍<strong>一维</strong>和<strong>二维</strong>的 NumPy 数组，以及向量化、广播和通用函数的<strong>背景知识</strong>。</p>

<h4 class="relative group">4.1.1 NumPy数组 
    <div id="411-numpy数组" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#411-numpy%e6%95%b0%e7%bb%84" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>对嵌套列表进行数组运算，可以使用循环来完成。要为嵌套列表中的每一个元素都加上 1，可以使用下面的嵌套列表推导式：</p>
<pre tabindex="0"><code>In [1]: matrix = [[1, 2, 3],
 				  [4, 5, 6],
				  [7, 8, 9]]
In [2]: [[i + 1 for i in row] for row in matrix]
Out[2]: [[2, 3, 4], [5, 6, 7], [8, 9, 10]]
</code></pre><p>但是这样的代码<strong>可读性很低</strong>。更关键的是，在面对更大的数组时，遍历整个数组会非常<strong>慢</strong>。如果你的用例和数组大小合适的话，那么使用 NumPy 数组进行运算会比 Python 列表快上几百倍。为了达到如此高的性能，NumPy 利用了用 C 和 Fortran（它们都是编译型语言，比 Python 要快得多）编写的代码。NumPy 数组是保存<strong>同构数据</strong>（homogenous data）的 <strong><em>N</em> 维数组</strong>。“同构”意味着数组中的所有数据都必须是<strong>相同类型</strong>。最常见的情况就是处理一维和二维的浮点数数组。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250808095949563" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250808095949563.png">

  
</figure>
</p>
<p>下面来创建一个一维数组和一个二维数组：</p>
<pre tabindex="0"><code>In [3]: # 首先导入NumPy
 		import numpy as np
In [4]: # 使用列表构造一个一维数组
 		array1 = np.array([10, 100, 1000.])
In [5]: # 使用嵌套列表构造一个二维数组
 		array2 = np.array([[1., 2., 3.],
 						   [4., 5., 6.]])
</code></pre><p><strong>数组维度</strong>：要注意一维数组和二维数组之间的区别。一维数组只有一个轴，因此不区分行数组和列数组。</p>
<p>即使 array1 除了最后一个元素（浮点数）之外全是整数，但由于 NumPy 对同构的要求，这个数组的<strong>数据类型</strong>依然是 <strong>float64</strong>，这个类型足以容纳所有的元素。要想了解一个数组的数据类型，可以访问它的 dtype 属性：</p>
<pre tabindex="0"><code>In [6]: array1.dtype
Out[6]: dtype(&#39;float64&#39;)
</code></pre><p>如果需要显式地将 NumPy 数据类型转换成 Python 的基本数据类型，只需使用对应的构造器即可：</p>
<pre tabindex="0"><code>In [7]: float(array1[0])
Out[7]: 10.0
</code></pre>
<h4 class="relative group">4.1.2 向量化和广播 
    <div id="412-向量化和广播" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#412-%e5%90%91%e9%87%8f%e5%8c%96%e5%92%8c%e5%b9%bf%e6%92%ad" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>如果你对一个标量和 NumPy 数组求和，那么 NumPy 会执行按元素的操作。也就是说，你不用亲自遍历每一个元素。NumPy 社区称之为<strong>向量化</strong>（vectorization）。向量化可以让代码更简洁，更接近于数学记法。</p>
<pre tabindex="0"><code>In [8]: array2 + 1
Out[8]: array([[2., 3., 4.],
 			   [5., 6., 7.]])
</code></pre><p><strong>标量</strong>：标量（scalar）指的是某种 Python <strong>基本数据类型</strong>，比如<strong>浮点型</strong>和<strong>字符串</strong>。这是为了将其和列表及字典一类的多元素数据结构，以及一维和二维的 NumPy 数组区分开来。</p>
<p>在处理两个数组时也是同样的道理，NumPy 会执行<strong>按元素</strong>的运算：</p>
<pre tabindex="0"><code>In [9]: array2 * array2
Out[9]: array([[ 1., 4., 9.],
			   [16., 25., 36.]])
</code></pre><p>如果你在算术运算中使用了两个<strong>形状不同</strong>的数组，那么 NumPy 在可能的情况下会<strong>自动将较小的数组扩展成较大的数组的形状</strong>。这就是<strong>广播</strong>（broadcasting）：</p>
<pre tabindex="0"><code>In [10]: array2 * array1
Out[10]: array([[ 10., 200., 3000.],
			    [ 40., 500., 6000.]])
</code></pre><p>要求<strong>矩阵的点积</strong>，需要使用 @ 运算符：</p>
<pre tabindex="0"><code>In [11]: array2 @ array2.T # array2.T是array2.transpose()的缩写形式
Out[11]: array([[14., 32.], 
 				[32., 77.]])
</code></pre><p><strong>拓展</strong>：矩阵的点积，也称为<strong>内积</strong>或<strong>标量积</strong>，在数学中是一种重要的矩阵运算。它涉及两个矩阵中对应元素的<strong>乘积和随后的求和</strong>，结果是一个<strong>单一的标量值</strong>。对于两个向量 <strong>a</strong> 和 <strong>b</strong>，它们的点积是这样计算的：<strong>a</strong> ⋅ <strong>b</strong> = a1b1 + a2b2 + &hellip; + anbn，其中 a1, a2, &hellip;, an 和 b1, b2, &hellip;, bn 是向量 <strong>a</strong> 和 <strong>b</strong> 的对应元素。如果将这个概念扩展到矩阵，矩阵的点积就是<strong>两个矩阵对应元素乘积的总和</strong>。</p>

<h4 class="relative group">4.1.3 通用函数 
    <div id="413-通用函数" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#413-%e9%80%9a%e7%94%a8%e5%87%bd%e6%95%b0" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>通用函数（universal function，简称 ufunc）会对 NumPy 数组中的每个元素执行操作。如果在 NumPy 数组中使用 Python <strong>标准库 math 模块</strong>中的开平方函数，那么你会得到一个错误：</p>
<pre tabindex="0"><code>In [12]: import math
In [13]: math.sqrt(array2) # 这里会发生错误
---------------------------------------------------------------------------
TypeError Traceback (most recent call last)
&lt;ipython-input-13-5c37e8f41094&gt; in &lt;module&gt;
----&gt; 1 math.sqrt(array2) # 这里会发生错误

TypeError: only size-1 arrays can be converted to Python scalars
</code></pre><p>可以写一个嵌套循环来计算每个元素的平方根，然后再把结果构造成一个 NumPy 数组：</p>
<pre tabindex="0"><code>In [14]: np.array([[math.sqrt(i) for i in row] for row in array2])
Out[14]: array([[1. , 1.41421356, 1.73205081],
 			    [2. , 2.23606798, 2.44948974]])
</code></pre><p>NumPy 有这样一个 ufunc，直接用它，除了更容易输入和阅读，在处理大型数组时 ufunc 会快得多：</p>
<pre tabindex="0"><code>In [15]: np.sqrt(array2)
Out[15]: array([[1. , 1.41421356, 1.73205081],
 				[2. , 2.23606798, 2.44948974]])
</code></pre><p>NumPy 的一些 ufunc 也可以用作数组的方法。以 sum 为例，如果你想求出每一列的总和，那么可以像下面这样做：</p>
<pre tabindex="0"><code>In [16]: array2.sum(axis=0) # 返回一维数组
Out[16]: array([5., 7., 9.])
</code></pre><p>参数 <strong>axis=0</strong> 表示<strong>以行为轴</strong>，参数 <strong>axis=1</strong> 表示<strong>以列为轴</strong>。省略 axis 参数会将整个数组加起来：</p>
<pre tabindex="0"><code>In [17]: array2.sum()
Out[17]: 21.0
</code></pre>
<h3 class="relative group">4.2 创建和操作数组 
    <div id="42-创建和操作数组" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#42-%e5%88%9b%e5%bb%ba%e5%92%8c%e6%93%8d%e4%bd%9c%e6%95%b0%e7%bb%84" aria-label="锚点">#</a>
    </span>        
    
</h3>

<h4 class="relative group">4.2.1 存取元素 
    <div id="421-存取元素" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#421-%e5%ad%98%e5%8f%96%e5%85%83%e7%b4%a0" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>在处理本章开头例子中的 matrix 这类嵌套列表时，可以使用链式索引（chained indexing）：matrix[0] [0]会得到第一行的第一个元素。不过在 NumPy 数组中，你要在一对方括号中同时提供两个维度的索引和切片参数：</p>
<pre tabindex="0"><code>numpy_array[row_selection, column_selection]
</code></pre><p>对于一维数组，上述代码简化成了 numpy_array[selection]。在选取单个元素时，你会得到一个标量，否则得到的就是一维或二维的数组。对二维数组的行或列进行切片，得到的是一个一维数组，而不是二维列向量或行向量。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250808174720415" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250808174720415.png">

  
</figure>
</p>
<pre tabindex="0"><code>In [18]: array1[2] # 返回标量
Out[18]: 1000.0
In [19]: array2[0, 0] # 返回标量
Out[19]: 1.0
In [20]: array2[:, 1:] # 返回二维数组
Out[20]: array([[2., 3.],
 				[5., 6.]])
In [21]: array2[:, 1] # 返回一维数组
Out[21]: array([2., 5.])
In [22]: array2[1, :2] # 返回一维数组
Out[22]: array([4., 5.])
</code></pre>
<h4 class="relative group">4.2.2 方便的数组构造器 
    <div id="422-方便的数组构造器" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#422-%e6%96%b9%e4%be%bf%e7%9a%84%e6%95%b0%e7%bb%84%e6%9e%84%e9%80%a0%e5%99%a8" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>通过 arange 和 reshape，可以快速生成指定维度的数组：</p>
<pre tabindex="0"><code>In [23]: np.arange(2 * 5).reshape(2, 5) # 2行，5列
Out[23]: array([[0, 1, 2, 3, 4],
 				[5, 6, 7, 8, 9]])
</code></pre><p>以蒙特卡罗模拟为例，一个常见需求是生成服从<strong>正态分布</strong>的伪随机数数组。NumPy 可以轻松做到：</p>
<pre tabindex="0"><code>In [24]: np.random.randn(2, 3) # 2行，3列
Out[24]: array([[-0.30047275, -1.19614685, -0.13652283],
 				[ 1.05769357, 0.03347978, -1.2153504 ]])
</code></pre><p>还有一些方便的构造器值得去发掘，比如 <strong>np.ones</strong> 和 <strong>np.zeros</strong>，它们分别可以创建全是 <strong>1</strong> 和 <strong>0</strong> 的数组。<strong>np.eye</strong> 可以创建<strong>单位矩阵</strong>。</p>

<h4 class="relative group">4.2.3 视图和副本 
    <div id="423-视图和副本" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#423-%e8%a7%86%e5%9b%be%e5%92%8c%e5%89%af%e6%9c%ac" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>在对 NumPy <strong>数组切片</strong>时，其<strong>返回值</strong>是<strong>视图</strong>（view）。这就意味着你是在<strong>操作</strong>原数组的一个子集，而<strong>没有发生数据的复制</strong>。因而<strong>设置视图的值也会改变原数组中的值</strong>：</p>
<pre tabindex="0"><code>In [25]: array2
Out[25]: array([[1., 2., 3.],
 				[4., 5., 6.]])
In [26]: subset = array2[:, :2]
 		 subset
Out[26]: array([[1., 2.],
 				[4., 5.]])
In [27]: subset[0, 0] = 1000
In [28]: subset
Out[28]: array([[1000., 2.],
 				[ 4., 5.]]) 
In [29]: array2
Out[29]: array([[1000., 2., 3.],
 				[ 4., 5., 6.]])
</code></pre><p>如果不想要这样的结果，那么可以把 In [26] 的代码改成下面这样：</p>
<pre tabindex="0"><code>subset = array2[:, :2].copy()
</code></pre><p>对副本进行操作不会影响原数组。</p>

<h2 class="relative group">第五章 使用 <strong>pandas</strong> 进行数据分析 
    <div id="第五章-使用-pandas-进行数据分析" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e7%ac%ac%e4%ba%94%e7%ab%a0-%e4%bd%bf%e7%94%a8-pandas-%e8%bf%9b%e8%a1%8c%e6%95%b0%e6%8d%ae%e5%88%86%e6%9e%90" aria-label="锚点">#</a>
    </span>        
    
</h2>
<p>pandas，即 <strong>Python 数据分析库</strong>（Python data analysis library），pandas 最主要的超能力就是<strong>向量化</strong>和<strong>数据对齐</strong>。首先会介绍如何<strong>清理和准备数据</strong>，然后你会了解到如何通过<strong>聚合、描述性统计量和可视化</strong>让大型数据集更易于理解。本章在结尾部分会介绍如何用 pandas <strong>导入和导出数据</strong>。不过首先，先来了解一下 pandas <strong>最主要的数据结构</strong>：<strong>DataFrame</strong> 和 <strong>Series</strong>。</p>

<h3 class="relative group">5.1 DataFrame 和 Series 
    <div id="51-dataframe-和-series" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#51-dataframe-%e5%92%8c-series" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>DataFrame（<strong>数据帧</strong>）和 Series（<strong>序列</strong>）是 pandas 的<strong>核心数据结构</strong>。本节会对 DataFrame 的主要组件——<strong>索引、列和数据</strong>逐一介绍。DataFrame 和<strong>二维的 NumPy 数组类似</strong>，但是它的行和列有对应的<strong>标签</strong>，并且每一列都可以<strong>存储不同类型的数据</strong>。从 DataFrame 中<strong>提取一行或一列时</strong>，你会得到一个<strong>一维的 Series</strong>。类似地，Series 相当于<strong>带标签的一维 NumPy数组</strong>。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250808182319041" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250808182319041.png">

  
</figure>
</p>
<p>从工作表到 DataFrame 的过渡非常简单，下图的 Excel 表格中展示了网课学员的基本信息及其分数。你可以在配套代码库的 xl 文件夹中找到对应的 course_participants.xlsx 文件。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250808182827930" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250808182827930.png">

  
</figure>
</p>
<p>为了能在 Python 中使用这个 Excel 表格，首先要<strong>导入 pandas</strong>，然后使用 <strong>read_excel 函数</strong>通过 Excel 文件<strong>构造</strong>一个 <strong>DataFrame</strong>。</p>
<pre tabindex="0"><code>In [1]: import pandas as pd
In [2]: pd.read_excel(&#34;xl/course_participants.xlsx&#34;)
Out[2]: user_id name age country score continent
 	  0 1001    Mark  55   Italy   4.5   Europe
 	  1 1000    John  33   USA     6.7   America
 	  2 1002    Tim   41   USA     3.9   America
 	  3 1003    Jenny 12  Germany  9.0   Europe
</code></pre><p>在 Python 3.9 中使用 read_excel 函数如果你在 Python 3.9 或者更高版本中使用 pd.read_excel 函数，那么一定要确保 <strong>pandas 版本在 1.2 以上</strong>，否则会在读取 xlsx 文件时发生错误。</p>
<p><a
  href="https://geek-docs.com/python/python-ask-answer/346_hk_1709853930.html"
    target="_blank"
  >https://geek-docs.com/python/python-ask-answer/346_hk_1709853930.html</a></p>
<p>通过Python代码查看Pandas版本：</p>
<pre tabindex="0"><code>import pandas as pd

print(pd.__version__)
</code></pre><p>这里的<strong>报错处理如下</strong>：修改已经弃用的 np.float 为 float。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250809005347152" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250809005347152.png">

  
</figure>
</p>
<p>创建 DataFrame 的方法之一是利用<strong>嵌套列表</strong>来提供数据，除了数据本身，还需要<strong>提供 columns 参数和 index 参数</strong>：</p>
<pre tabindex="0"><code>In [3]: data=[[&#34;Mark&#34;, 55, &#34;Italy&#34;, 4.5, &#34;Europe&#34;],
 			  [&#34;John&#34;, 33, &#34;USA&#34;, 6.7, &#34;America&#34;],
			  [&#34;Tim&#34;, 41, &#34;USA&#34;, 3.9, &#34;America&#34;],
			  [&#34;Jenny&#34;, 12, &#34;Germany&#34;, 9.0, &#34;Europe&#34;]]
	    df = pd.DataFrame(data=data,
	   					  columns=[&#34;name&#34;, &#34;age&#34;, &#34;country&#34;,
						  		   &#34;score&#34;, &#34;continent&#34;],
						  index=[1001, 1000, 1002, 1003])
	    df 
Out[3]:			name	age	country	score	continent
        1001	Mark	55	Italy	4.5		Europe
        1000	John	33	USA		6.7		America
        1002	Tim		41	USA		3.9		America
        1003	Jenny	12	Germany	9.0		Europe
</code></pre><p>调用 <strong>info 方法</strong>可以获得 DataFrame 的一些<strong>基本信息</strong>，其中最重要的是<strong>数据点数量</strong>和<strong>每一列的数据类型</strong>：</p>
<pre tabindex="0"><code>In [4]: df.info()
</code></pre><pre tabindex="0"><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 4 entries, 1001 to 1003
Data columns (total 5 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   name       4 non-null      object 
 1   age        4 non-null      int64  
 2   country    4 non-null      object 
 3   score      4 non-null      float64
 4   continent  4 non-null      object 
dtypes: float64(1), int64(1), object(3)
memory usage: 192.0+ bytes
</code></pre><p>如果只对列的数据类型感兴趣，那么可以执行 df.dtypes。如果列含有字符串或者混合了不同数据类型，那么它的数据类型就是 object。</p>

<h4 class="relative group">5.1.1 索引 
    <div id="511-索引" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#511-%e7%b4%a2%e5%bc%95" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>DataFrame 的<strong>行标签被称为索引</strong>（index）。如果你找不到一个有意义的索引，那么在构造 DataFrame 时可以直接省略，pandas 会自动创建一个从 0 开始的整数索引。</p>
<p>获取索引对象：</p>
<pre tabindex="0"><code>In [5]: df.index
Out[5]: Int64Index([1001, 1000, 1002, 1003], dtype=&#39;int64&#39;)
</code></pre><p>可以的话，应该<strong>给索引取一个名字</strong>。根据 Excel 表格对应的列名，我们给索引取名为 user_id：</p>
<pre tabindex="0"><code>In [6]: df.index.name = &#34;user_id&#34;
	    df
Out[6]: 		  name age country score continent
     	user_id
     	1001 	  Mark 	55 Italy 	4.5   Europe
     	1000      John 	33 USA 		6.7   America
     	1002 	  Tim  	41 USA 		3.9   America
     	1003 	  Jenny 12 Germany 	9.0   Europe
</code></pre><p>和数据库中的主键不同，DataFrame 的<strong>索引可以重复</strong>，但是这种情况下查询速度可能会变慢。要将索引<strong>还原成普通的列</strong>，可以使用 <strong>reset_index</strong>，而 <strong>set_index</strong> 可以<strong>设置一个新的索引</strong>。如果在设置新索引时不想丢掉原本的索引，那么一定要先重置索引：</p>
<pre tabindex="0"><code>In [7]: # reset_index会将索引还原为普通列，同时用默认索引替换当前索引
 		# 最终结果就和刚从Excel文件中得到的DataFrame一样
 		df.reset_index()
Out[7]: 	user_id name 	age country score continent
         0  1001    Mark 	55 	Italy 	4.5 	Europe
         1  1000  	John 	33 	USA 	6.7 	America
         2  1002 	Tim  	41 	USA 	3.9 	America
         3  1003 	Jenny 	12 	Germany 9.0 	Europe
In [8]: # reset_index会将user_id还原成普通列
 		# set_index会将&#34;name&#34;列设置为索引
 		df.reset_index().set_index(&#34;name&#34;)
Out[8]: 	  user_id age country score continent
 		name
        Mark  1001 	  55   Italy   4.5   Europe
        John  1000    33   USA 	   6.7   America
        Tim   1002    41   USA     3.9   America
        Jenny 1003    12   Germany 9.0   Europe
</code></pre><p>df.reset_index().set_index(&ldquo;name&rdquo;) 这种形式的代码被称为链式方法调用（method chaining）：reset_index() 会返回一个 DataFrame，你可以直接在这个 DataFrame 上调用另一个方法而无须写出中间值。</p>
<p><strong>DataFrame 的方法返回的是副本</strong>：每当以 df.method_name() 的形式调用 DataFrame 的方法时，你都会得到一个应用了该方法的 DataFrame 副本，而原来的 DataFrame 没有任何变化。刚刚调用的 df.reset_index() 就是这样的。如果你想改变原来的 DataFrame，那么可以<strong>把返回值赋值给原来的变量</strong>：</p>
<pre tabindex="0"><code>df = df.reset_index()
</code></pre><p>用 <strong>reindex 方法</strong>更换索引：</p>
<pre tabindex="0"><code>In [9]: df.reindex([999, 1000, 1001, 1004]) 
Out[9]: 		name age country score continent
 		user_id
 		999 	NaN  NaN  NaN     NaN    NaN
 		1000 	John 33.0 USA     6.7    America
 		1001 	Mark 55.0 Italy   4.5    Europe
 		1004 	NaN  NaN  NaN     NaN    NaN
</code></pre><p>reindex 会接管所有能够匹配新索引的行，而无法匹配的索引会引入含有空值（NaN）的行。被忽略的索引所对应的行会被直接丢弃。最后，使用 <strong>sort_index</strong> 可以按索引进行排序：</p>
<pre tabindex="0"><code>In [10]: df.sort_index()
Out[10]: 		 name  age country score continent
         user_id
         1000 	 John  33   USA     6.7   America
         1001 	 Mark  55   Italy   4.5   Europe
         1002 	 Tim   41   USA     3.9   America
         1003 	 Jenny 12   Germany 9.0   Europe
</code></pre><p>如果你想按一列或多列进行排序，可以使用 <strong>sort_values</strong>：</p>
<pre tabindex="0"><code>In [11]: df.sort_values([&#34;continent&#34;, &#34;age&#34;]) 
Out[11]: 		 name 	age country score continent
         user_id
         1000 	 John 	33 	USA 	6.7 	America
         1002 	 Tim  	41 	USA 	3.9 	America
         1003 	 Jenny  12 	Germany 9.0 	Europe
         1001 	 Mark 	55 	Italy 	4.5 	Europe
</code></pre><p>如果只想按某一列进行排序，那么也可以用<strong>列名字符串</strong>作为参数：</p>
<pre tabindex="0"><code>df.sort_values(&#34;continent&#34;)
</code></pre>
<h4 class="relative group">5.1.2 列 
    <div id="512-列" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#512-%e5%88%97" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>执行如下代码可以获得 DataFrame 列的信息：</p>
<pre tabindex="0"><code>In [12]: df.columns
Out[12]: Index([&#39;name&#39;, &#39;age&#39;, &#39;country&#39;, &#39;score&#39;, &#39;continent&#39;], 					       dtype=&#39;object&#39;)
</code></pre><p>如果在构造 DataFrame 时没有提供列名，那么 pandas 会用从 0 开始的数字为列编号。不过在处理列的时候这并不是一个好主意，列代表着各种变量，要取个名字并非难事。为列命名与命名索引类似：</p>
<pre tabindex="0"><code>In [13]: df.columns.name = &#34;properties&#34;
 		 df
Out[13]: properties name 	age country score continent
         user_id
         1001 		Mark 	55 	Italy 	4.5 	Europe
         1000 		John 	33 	USA 	6.7 	America
         1002 		Tim  	41 	USA 	3.9 	America
         1003 		Jenny 	12 	Germany 9.0 	Europe
</code></pre><p>如果不喜欢某些列的列名，可以进行重命名：</p>
<pre tabindex="0"><code>In [14]: df.rename(columns={&#34;name&#34;: &#34;First Name&#34;, &#34;age&#34;: &#34;Age&#34;})
Out[14]: properties First Name Age country score continent
         user_id
         1001 			Mark 	55 	Italy 	4.5 	Europe
         1000 			John 	33 	USA 	6.7 	America
         1002 			Tim 	41 	USA 	3.9 	America
         1003 			Jenny 	12 	Germany 9.0 	Europe
</code></pre><p>如果想删除某些列，可以使用如下语法（这个例子还体现了如何在删除列的同时删除索引）：</p>
<pre tabindex="0"><code>In [15]: df.drop(columns=[&#34;name&#34;, &#34;country&#34;], index=[1000, 1003])
Out[15]: properties age score continent
 		 user_id
         1001 		55 	 4.5 	Europe 
         1002 		41 	 3.9 	America
</code></pre><p>DataFrame 的列和索引都是由 Index 对象表示的，通过<strong>转置</strong>（transpose）DataFrame 可以将行和列对调：</p>
<pre tabindex="0"><code>In [16]: df.T # df.transpose()的简写
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250809104653638" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250809104653638.png">

  
</figure>
</p>
<p>要记住的是，我们的 DataFrame df 仍然<strong>原封不动</strong>，因为并没有将方法返回的 DataFrame 赋值给原来的 df 变量。如果需要更改 DataFrame 列的顺序，那么也可以使用用在索引上的 reindex 方法，不过<strong>直接给出所需要的列顺序</strong>通常会更直观：</p>
<pre tabindex="0"><code>In [17]: df.loc[:, [&#34;continent&#34;, &#34;country&#34;, &#34;name&#34;, &#34;age&#34;, &#34;score&#34;]]
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250809104932709" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250809104932709.png">

  
</figure>
</p>

<h3 class="relative group">5.2 数据操作 
    <div id="52-数据操作" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#52-%e6%95%b0%e6%8d%ae%e6%93%8d%e4%bd%9c" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>在使用数据之前，需要对其进行清理，使其更易于理解。如何从 DataFrame 中<strong>选取数据</strong>，如何<strong>修改数据</strong>，以及如何<strong>处理缺失和重复的数据</strong>。然后再对 DataFrame 进行一些运算，看看如何<strong>处理文本数据</strong>。</p>

<h4 class="relative group">5.2.1 选取数据 
    <div id="521-选取数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#521-%e9%80%89%e5%8f%96%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h4>

<h5 class="relative group">1. 使用标签选取数据 
    <div id="1-使用标签选取数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#1-%e4%bd%bf%e7%94%a8%e6%a0%87%e7%ad%be%e9%80%89%e5%8f%96%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>访问 DataFrame 数据的最常见方式是用它的标签来引用数据。使用 <strong>loc</strong> 属性（代表 location，位置）指定你想获取的行和列：</p>
<pre tabindex="0"><code>df.loc[row_selection, column_selection]
</code></pre><p>loc 支持切片语法，因此可以<strong>用冒号来选取所有的行或者列</strong>。你既可以提供保存标签的列表作为参数，也可以只提供单个行或者列的名称作为参数。</p>
<p>从 df 这个 DataFrame 中选取部分数据的方法：</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250809174419314" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250809174419314.png">

  
</figure>
</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250809174541499" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250809174541499.png">

  
</figure>
</p>
<p><strong>标签切片是闭区间</strong>：和 Python 内置的切片语法以及 pandas 的其他地方不同，在使用标签切片时，标签的区间<strong>包含区间首尾</strong>的两个标签。</p>
<pre tabindex="0"><code>In [18]: # 行和列都使用标量来选择，返回值也是标量
 		 df.loc[1001, &#34;name&#34;]
In [19]: # 只用标量选择行或列，返回值是Series
 		 df.loc[[1001, 1002], &#34;age&#34;]
In [20]: # 选取多行或多列，返回值是DataFrame
 		 df.loc[:1002, [&#34;name&#34;, &#34;country&#34;]]
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250809175213983" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250809175213983.png">

  
</figure>
</p>
<p>DataFrame（无论是一列还是多列）与 Series 之间是有<strong>区别</strong>的，理解这一点至关重要。即使只包含一列，DataFrame 也是二维的数据结构，而 Series 永远是一维的。DataFrame 和 Series 都有索引，但<strong>只有 DataFrame 有列标题</strong>。当你<strong>选取一列生成 Series</strong> 时，<strong>列标题就变成了 Series 的名称</strong>。</p>
<p><strong>列选择的捷径</strong>: 列的选取是十分常见的操作，pandas 为其提供了更简单的写法。除了这样写：</p>
<pre tabindex="0"><code>df.loc[:, column_selection]
</code></pre><p>也可以这样写：</p>
<pre tabindex="0"><code>df[column_selection]
</code></pre><p>例 如，df[&ldquo;country&rdquo;] 会从我们的示例 DataFrame 中返回一个 Series， 而df[[&ldquo;name&rdquo;, &ldquo;country&rdquo;]] 会返回一个包含两列的 DataFrame。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250809175952293" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250809175952293.png">

  
</figure>
</p>

<h5 class="relative group">2. 通过位置选取数据 
    <div id="2-通过位置选取数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#2-%e9%80%9a%e8%bf%87%e4%bd%8d%e7%bd%ae%e9%80%89%e5%8f%96%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>通过位置选取 DataFrame 的子集类似于本章开头在 NumPy 数组上进行的操作。不过对于DataFrame 来说，需要使用 <strong>iloc 属性</strong>，它的意思是<strong>整数位置</strong>（integer location）：</p>
<pre tabindex="0"><code>df.iloc[row_selection, column_selection]
</code></pre><p>在使用切片时，iloc 使用的是<strong>标准的半开半闭区间</strong>。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250809180423684" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250809180423684.png">

  
</figure>
</p>
<pre tabindex="0"><code>In [21]: df.iloc[0, 0] # 返回标量

In [22]: df.iloc[[0, 2], 1] # 返回Series

In [23]: df.iloc[:3, [0, 2]] # 返回DataFrame
</code></pre>
<h5 class="relative group">3. 使用布尔索引选取数据 
    <div id="3-使用布尔索引选取数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#3-%e4%bd%bf%e7%94%a8%e5%b8%83%e5%b0%94%e7%b4%a2%e5%bc%95%e9%80%89%e5%8f%96%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>布尔索引（boolean indexing）是借助只包含 True 或 False 的 Series 或 DataFrame 来<strong>选取</strong>一个 DataFrame 的<strong>子集</strong>。布尔 Series 可以用来选取 DataFrame 的特定列和行，布尔 DataFrame 则用来选取整个 DataFrame 中的某些值。布尔索引最<strong>常见的用例</strong>是用来<strong>筛选 DataFrame 的行</strong>。</p>
<pre tabindex="0"><code>In [24]: tf = (df[&#34;age&#34;] &gt; 40) &amp; (df[&#34;country&#34;] == &#34;USA&#34;)
 		 tf # 这个Series中只有True和False
 		 
In [25]: df.loc[tf, :]
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250809182705248" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250809182705248.png">

  
</figure>
</p>
<p>第一，由于技术上的限制，你无法在 DataFrame 中使用第 3 章讲到的 Python 布尔运算符。需要使用表 5-3 中的这些符号。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250809182848564" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250809182848564.png">

  
</figure>
</p>
<p>第二，如果你的筛选条件不止一条，那么一定要在每条布尔表达式之间加上圆括号，这样可以防止<strong>运算符优先级</strong>造成的问题：例如，&amp; 运算符的优先级比 == 高。</p>
<p>对索引进行筛选，那么可以用 <strong>df.index</strong> 来引用索引对象：</p>
<pre tabindex="0"><code>In [26]: df.loc[df.index &gt; 1001, :]
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250809183053086" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250809183053086.png">

  
</figure>
</p>
<p>Python 的基本数据结构（如列表）可以使用 in 运算符判断是否包含某些对象，如果要在 <strong>Series</strong> 中进行类似的操作，就需要使用 <strong>isin 方法</strong>。可以像下面这样筛选出所有来自意大利和德国的学员：</p>
<pre tabindex="0"><code>In [27]: df.loc[df[&#34;country&#34;].isin([&#34;Italy&#34;, &#34;Germany&#34;]), :]
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250809183321102" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250809183321102.png">

  
</figure>
</p>
<p>DataFrame 还提供了一种特殊的语法，可以在不使用 loc 的情况下<strong>传递一整个布尔 DataFrame 作为参数</strong>：</p>
<pre tabindex="0"><code>df[boolean_df]
</code></pre><p>在 DataFrame <strong>只包含数字</strong>时这种语法特别有用。当提供这样一个布尔 DataFrame 作为参数时，返回的 DataFrame 会在原 DataFrame 的基础上，把对应着 False 的地方变成 NaN。下面先来创建一个新的示例 DataFrame，命名为 rainfall，它只包含数字：</p>
<pre tabindex="0"><code>In [28]: # 当作以毫米为单位的年降雨量
		 rainfall = pd.DataFrame(data={&#34;City 1&#34;: [300.1, 100.2],
									   &#34;City 2&#34;: [400.3, 300.4],
								 	   &#34;City 3&#34;: [1000.5, 1100.6]})
		rainfall
		
In [29]: rainfall &lt; 400

In [30]: rainfall[rainfall &lt; 400]
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250809184127460" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250809184127460.png">

  
</figure>
</p>
<p>要注意在这个例子中，我使用了<strong>字典</strong>来<strong>构造</strong>一个新的 DataFrame。如果数据本身就是这种形式的话，这是很方便的。布尔值的这种用法经常被用来排除某些值，比如异常值。</p>

<h5 class="relative group">4. 使用 MultiIndex 选取数据 
    <div id="4-使用-multiindex-选取数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#4-%e4%bd%bf%e7%94%a8-multiindex-%e9%80%89%e5%8f%96%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>MultiIndex 是一种多级索引。它可以将数据按层次分组，这样你就可以更方便地访问 DataFrame 的子集。如果将 continent 和 country 一起设置为 df 这个 DataFrame 的索引，那么你就可以轻松地通过某个大洲的名称来选取对应的所有行：</p>
<pre tabindex="0"><code>In [31]: # 待排序的MultiIndex
 		 df_multi = df.reset_index().set_index([&#34;continent&#34;, &#34;country&#34;])
		 df_multi = df_multi.sort_index()
		 df_multi
		 
In [32]: df_multi.loc[&#34;Europe&#34;, :]
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810011415459" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810011415459.png">

  
</figure>
</p>
<p>通过多级索引选取数据需要提供一个元组作为参数：</p>
<pre tabindex="0"><code>In [33]: df_multi.loc[(&#34;Europe&#34;, &#34;Italy&#34;), :]
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810011552850" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810011552850.png">

  
</figure>
</p>
<p>想选择性地重置一部分 MultiIndex，那么可以为 reset_index 提供索引级别参数。索引级别从左至右从 0 开始：</p>
<pre tabindex="0"><code>In [34]: df_multi.reset_index(level=0)
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810011712170" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810011712170.png">

  
</figure>
</p>

<h4 class="relative group">5.2.2 设置数据 
    <div id="522-设置数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#522-%e8%ae%be%e7%bd%ae%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>修改 DataFrame 数据的最简单的方法是通过 <strong>loc</strong> 和 <strong>iloc 属性</strong>为某些元素赋值。</p>

<h5 class="relative group">1. 通过标签或位置设置值 
    <div id="1-通过标签或位置设置值" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#1-%e9%80%9a%e8%bf%87%e6%a0%87%e7%ad%be%e6%88%96%e4%bd%8d%e7%bd%ae%e8%ae%be%e7%bd%ae%e5%80%bc" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>当你以 df.reset_index() 的形式调用 DataFrame 的方法时，方法总是会被应用到一个副本上，而原本的 DataFrame 是原封不动的。然而通过 <strong>loc 属性</strong>和 <strong>iloc 属性</strong>赋值时，原本的 DataFrame 是会被修改的。由于不想修改 df 这个 DataFrame，因此在这里我创建了一个名为 df2 的<strong>副本</strong>。如果你想修改某一个值，那么可以像下面这样做：</p>
<pre tabindex="0"><code>In [35]: # 先复制DataFrame，保持原本的DataFrame不变
		 df2 = df.copy()
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810094835126" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810094835126.png">

  
</figure>
</p>
<p>下面是同时修改 ID 为 1000 和 1001 的两名用户分数的一种方法，这里使用了一个<strong>列表作为参数</strong>：</p>
<pre tabindex="0"><code>In [37]: df2.loc[[1000, 1001], &#34;score&#34;] = [3, 4]
		 df2
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810095116488" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810095116488.png">

  
</figure>
</p>

<h5 class="relative group">2. 通过布尔索引设置数据 
    <div id="2-通过布尔索引设置数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#2-%e9%80%9a%e8%bf%87%e5%b8%83%e5%b0%94%e7%b4%a2%e5%bc%95%e8%ae%be%e7%bd%ae%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>用来筛选行的布尔索引也可以用来为 DataFrame 赋值。假设你需要将所有来自美国或年龄在 20 岁以下的学员匿名：</p>
<pre tabindex="0"><code>In [38]: tf = (df2[&#34;age&#34;] &lt; 20) | (df2[&#34;country&#34;] == &#34;USA&#34;)
		 df2.loc[tf, &#34;name&#34;] = &#34;xxx&#34;
		 df2
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810095757382" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810095757382.png">

  
</figure>
</p>
<p>有时可能需要将整个数据集中的某个值完全替换，而不是只涉及特定的列。在这种情况下，可以再一次利用这种特殊语法，将一个布尔 DataFrame 作为参数（示例中再一次用到了 rainfall 这个 DataFrame）：</p>
<pre tabindex="0"><code>In [39]: # 先复制DataFrame，保持原本的DataFrame不变
		 rainfall2 = rainfall.copy()
		 rainfall2
		 
In [40]: # 将小于400的值用0替换
		 rainfall2[rainfall2 &lt; 400] = 0
		 rainfall2
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810100216542" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810100216542.png">

  
</figure>
</p>

<h5 class="relative group">3. 通过替换值设置数据 
    <div id="3-通过替换值设置数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#3-%e9%80%9a%e8%bf%87%e6%9b%bf%e6%8d%a2%e5%80%bc%e8%ae%be%e7%bd%ae%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>如果想将整个 DataFrame（或者指定列）中的某个值全部替换成另一个值，那么可以使用 <strong>replace</strong> 方法：</p>
<pre tabindex="0"><code>In [41]: df2.replace(&#34;USA&#34;, &#34;U.S.&#34;)
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810100644745" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810100644745.png">

  
</figure>
</p>
<p>如果只想在 country 列上进行操作，则可以用这种语法：</p>
<pre tabindex="0"><code>df2.replace({&#34;country&#34;: {&#34;USA&#34;: &#34;U.S.&#34;}})
</code></pre>
<h5 class="relative group">4. 通过添加新列设置数据 
    <div id="4-通过添加新列设置数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#4-%e9%80%9a%e8%bf%87%e6%b7%bb%e5%8a%a0%e6%96%b0%e5%88%97%e8%ae%be%e7%bd%ae%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>为一个新的列名赋值时会为 DataFrame 添加一个新列。例如，利用一个标量或者列表可以为 DataFrame 添加新列：</p>
<pre tabindex="0"><code>In [42]: df2.loc[:, &#34;discount&#34;] = 0
		 df2.loc[:, &#34;price&#34;] = [49.9, 49.9, 99.9, 99.9]
		 df2
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810174455027" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810174455027.png">

  
</figure>
</p>
<p>添加新列时经常涉及向量化运算：</p>
<pre tabindex="0"><code>In [43]: df2 = df.copy() # 从一个新的副本开始
		 df2.loc[:, &#34;birth year&#34;] = 2021 - df2[&#34;age&#34;]
		 df2
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810174910857" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810174910857.png">

  
</figure>
</p>

<h4 class="relative group">5.2.3 缺失数据 
    <div id="523-缺失数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#523-%e7%bc%ba%e5%a4%b1%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>数据的缺失可能会对数据分析的结果造成影响，数据集中有空白是很常见的情况，并且你还不得不对其进行处理。在 Excel 中，你通常必须用空白单元格或者 #N/A 错误进行处理，不过 pandas 使用 NumPy 的 np.nan 代表缺失数据，显示为 NaN。NaN 是浮点数标准中的 <strong>Not-a-Number</strong>（非数字）。对于<strong>时间戳</strong>，则是使用 <strong>pd.NaT</strong>，而<strong>文本</strong>使用的是 <strong>None</strong>。可以使用 None 或者 np.nan 来表示缺失的值：</p>
<pre tabindex="0"><code>In [44]: df2 = df.copy() # 从一个新的副本开始
         df2.loc[1000, &#34;score&#34;] = None
         df2.loc[1003, :] = None
         df2
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810200155923" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810200155923.png">

  
</figure>
</p>
<p>在清理 DataFrame 时，你可能想要移除所有包含缺失数据的行。就这么简单：</p>
<pre tabindex="0"><code>In [45]: df2.dropna()
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810200433186" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810200433186.png">

  
</figure>
</p>
<p>如果只想移除所有值都缺失了的行，那么可以使用 how 参数：</p>
<pre tabindex="0"><code>In [46]: df2.dropna(how=&#34;all&#34;)
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810200607709" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810200607709.png">

  
</figure>
</p>
<p>想获得一个反映对应位置上是否是 NaN 的布尔 DataFrame 或 Series，可以使用 <strong>isna</strong> 方法：</p>
<pre tabindex="0"><code>In [47]: df2.isna()
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810200820311" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810200820311.png">

  
</figure>
</p>
<p>使用 fillna 来填补缺失的值。例如，将数据点数量列中的 NaN 替换为平均分：</p>
<pre tabindex="0"><code>In [48]: df2.fillna({&#34;score&#34;: df2[&#34;score&#34;].mean()})
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810201120896" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810201120896.png">

  
</figure>
</p>

<h4 class="relative group">5.2.4 重复数据 
    <div id="524-重复数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#524-%e9%87%8d%e5%a4%8d%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>和缺失数据一样，重复数据也会对数据分析的可靠性造成负面影响。可以使用 <strong>drop_duplicates</strong> 方法来<strong>清理重复的行</strong>。也可以提供列的子集作为参数：</p>
<pre tabindex="0"><code>In [49]: df.drop_duplicates([&#34;country&#34;, &#34;continent&#34;])
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810201723093" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810201723093.png">

  
</figure>
</p>
<p>在默认情况下，<strong>第一次出现的数据会得以保留</strong>。<strong>is_unique</strong> 用于确认<strong>某一列是否包含重复数据</strong>，unique 则可以获得去重后的值。（如果想对索引进行此类操作，那么可以将 df[&ldquo;country&rdquo;] 换成 df.index。）</p>
<pre tabindex="0"><code>In [50]: df[&#34;country&#34;].is_unique

In [51]: df[&#34;country&#34;].unique()
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810202236059" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810202236059.png">

  
</figure>
</p>
<p>通过 <strong>duplicated 方法</strong>可以知道哪些行是<strong>重复</strong>的，它的返回值是一个<strong>布尔 Series</strong>。keep 参数的默认值是 &ldquo;first&rdquo;，意思是会保留第一次出现的数据，只将重复数据标记为 True。将 keep 设置为 False 时，所有的重复数据（包括第一次出现时）都会被标记为 True，这样就可以方便地得到一个包含所有重复行的 DataFrame。在下面的例子中，我们在找 country 列的重复数据，但在实际工作中，通常都是找重复的索引或者整行的重复数据。这个时候就要使用 df.index.duplicated() 或 df.duplicated()：</p>
<pre tabindex="0"><code>In [52]: # 在默认情况下，只有重复的行会被标记为True，
         # 即数据第一次出现时不会被标记为True
         df[&#34;country&#34;].duplicated()
         
In [53]: # 要找到所有&#34;country&#34;发生重复的行，
         # 可以将参数设置为keep=False
         df.loc[df[&#34;country&#34;].duplicated(keep=False), :]
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810202926848" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810202926848.png">

  
</figure>
</p>

<h4 class="relative group">5.2.5 算术运算 
    <div id="525-算术运算" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#525-%e7%ae%97%e6%9c%af%e8%bf%90%e7%ae%97" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>和 NumPy 数组一样，DataFrame 和 Series 也利用了<strong>向量化技术</strong>。例如，要为 rainfall 这个 DataFrame 中的每一个值加上一个数，只需像下面这样做：</p>
<pre tabindex="0"><code>In [54]: rainfall

In [55]: rainfall + 100
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810203227891" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810203227891.png">

  
</figure>
</p>
<p>不过 pandas 真正的强大之处是它的<strong>自动数据对齐</strong>（data alignment）机制：当你对多个DataFrame 使用算术运算符时，pandas 会<strong>自动将它们按照列或行索引对齐</strong>。下面再创建一个和 rainfall 有相同行列标签的 DataFrame。然后求两者之和：</p>
<pre tabindex="0"><code>In [56]: more_rainfall = pd.DataFrame(data=[[100, 200], [300, 400]],
                                      index=[1,2],
                                      columns=[&#34;City 1&#34;, &#34;City 4&#34;])
         more_rainfall
         
In [57]: rainfall + more_rainfall
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810203751450" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810203751450.png">

  
</figure>
</p>
<p>结果 DataFrame 的索引和列是两个 DataFrame 的<strong>并集</strong>：两个 DataFrame 中<strong>都有的字段会被相加</strong>，而其他的部分会显示为 NaN。要让 pandas 和 Excel 以同样的方式处理这个问题，可以使用 <strong>add 方法</strong>，并将 fill_value 参数设置为 0 以代替默认的 NaN：</p>
<pre tabindex="0"><code>In [58]: rainfall.add(more_rainfall, fill_value=0)
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810204146297" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810204146297.png">

  
</figure>
</p>
<p>当算式的操作数是一个 DataFrame 和一个 Series 时，默认情况下 Series 会按<strong>索引</strong>进行<strong>广播</strong>：</p>
<pre tabindex="0"><code>In [59]: # 用一行数据生成一个Series
		 rainfall.loc[1, :]
		 
In [60]: rainfall + rainfall.loc[1, :]
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810204618444" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810204618444.png">

  
</figure>
</p>
<p>如果要按列加上一个 Series，则需要在调用 add 方法时显式地提供 axis 参数：</p>
<pre tabindex="0"><code>In [61]: # 用一列数据生成一个Series
		 rainfall.loc[:, &#34;City 2&#34;]
		 
In [62]: rainfall.add(rainfall.loc[:, &#34;City 2&#34;], axis=0)
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250810205056384" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250810205056384.png">

  
</figure>
</p>

<h4 class="relative group">5.2.6 处理文本列 
    <div id="526-处理文本列" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#526-%e5%a4%84%e7%90%86%e6%96%87%e6%9c%ac%e5%88%97" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>含有<strong>文本数据的列</strong>和含有<strong>不同类型数据的列</strong>的数据类型是 <strong>object</strong>。要在含有文本字符串的列上执行相关操作，需要使用 <strong>str 属性</strong>。str 属性可以访问 Python 的字符串方法。要<strong>移除字符串首尾的空白</strong>，可以使用 <strong>strip 方法</strong>；要<strong>将首字母大写</strong>，可以使用 <strong>capitalize 方法</strong>。将这些方法组合起来之后，可以将人工输入的乱七八糟的数据清理干净：</p>
<pre tabindex="0"><code>In [63]: # 来创建一个新的DataFrame
		 users = pd.DataFrame(data=[&#34; mArk &#34;, &#34;JOHN &#34;, &#34;Tim&#34;, &#34; jenny&#34;],
							  columns=[&#34;name&#34;])
		 users
		 
In [64]: users_cleaned = users.loc[:,&#34;name&#34;].str.strip().str.capitalize()
		 users_cleaned
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250811115530879" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250811115530879.png">

  
</figure>
</p>
<p>可以像下面这样找到所有以“J”开头的名字：</p>
<pre tabindex="0"><code>In [65]: users_cleaned.str.startswith(&#34;J&#34;)
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250811115813567" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250811115813567.png">

  
</figure>
</p>
<p>字符串方法很好用，但是有时候要对 DataFrame 进行的操作可能并没有在对应的内置函数上。在这种情况下，你可以<strong>创建自己的函数</strong>，再将其应用到 DataFrame 上。</p>

<h4 class="relative group">5.2.7 应用函数 
    <div id="527-应用函数" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#527-%e5%ba%94%e7%94%a8%e5%87%bd%e6%95%b0" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>DataFrame 提供了 <strong>applymap 方法</strong>，它会将一个函数应用到每一个元素上，在 NumPy 没有提供所需的 ufunc 时，这是非常有用的。例如，NumPy 并没有提供<strong>字符串格式化的 ufunc</strong>，但可以像下面这样为 DataFrame 的每一个元素进行格式化：</p>
<pre tabindex="0"><code>In [66]: rainfall

In [67]: def format_string(x):
		 return f&#34;{x:,.2f}&#34;
In [68]: # 注意，我们并没有调用作为参数的函数，
         # 也就是说，这里写的是format_string而非format_string()！
         rainfall.applymap(format_string)
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250811120731622" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250811120731622.png">

  
</figure>
</p>
<p>这个 f 字符串会将 x 以字符串的形式返回：f&quot;{x}&quot;。要对其进行<strong>格式化</strong>，需要在变量后面加一个<strong>冒号</strong>，然后跟上具体的<strong>格式化字符串</strong>，这里使用的是 <strong>,.2f</strong>。这个<strong>逗号是千位上的分隔符</strong>，而 <strong>.2f 的意思是以浮点数格式显示，小数点后保留两位</strong>。</p>
<p>在这样的用例中会经常用到 <strong>lambda 表达式</strong>（参见“lambda 表达式”）。lambda 表达式可以让你<strong>在一行代码中编写一个函数，而不用单独去定义一个函数</strong>。通过 lambda 表达式，可以将前面的例子改写成下面这样。</p>
<pre tabindex="0"><code>In [69]: rainfall.applymap(lambda x: f&#34;{x:,.2f}&#34;)
</code></pre><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250811173447170" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250811173447170.png">

  
</figure>
</p>
<p><strong>lambda 表达式</strong>：lambda 表达式是一种<strong>匿名函数</strong>，也就是一种没有名称的函数。假设有这样一个函数：</p>
<pre tabindex="0"><code>def function_name(arg1, arg2, ...): 
	return return_value
</code></pre><p>可以用 lambda 表达式重写这个函数：</p>
<pre tabindex="0"><code>lambda arg1, arg2, ...: return_value
</code></pre><p>简而言之，把 def 换成 lambda，省去 return 关键字，然后将函数的所有内容写到一行。</p>

<h4 class="relative group">5.2.8 视图和副本 
    <div id="528-视图和副本" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#528-%e8%a7%86%e5%9b%be%e5%92%8c%e5%89%af%e6%9c%ac" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>由于修改视图和修改副本有着本质的区别，因此当 pandas 认为你在<strong>无意中修改数据</strong>时，它会发出警告：<strong>SettingWithCopyWarning</strong>。关于如何规避这个相当难以捉摸的警告，下面是一些建议。</p>
<p>​	• 在原本的 DataFrame 中设置值，而不是在切片生成的 DataFrame 中操作。</p>
<p>​	• 如果你想在切片后获得一个单独的 DataFrame，则应该显式地调用 copy。</p>
<pre tabindex="0"><code>selection = df.loc[:, [&#34;country&#34;, &#34;continent&#34;]].copy()
</code></pre><p>虽然 loc 和 iloc 的情况很复杂，但是记得一点，诸如 df.dropna() 或df.sort_value(&ldquo;column_name&rdquo;) 这样的 DataFrame 方法总是<strong>返回副本</strong>。</p>

<h2 class="relative group">附录 A Conda 环境 
    <div id="附录-a-conda-环境" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e9%99%84%e5%bd%95-a-conda-%e7%8e%af%e5%a2%83" aria-label="锚点">#</a>
    </span>        
    
</h2>

<h3 class="relative group">A.1 创建新的Conda环境 
    <div id="a1-创建新的conda环境" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#a1-%e5%88%9b%e5%bb%ba%e6%96%b0%e7%9a%84conda%e7%8e%af%e5%a2%83" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>在 Anaconda Prompt 中执行下列命令以创建一个名为 xl38 的新环境，该环境使用了 Python 3.8：</p>
<pre tabindex="0"><code>(base)&gt; conda create --name xl38 python=3.8
</code></pre><p>安装完成之后，像下面这样激活新的环境：</p>
<pre tabindex="0"><code>(base)&gt; conda activate xl38 
(xl38)&gt;
</code></pre><p>环境名称已从 base 变更为 xl38。现在你可以使用 Conda 或者 pip 在新环境中安装各种包，且不会影响任何其他的环境。（提醒一句：只有在 Conda 中找不到想要的包时才使用 pip。）</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250804204033152" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250804204033152.png">

  
</figure>
</p>
<p>首先，再次确认你处于 xl38 环境中，即 Anaconda Prompt 显示的是 (xl38)，然后像下面这样安装 Conda 包（<strong>注意，这里需要更换为国内镜像源更快</strong>）：</p>
<pre tabindex="0"><code> (xl38)&gt; conda install lxml=4.6.1 matplotlib=3.3.2 notebook=6.1.4 openpyxl=3.0.5 pandas=1.1.3 pillow=8.0.1 plotly=4.14.1 flake8=3.8.4 python-dateutil=2.8.1 requests=2.24.0 sqlalchemy=1.3.20 xlrd=1.2.0 xlsxwriter=1.3.7 xlutils=2.0.0 xlwings=0.20.8 xlwt=1.3.0
</code></pre><p>确认安装计划之后，最后再来使用 pip 安装剩下的两个包。</p>
<pre tabindex="0"><code>(xl38)&gt; pip install pyxlsb==1.0.7 pytrends==4.7.3
</code></pre><p>这里安装时出现问题，更换镜像源不行的话，需要关闭梯子的系统代理，参考如下：</p>
<p><a
  href="https://kites.cc/p/python-pip-ssl-proxy-error/"
    target="_blank"
  >pip安装Python包时的SSL错误</a></p>
<p>如果不想使用 base 环境而想使用 xl38 环境来运行本书中的所有示例代码，那么每次启动 Anaconda Prompt 时一定要执行如下命令来激活 xl38 环境：</p>
<pre tabindex="0"><code>(base)&gt; conda activate xl38
</code></pre><p>也就是说，每当本书代码中的 Anaconda Prompt 显示为 (base)&gt; 时，你看到的应该是 (xl38)&gt;。</p>
<p>要停用环境并回到 base 环境，可以输入如下命令：</p>
<pre tabindex="0"><code>(xl38)&gt; conda deactivate
</code></pre><p>想彻底删除环境，可以运行以下命令：</p>
<pre tabindex="0"><code>(base)&gt; conda env remove --name xl38
</code></pre><p>除了按照上面的步骤手动创建 xl38 环境，也可以利用本书配套代码库的 conda 文件夹中的</p>
<p>xl38.yml <strong>环境文件</strong>。执行下面的命令就可以完成所有工作：</p>
<pre tabindex="0"><code>(base)&gt; cd C:\Users\username\python-for-excel\conda 
(base)&gt; conda env create -f xl38.yml
(base)&gt; conda activate xl38
(xl38)&gt;
</code></pre>
<h3 class="relative group">A.2 禁用自动激活 
    <div id="a2-禁用自动激活" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#a2-%e7%a6%81%e7%94%a8%e8%87%aa%e5%8a%a8%e6%bf%80%e6%b4%bb" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>如果不希望在每次启动 Anaconda Prompt 时自动激活 base 环境，你可以禁用它：这样你就需要在命令提示符（Windows 系统）或终端（macOS 系统）中手动输入 conda activate base 才能使用 Python。</p>
<p>在 Windows 中，你需要使用一般的命令提示符而不是 Anaconda Prompt。下面的步骤可以在普通的命令提示符中启用 conda 命令。一定要将第一行中的路径替换成你的计算机上的 Anaconda 安装目录：</p>
<pre tabindex="0"><code>&gt; cd C:\Users\username\Anaconda3\condabin 
&gt; conda init cmd.exe
</code></pre><p>现在你的普通命令提示符已经配置好 Conda，接下来就可以像下面这样激活 base 环境了。</p>
<pre tabindex="0"><code>&gt; conda activate base 
(base)&gt;
</code></pre><hr>

<h2 class="relative group">附录 B 高级 VS Code 功能 
    <div id="附录-b-高级-vs-code-功能" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e9%99%84%e5%bd%95-b-%e9%ab%98%e7%ba%a7-vs-code-%e5%8a%9f%e8%83%bd" aria-label="锚点">#</a>
    </span>        
    
</h2>

<h3 class="relative group">B.1 调试器 
    <div id="b1-调试器" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#b1-%e8%b0%83%e8%af%95%e5%99%a8" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>首先在 VS Code 中打开配套代码库的 debugging.py 文件。然后点击第 4 行<strong>左边的空白处</strong>，你会看到一个红点，这就是<strong>断点</strong>，代码会在此处暂停执行。接下来<strong>按下 F5 键开始调试</strong>：命令面板会显示<strong>调试配置</strong>选项。选择“Python 文件”以调试活动文件，代码会执行到断点处停止。此时这一行代码会高亮显示，代码的执行过程也会暂停。在调试时，<strong>状态栏会变成橙色</strong>。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250806002135091" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250806002135091.png">

  
</figure>
</p>
<p>如果变量部分没有自动显示在左边，那么一定要点击运行菜单来查看变量的值。另外，也可以将鼠标指针悬停在源代码中的变量上，你会在提示信息中看到它的值。在顶部，你会看到调试工具栏，上面从左到右有这样几个按钮：继续、单步跳过、单步调试、单步跳出、重启和停止。把鼠标指针悬停在这些按钮上时，你还会看到对应的键盘快捷键。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250806002425319" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250806002425319.png">

  
</figure>
</p>
<p>按钮的功能：</p>
<p>1、继续：继续按钮可以让程序继续运行，直到碰到下一个断点或者程序的终点。如果碰到了程序的终点，则调试过程也会停止。</p>
<p>2、单步跳过：调试器会前进一行。单步跳过意味着<strong>调试器在视觉上不会进入不属于当前作用域的那部分代码</strong>。例如，它不会进入你在各行中调用的函数，但是这些函数还是会被调用。</p>
<p>3、单步调试：如果你调用了函数、类，或其他结构，那么单步调试会使调试器进入这个函数或类。如果这个函数或类在不同的文件中，则调试器会为你打开这个文件。</p>
<p>4、单步跳出：如果你使用单步调试进入了一个函数，则单步跳出会使调试器返回上一层代码，最终你会回到一开始调用单步调试的那一层代码。</p>
<p>5、重启：停止当前的调试进程并重新启动一个新的调试进程。</p>
<p>6、停止：停止当前的调试进程。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250806003232358" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250806003232358.png">

  
</figure>
</p>

<h3 class="relative group">B.2 VS Code中的Jupyter笔记本 
    <div id="b2-vs-code中的jupyter笔记本" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#b2-vs-code%e4%b8%ad%e7%9a%84jupyter%e7%ac%94%e8%ae%b0%e6%9c%ac" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>除了在 Web 浏览器中运行 Jupyter 笔记本，也可以直接在 VS Code 中运行 Jupyter 笔记本。除了笔记本的基本功能之外，VS Code 还提供了一个便利的变量浏览器，以及在不丢失单元格功能的前提下将笔记本转换为标准 Python 文件的选项。这样一来调试器的使用就可以更加方便，在不同笔记本之间复制粘贴单元格也会更加便捷。</p>

<h4 class="relative group">B.2.1 运行Jupyter笔记本 
    <div id="b21-运行jupyter笔记本" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#b21-%e8%bf%90%e8%a1%8cjupyter%e7%ac%94%e8%ae%b0%e6%9c%ac" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>点击活动栏中的资源管理器图标，打开配套代码库中的 ch05.ipynb。接下来，需要在弹出窗口中点击<strong>信任</strong>以使我们的笔记本成为<strong>受信任的笔记本</strong>。为了让笔记本的布局和 VS Code 的其他部分更协调，VS Code 中的笔记本看起来和浏览器中的布局会有点儿不一样。不过使用体验依然是一样的，连同快捷键也是如此。我们首先按下快捷键 Shift+Enter 来运行前 3 个单元格。如果 Jupyter 笔记本服务器没有启动，那么此时服务器会随之启动（你会在笔记本的右上方看到服务器的状态）。然后，点击笔记本顶部菜单中的<strong>计算器按钮</strong>：如图 B-2 所示，此时变量浏览器会显示出来，你可以在其中看到现有的所有变量的值。也就是说，你只会在这里看到来自已运行的单元格的变量。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250806095232104" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250806095232104.png">

  
</figure>
</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250806095534445" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250806095534445.png">

  
</figure>
</p>
<p><strong>VS Code 中保存 Jupyter 笔记本</strong>：要在 VS Code 中保存笔记本，需要使用笔记本顶部的保存按钮，或是在 Windows 中按下快捷键 Ctrl+S。</p>
<p>如果使用了像嵌套列表、NumPy 数组、DataFrame 一类的数据结构，那么可以<strong>双击变量</strong>来打开数据查看器，你会看到熟悉的表格式视图。下图展示了双击变量 df 后显示的数据查看器。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250806100432446" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250806100432446.png">

  
</figure>
</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250806100749553" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250806100749553.png">

  
</figure>
</p>

<h4 class="relative group">B.2.2 带有代码单元格的Python脚本 
    <div id="b22-带有代码单元格的python脚本" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#b22-%e5%b8%a6%e6%9c%89%e4%bb%a3%e7%a0%81%e5%8d%95%e5%85%83%e6%a0%bc%e7%9a%84python%e8%84%9a%e6%9c%ac" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>为了在标准 Python 文件中使用 Jupyter 笔记本单元格，VS Code 使用了一种特殊的组件来表示单元格：# %%。要转换现有的 Jupyter 笔记本，可以打开该笔记本并点击笔记本顶部的 export 按钮。这样就可以在命令面板中选择“Python 文件”。不过，我们不会转换现有的文件，而是会新建一个叫作 cell.py 的文件，其中有如下内容：</p>
<pre tabindex="0"><code># %%
3 + 4
# %% [markdown]
# # 这是标题
#
# 一些markdown内容
</code></pre><p>Markdown 单元格需要以 # %% [markdown] 开头，整个单元格必须被标记为注释。如果你想将这样的文件作为笔记本运行，那么可以将鼠标指针悬停在第一个单元格上，点击显示的“运行本单元格及下方单元格”链接。Python 交互式窗口会在右侧打开，如图所示。</p>
<p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="image-20250806101522483" src="C:%5cUsers%5cSHY%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250806101522483.png">

  
</figure>
</p>
<p>要将文件导出为 ipynb 格式，需要点击 Python 交互式窗口顶部的 save 图标。Python 交互式窗口还在底部提供了一个单元格，你可以在这里交互地执行代码。和 Jupyter 笔记本不同，使用常规的 Python 文件可以利用 VS Code 调试器，并使版本控制更加方便，因为输出单元格会被忽略（在版本发生变化时，输出单元格总是会产生大量烦人的信息）。</p>

          
          
          
        </div>
        
          
  
  
  
  
  
  

  

  
    
    
<div class="flex author">
  
    
    
      
    
    
      
        
      
      <img
        class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4"
        width="96"
        height="96"
        alt="Cloud_Shy"
        src="/img/Cloud_Shy_hu_6364bf0b0608bdf4.png">
    
  
  <div class="place-self-center">
    
      <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
        作者
      </div>
      <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
        Cloud_Shy
      </div>
    
    
      <div class="text-sm text-neutral-700 dark:text-neutral-400">Don&rsquo;t be shy, dare to share！</div>
    
    <div class="text-2xl sm:text-lg">
</div>
  </div>
</div>

  

  

  
    <div class="mb-10"></div>
  

        
        

        

        

      </div>

      
      
        
        
          
          
        
        
        
        <script
          type="text/javascript"
          src="/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js"
          integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA=="
          data-oid="views_posts\Excel Python：飞速搞定数据分析与处理之 Python 入门\笔记.md"
          data-oid-likes="likes_posts\Excel Python：飞速搞定数据分析与处理之 Python 入门\笔记.md"></script>
      
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600">
      <div class="flex justify-between pt-3">
        <span>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/posts/vmware-workstation-%E5%AE%89%E8%A3%85%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%8C%87%E5%8D%97/">
              <span class="flex flex-col">
                <span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >VMware Workstation 安装虚拟机指南</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2025-04-15T10:28:11&#43;08:00">2025-04-15</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0 z-10">
  <a
    href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="返回顶部"
    title="返回顶部">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
      
      
        
          
          
      
      
      
      <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 ">
        <ul class="flex list-none flex-col sm:flex-row">
          
            <li class=" flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0 ">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href="/tags/"
                title="Tags">
                
                标签
              </a>
            </li>
          
            <li class=" flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0 ">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href="/categories/"
                title="Categories">
                
                作者
              </a>
            </li>
          
        </ul>
      </nav>
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          &copy;
          2025
          Cloud_Shy
      </p>
    

    
    
      <p class="text-xs text-neutral-500 dark:text-neutral-400">
        
        
        由 <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a> 强力驱动
      </p>
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
  <script
    type="text/javascript"
    src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js"
    integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="http://localhost:1313/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="搜索"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="关闭 (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>
