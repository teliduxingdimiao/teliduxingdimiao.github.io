<!doctype html>
<html
  lang="zh-cn"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="light"
  data-auto-appearance="true"><head>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="zh-cn">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  <title>Excel Python:飞速搞定数据分析与处理之 Pandas 入门笔记 &middot; Cloud_Shy</title>
    <meta name="title" content="Excel Python:飞速搞定数据分析与处理之 Pandas 入门笔记 &middot; Cloud_Shy">

  
  
  <meta name="keywords" content="Python,Pandas,数据处理,">
  
  
  <link rel="canonical" href="https://teliduxingdimiao.github.io/posts/excel-python%E9%A3%9E%E9%80%9F%E6%90%9E%E5%AE%9A%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%84%E7%90%86%E4%B9%8B-pandas-%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/">
  
  
  
  
  
  
  
  
  
  
    
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.d7672814413dccdcf76c504d9b0ebb8d0f964dbe6b30a3d4b25b15809a94c2eb732d99898aded2009aacdd1fa8b17cea1369fd81560790cd355aee00bbd142fd.css"
    integrity="sha512-12coFEE9zNz3bFBNmw67jQ&#43;WTb5rMKPUslsVgJqUwutzLZmJit7SAJqs3R&#43;osXzqE2n9gVYHkM01Wu4Au9FC/Q==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
    
    
    
  
  
    
    
  
  
  
  
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.98bb8ce8f123e03c4d2171eeec151dd404b5c476beb5ef1068d0e8b1a2afb923065e6552fc14b2d867c85ee4bd8529a43193f729f874d3908517ba03b5d1cc57.js"
      integrity="sha512-mLuM6PEj4DxNIXHu7BUd1AS1xHa&#43;te8QaNDosaKvuSMGXmVS/BSy2GfIXuS9hSmkMZP3Kfh005CFF7oDtdHMVw=="
      data-copy="复制"
      data-copied="已复制"></script>
  
  
    
    <script src="/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js" integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7&#43;kfJ6kKCJxQGC&#43;8wm&#43;Bz9JucDjDTGNew=="></script>
  

  
  
    
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">

<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">

<link rel="manifest" href="/site.webmanifest">

<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<link rel="shortcut icon" href="/favicon.ico">

<meta name="msapplication-TileColor" content="#2b5797">
<meta name="msapplication-TileImage" content="/mstile-150x150.png">
<meta name="theme-color" content="#ffffff">

  

  
  
  
  
  
  

  
  <meta property="og:url" content="https://teliduxingdimiao.github.io/posts/excel-python%E9%A3%9E%E9%80%9F%E6%90%9E%E5%AE%9A%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%84%E7%90%86%E4%B9%8B-pandas-%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/">
  <meta property="og:site_name" content="Cloud_Shy">
  <meta property="og:title" content="Excel Python:飞速搞定数据分析与处理之 Pandas 入门笔记">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-18T10:28:11+08:00">
    <meta property="article:modified_time" content="2024-07-18T10:28:11+08:00">
    <meta property="article:tag" content="Python">
    <meta property="article:tag" content="Pandas">
    <meta property="article:tag" content="数据处理">
    <meta property="og:image" content="https://teliduxingdimiao.github.io/posts/excel-python%E9%A3%9E%E9%80%9F%E6%90%9E%E5%AE%9A%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%84%E7%90%86%E4%B9%8B-pandas-%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/feature.png">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://teliduxingdimiao.github.io/posts/excel-python%E9%A3%9E%E9%80%9F%E6%90%9E%E5%AE%9A%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%84%E7%90%86%E4%B9%8B-pandas-%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/feature.png">
  <meta name="twitter:title" content="Excel Python:飞速搞定数据分析与处理之 Pandas 入门笔记">
<meta name="twitter:image" content="https://teliduxingdimiao.github.io/posts/excel-python%E9%A3%9E%E9%80%9F%E6%90%9E%E5%AE%9A%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%84%E7%90%86%E4%B9%8B-pandas-%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/feature.png">
    <meta property="og:image" content="https://teliduxingdimiao.github.io/posts/excel-python%E9%A3%9E%E9%80%9F%E6%90%9E%E5%AE%9A%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%84%E7%90%86%E4%B9%8B-pandas-%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/feature.png">
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Excel Python:飞速搞定数据分析与处理之 Pandas 入门笔记",
    "headline": "Excel Python:飞速搞定数据分析与处理之 Pandas 入门笔记",
    
    
    "inLanguage": "zh-cn",
    "url" : "https:\/\/teliduxingdimiao.github.io\/posts\/excel-python%E9%A3%9E%E9%80%9F%E6%90%9E%E5%AE%9A%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%84%E7%90%86%E4%B9%8B-pandas-%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0\/",
    "author" : {
      "@type": "Person",
      "name": "Cloud_Shy"
    },
    "copyrightYear": "2024",
    "dateCreated": "2024-07-18T10:28:11\u002b08:00",
    "datePublished": "2024-07-18T10:28:11\u002b08:00",
    
    "dateModified": "2024-07-18T10:28:11\u002b08:00",
    
    "keywords": ["Python","Pandas","数据处理"],
    
    "mainEntityOfPage": "true",
    "wordCount": "2096"
  }]
  </script>



  
  
    <meta name="author" content="Cloud_Shy">
  
  

  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>























  
  





  
  

  
  

  
  
    
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script>

    const firebaseConfig = {
      apiKey: "AIzaSyCdOq7GCWM9mQ6wcPBrZownl3-Vvuu9sDY",
      authDomain: "AIzaSyCdOq7GCWM9mQ6wcPBrZownl3-Vvuu9sDY",
      projectId: "cloudshy-c7aef",
      storageBucket: "cloudshy-c7aef.firebasestorage.app",
      messagingSenderId: "95154075478",
      appId: "1:95154075478:web:9440ee157af53a714388f7",
      measurementId: "G-9DTZD8RRGP"
    };

    var app = firebase.initializeApp(firebaseConfig);
    var db = firebase.firestore();
    var auth = firebase.auth();

  </script>
    
  

  
  
</head>
<body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>
        跳过正文
      </a>
    </div>
    
    
      <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px] z-100">
  <div
    id="menu-blur"
    class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom bg-neutral dark:bg-neutral-800"></div>
  <div class="relative max-w-[64rem] ml-auto mr-auto">
    













<div
  class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0">
  
  
    
    
      <div>
        <a href="/" class="flex">
          <span class="sr-only">Cloud_Shy</span>
          
            <img
              src="/img/logo.png"
              width="32"
              height="32"
              class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom"
              alt="Cloud_Shy">
          
        </a>
      </div>
    

  <div class="flex flex-1 items-center justify-between">
    <nav class="flex space-x-3">
      
        <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">
          Cloud_Shy
        </a>
      
    </nav>
    
  <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">
    
      
        
  <a
  href="/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="欢迎来到 Cloud_Shy! :tada:">
    主页
  </p>
</a>



      
        
  <a
  href="/archives/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="历史文档">
    归档
  </p>
</a>



      
        
  <div>
  <div class="cursor-pointer flex items-center nested-menu">
    
    <a
      
      class="text-base font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"
      title="">
      <p>
        分类
      </p>
    </a>
    <span>
      <span class="relative block icon"><svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>
</span>
    </span>
  </div>
  <div class="absolute menuhide">
    <div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl">
      <div class="flex flex-col space-y-3">
        
          <a
            href="/studynotes/"
            
            class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
            
            <p class="text-sm font-sm" title="我的学习笔记">
              我的学习笔记
            </p>
          </a>
        
          <a
            href="/naivelearnings/"
            
            class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
            
            <p class="text-sm font-sm" title="新手入门教程集合">
              新手入门教程集合
            </p>
          </a>
        
      </div>
    </div>
  </div>
</div>



      
        
  <a
  href="/tags/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="标签">
    标签
  </p>
</a>



      
    

    

    

    
      <button
        id="search-button"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="搜索 (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <div class=" flex items-center">
        <button
          id="appearance-switcher"
          aria-label="Dark mode switcher"
          type="button"
          class="text-base hover:text-primary-600 dark:hover:text-primary-400">
          <div class="flex items-center justify-center dark:hidden">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
          </div>
          <div class="items-center justify-center hidden dark:flex">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
          </div>
        </button>
      </div>
    
  </nav>

    
  <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">
    <span></span>

    

    

    
      <button
        id="search-button-mobile"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="搜索 (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <button
        id="appearance-switcher-mobile"
        aria-label="Dark mode switcher"
        type="button"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1">
        <div class="flex items-center justify-center dark:hidden">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
        </div>
        <div class="items-center justify-center hidden dark:flex">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
        </div>
      </button>
    
  </div>

  </div>
  
  <div class="-my-2 md:hidden">
    <div id="menu-button" class="block">
      
        <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
        </div>
        <div
          id="menu-wrapper"
          class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]">
          <ul
            class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">
            <li id="menu-close-button">
              <span
                class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
                <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
              </span>
            </li>

            
              
  <li class="mt-1">
  <a
    href="/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="欢迎来到 Cloud_Shy! :tada:">
      主页
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/archives/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="历史文档">
      归档
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href=""
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="">
      分类
    </p>
    <span>
      <span class="relative block icon"><svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>
</span>
    </span>
  </a>
</li>

  <li class="mt-1">
    <a
      href="/studynotes/"
      
      class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
      
      <p class="text-sm font-small" title="我的学习笔记">
        我的学习笔记
      </p>
    </a>
  </li>

  <li class="mt-1">
    <a
      href="/naivelearnings/"
      
      class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
      
      <p class="text-sm font-small" title="新手入门教程集合">
        新手入门教程集合
      </p>
    </a>
  </li>

<li class="mb-2"></li>



            
              
  <li class="mt-1">
  <a
    href="/tags/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="标签">
      标签
    </p>
  </a>
</li>



            

          </ul>
          
        </div>
      
    </div>
  </div>

</div>





  </div>
</div>


<script
  type="text/javascript"
  src="/js/background-blur.min.0ad33cb9c066f652728b2cc09c9ceaf32645544f48e8b6b38f120d86f433ed997da275a49e6151fe0176430c45376812708d84727f3f969101fb44a4345b3f34.js"
  integrity="sha512-CtM8ucBm9lJyiyzAnJzq8yZFVE9I6LazjxINhvQz7Zl9onWknmFR/gF2QwxFN2gScI2Ecn8/lpEB&#43;0SkNFs/NA=="
  data-target-id="menu-blur"></script>

    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Excel Python:飞速搞定数据分析与处理之 Pandas 入门笔记
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  
    
  

  
  
    
  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2024-07-18T10:28:11&#43;08:00">2024-07-18</time><span class="px-2 text-primary-500">&middot;</span><span>2096 字</span><span class="px-2 text-primary-500">&middot;</span><span title="预计阅读">10 分钟</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span
    id="views_posts\Excel Python：飞速搞定数据分析与处理之 Pandas 入门笔记\index.md"
    class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400"
    title="views"
    >loading</span
  >
  <span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span>
</span>
<span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span
    id="likes_posts\Excel Python：飞速搞定数据分析与处理之 Pandas 入门笔记\index.md"
    class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400"
    title="likes"
    >loading</span
  >
  <span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg></span></span>
</span>
<span class="px-2 text-primary-500">&middot;</span><span>
  <button
    id="button_likes"
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    <span id="button_likes_heart" class="inline-block align-text-bottom hidden"
      ><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg></span>
    </span>
    <span id="button_likes_emtpty_heart" class="inline-block align-text-bottom"
      ><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M244 84L255.1 96L267.1 84.02C300.6 51.37 347 36.51 392.6 44.1C461.5 55.58 512 115.2 512 185.1V190.9C512 232.4 494.8 272.1 464.4 300.4L283.7 469.1C276.2 476.1 266.3 480 256 480C245.7 480 235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1 0 232.4 0 190.9V185.1C0 115.2 50.52 55.58 119.4 44.1C164.1 36.51 211.4 51.37 244 84C243.1 84 244 84.01 244 84L244 84zM255.1 163.9L210.1 117.1C188.4 96.28 157.6 86.4 127.3 91.44C81.55 99.07 48 138.7 48 185.1V190.9C48 219.1 59.71 246.1 80.34 265.3L256 429.3L431.7 265.3C452.3 246.1 464 219.1 464 190.9V185.1C464 138.7 430.4 99.07 384.7 91.44C354.4 86.4 323.6 96.28 301.9 117.1L255.1 163.9z"/></svg></span></span
    >
    <span id="button_likes_text">&nbsp;Like</span>
  </button>
</span>
    

    
    
  </div>

  

  
  
    <div class="flex flex-row flex-wrap items-center">
      
        
      
        
          
            
              <a class="relative mt-[0.5rem] mr-2" href="/categories/%E6%88%91%E7%9A%84%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    我的学习笔记
  </span>
</span>
</a
              >
            
          
        
      
        
      
        
          
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/python/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Python
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/pandas/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Pandas
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    数据处理
  </span>
</span>
</a
              >
            
          
        
      
    </div>
  

  
  



      </div>
      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      
        <div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
          <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]">
            
              <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    目录
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#第四章-numpy-基础">第四章 NumPy 基础</a>
      <ul>
        <li><a href="#41-numpy-入门">4.1 NumPy 入门</a>
          <ul>
            <li><a href="#411-numpy-数组">4.1.1 NumPy 数组</a></li>
            <li><a href="#412-向量化和广播">4.1.2 向量化和广播</a></li>
            <li><a href="#413-通用函数">4.1.3 通用函数</a></li>
          </ul>
        </li>
        <li><a href="#42-创建和操作数组">4.2 创建和操作数组</a>
          <ul>
            <li><a href="#421-存取元素">4.2.1 存取元素</a></li>
            <li><a href="#422-方便的数组构造器">4.2.2 方便的数组构造器</a></li>
            <li><a href="#423-视图和副本">4.2.3 视图和副本</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#第五章-使用-pandas-进行数据分析">第五章 使用 <strong>pandas</strong> 进行数据分析</a>
      <ul>
        <li><a href="#51-dataframe-和-series">5.1 DataFrame 和 Series</a>
          <ul>
            <li><a href="#511-索引">5.1.1 索引</a></li>
            <li><a href="#512-列">5.1.2 列</a></li>
          </ul>
        </li>
        <li><a href="#52-数据操作">5.2 数据操作</a>
          <ul>
            <li><a href="#521-选取数据">5.2.1 选取数据</a></li>
            <li><a href="#522-设置数据">5.2.2 设置数据</a></li>
            <li><a href="#523-缺失数据">5.2.3 缺失数据</a></li>
            <li><a href="#524-重复数据">5.2.4 重复数据</a></li>
            <li><a href="#525-算术运算">5.2.5 算术运算</a></li>
            <li><a href="#526-处理文本列">5.2.6 处理文本列</a></li>
            <li><a href="#527-应用函数">5.2.7 应用函数</a></li>
            <li><a href="#528-视图和副本">5.2.8 视图和副本</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    目录
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#第四章-numpy-基础">第四章 NumPy 基础</a>
      <ul>
        <li><a href="#41-numpy-入门">4.1 NumPy 入门</a>
          <ul>
            <li><a href="#411-numpy-数组">4.1.1 NumPy 数组</a></li>
            <li><a href="#412-向量化和广播">4.1.2 向量化和广播</a></li>
            <li><a href="#413-通用函数">4.1.3 通用函数</a></li>
          </ul>
        </li>
        <li><a href="#42-创建和操作数组">4.2 创建和操作数组</a>
          <ul>
            <li><a href="#421-存取元素">4.2.1 存取元素</a></li>
            <li><a href="#422-方便的数组构造器">4.2.2 方便的数组构造器</a></li>
            <li><a href="#423-视图和副本">4.2.3 视图和副本</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#第五章-使用-pandas-进行数据分析">第五章 使用 <strong>pandas</strong> 进行数据分析</a>
      <ul>
        <li><a href="#51-dataframe-和-series">5.1 DataFrame 和 Series</a>
          <ul>
            <li><a href="#511-索引">5.1.1 索引</a></li>
            <li><a href="#512-列">5.1.2 列</a></li>
          </ul>
        </li>
        <li><a href="#52-数据操作">5.2 数据操作</a>
          <ul>
            <li><a href="#521-选取数据">5.2.1 选取数据</a></li>
            <li><a href="#522-设置数据">5.2.2 设置数据</a></li>
            <li><a href="#523-缺失数据">5.2.3 缺失数据</a></li>
            <li><a href="#524-重复数据">5.2.4 重复数据</a></li>
            <li><a href="#525-算术运算">5.2.5 算术运算</a></li>
            <li><a href="#526-处理文本列">5.2.6 处理文本列</a></li>
            <li><a href="#527-应用函数">5.2.7 应用函数</a></li>
            <li><a href="#528-视图和副本">5.2.8 视图和副本</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>



            
            
          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        

        <div class="article-content max-w-prose mb-20">
          
<h1 class="relative group">第二部分 pandas 入门 
    <div id="第二部分-pandas-入门" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e7%ac%ac%e4%ba%8c%e9%83%a8%e5%88%86-pandas-%e5%85%a5%e9%97%a8" aria-label="锚点">#</a>
    </span>        
    
</h1>

<h2 class="relative group">第四章 NumPy 基础 
    <div id="第四章-numpy-基础" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e7%ac%ac%e5%9b%9b%e7%ab%a0-numpy-%e5%9f%ba%e7%a1%80" aria-label="锚点">#</a>
    </span>        
    
</h2>
<p>NumPy 是 Python 科学计算的<strong>关键包</strong>，为<strong>数组运算</strong>和<strong>线性代数运算</strong>提供了支持。因为 pandas 是在 NumPy 之上建立起来的，所以本章会先介绍 NumPy 的基础知识。在解释了什么是 NumPy 数组之后，我们会学习<strong>向量化</strong>和<strong>广播</strong>这两个重要概念。利用向量化和广播，我们可以写出简洁的数学运算代码，并且它们在 pandas 中也有广泛运用。之后，介绍为什么 NumPy 会提供叫作“<strong>全局函数</strong>”的特殊函数。最后，通过解释 NumPy <strong>视图和副本</strong>之间的区别，学习如何存取 NumPy 数组的值。</p>

<h3 class="relative group">4.1 NumPy 入门 
    <div id="41-numpy-入门" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#41-numpy-%e5%85%a5%e9%97%a8" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>介绍<strong>一维</strong>和<strong>二维</strong>的 NumPy 数组，以及向量化、广播和通用函数的<strong>背景知识</strong>。</p>

<h4 class="relative group">4.1.1 NumPy 数组 
    <div id="411-numpy-数组" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#411-numpy-%e6%95%b0%e7%bb%84" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>对嵌套列表进行数组运算，可以使用循环来完成。要为嵌套列表中的每一个元素都加上 1，可以使用下面的嵌套列表推导式：</p>
<pre tabindex="0"><code>In [1]: matrix = [[1, 2, 3],
 				  [4, 5, 6],
				  [7, 8, 9]]
In [2]: [[i + 1 for i in row] for row in matrix]
Out[2]: [[2, 3, 4], [5, 6, 7], [8, 9, 10]]
</code></pre><p>但是这样的代码<strong>可读性很低</strong>。更关键的是，在面对更大的数组时，遍历整个数组会非常<strong>慢</strong>。如果你的用例和数组大小合适的话，那么使用 NumPy 数组进行运算会比 Python 列表快上几百倍。为了达到如此高的性能，NumPy 利用了用 C 和 Fortran（它们都是编译型语言，比 Python 要快得多）编写的代码。NumPy 数组是保存<strong>同构数据</strong>（homogenous data）的 <strong><em>N</em> 维数组</strong>。“同构”意味着数组中的所有数据都必须是<strong>相同类型</strong>。最常见的情况就是处理一维和二维的浮点数数组。</p>
<center><img src="images\image-20250808095949563.png" width="100%" /></center>
<p>下面来创建一个一维数组和一个二维数组：</p>
<pre tabindex="0"><code>In [3]: # 首先导入NumPy
 		import numpy as np
In [4]: # 使用列表构造一个一维数组
 		array1 = np.array([10, 100, 1000.])
In [5]: # 使用嵌套列表构造一个二维数组
 		array2 = np.array([[1., 2., 3.],
 						   [4., 5., 6.]])
</code></pre><p><strong>数组维度</strong>：要注意一维数组和二维数组之间的区别。一维数组只有一个轴，因此不区分行数组和列数组。</p>
<p>即使 array1 除了最后一个元素（浮点数）之外全是整数，但由于 NumPy 对同构的要求，这个数组的<strong>数据类型</strong>依然是 <strong>float64</strong>，这个类型足以容纳所有的元素。要想了解一个数组的数据类型，可以访问它的 dtype 属性：</p>
<pre tabindex="0"><code>In [6]: array1.dtype
Out[6]: dtype(&#39;float64&#39;)
</code></pre><p>如果需要显式地将 NumPy 数据类型转换成 Python 的基本数据类型，只需使用对应的构造器即可：</p>
<pre tabindex="0"><code>In [7]: float(array1[0])
Out[7]: 10.0
</code></pre>
<h4 class="relative group">4.1.2 向量化和广播 
    <div id="412-向量化和广播" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#412-%e5%90%91%e9%87%8f%e5%8c%96%e5%92%8c%e5%b9%bf%e6%92%ad" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>如果你对一个标量和 NumPy 数组求和，那么 NumPy 会执行按元素的操作。也就是说，你不用亲自遍历每一个元素。NumPy 社区称之为<strong>向量化</strong>（vectorization）。向量化可以让代码更简洁，更接近于数学记法。</p>
<pre tabindex="0"><code>In [8]: array2 + 1
Out[8]: array([[2., 3., 4.],
 			   [5., 6., 7.]])
</code></pre><p><strong>标量</strong>：标量（scalar）指的是某种 Python <strong>基本数据类型</strong>，比如<strong>浮点型</strong>和<strong>字符串</strong>。这是为了将其和列表及字典一类的多元素数据结构，以及一维和二维的 NumPy 数组区分开来。</p>
<p>在处理两个数组时也是同样的道理，NumPy 会执行<strong>按元素</strong>的运算：</p>
<pre tabindex="0"><code>In [9]: array2 * array2
Out[9]: array([[ 1., 4., 9.],
			   [16., 25., 36.]])
</code></pre><p>如果你在算术运算中使用了两个<strong>形状不同</strong>的数组，那么 NumPy 在可能的情况下会<strong>自动将较小的数组扩展成较大的数组的形状</strong>。这就是<strong>广播</strong>（broadcasting）：</p>
<pre tabindex="0"><code>In [10]: array2 * array1
Out[10]: array([[ 10., 200., 3000.],
			    [ 40., 500., 6000.]])
</code></pre><p>要求<strong>矩阵的点积</strong>，需要使用 @ 运算符：</p>
<pre tabindex="0"><code>In [11]: array2 @ array2.T # array2.T是array2.transpose()的缩写形式
Out[11]: array([[14., 32.],
 				[32., 77.]])
</code></pre><p><strong>拓展</strong>：矩阵的点积，也称为<strong>内积</strong>或<strong>标量积</strong>，在数学中是一种重要的矩阵运算。它涉及两个矩阵中对应元素的<strong>乘积和随后的求和</strong>，结果是一个<strong>单一的标量值</strong>。对于两个向量 <strong>a</strong> 和 <strong>b</strong>，它们的点积是这样计算的：<strong>a</strong> ⋅ <strong>b</strong> = a1b1 + a2b2 + &hellip; + anbn，其中 a1, a2, &hellip;, an 和 b1, b2, &hellip;, bn 是向量 <strong>a</strong> 和 <strong>b</strong> 的对应元素。如果将这个概念扩展到矩阵，矩阵的点积就是<strong>两个矩阵对应元素乘积的总和</strong>。</p>

<h4 class="relative group">4.1.3 通用函数 
    <div id="413-通用函数" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#413-%e9%80%9a%e7%94%a8%e5%87%bd%e6%95%b0" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>通用函数（universal function，简称 ufunc）会对 NumPy 数组中的每个元素执行操作。如果在 NumPy 数组中使用 Python <strong>标准库 math 模块</strong>中的开平方函数，那么你会得到一个错误：</p>
<pre tabindex="0"><code>In [12]: import math
In [13]: math.sqrt(array2) # 这里会发生错误
---------------------------------------------------------------------------
TypeError Traceback (most recent call last)
&lt;ipython-input-13-5c37e8f41094&gt; in &lt;module&gt;
----&gt; 1 math.sqrt(array2) # 这里会发生错误

TypeError: only size-1 arrays can be converted to Python scalars
</code></pre><p>可以写一个嵌套循环来计算每个元素的平方根，然后再把结果构造成一个 NumPy 数组：</p>
<pre tabindex="0"><code>In [14]: np.array([[math.sqrt(i) for i in row] for row in array2])
Out[14]: array([[1. , 1.41421356, 1.73205081],
 			    [2. , 2.23606798, 2.44948974]])
</code></pre><p>NumPy 有这样一个 ufunc，直接用它，除了更容易输入和阅读，在处理大型数组时 ufunc 会快得多：</p>
<pre tabindex="0"><code>In [15]: np.sqrt(array2)
Out[15]: array([[1. , 1.41421356, 1.73205081],
 				[2. , 2.23606798, 2.44948974]])
</code></pre><p>NumPy 的一些 ufunc 也可以用作数组的方法。以 sum 为例，如果你想求出每一列的总和，那么可以像下面这样做：</p>
<pre tabindex="0"><code>In [16]: array2.sum(axis=0) # 返回一维数组
Out[16]: array([5., 7., 9.])
</code></pre><p>参数 <strong>axis=0</strong> 表示<strong>以行为轴</strong>，参数 <strong>axis=1</strong> 表示<strong>以列为轴</strong>。省略 axis 参数会将整个数组加起来：</p>
<pre tabindex="0"><code>In [17]: array2.sum()
Out[17]: 21.0
</code></pre>
<h3 class="relative group">4.2 创建和操作数组 
    <div id="42-创建和操作数组" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#42-%e5%88%9b%e5%bb%ba%e5%92%8c%e6%93%8d%e4%bd%9c%e6%95%b0%e7%bb%84" aria-label="锚点">#</a>
    </span>        
    
</h3>

<h4 class="relative group">4.2.1 存取元素 
    <div id="421-存取元素" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#421-%e5%ad%98%e5%8f%96%e5%85%83%e7%b4%a0" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>在处理本章开头例子中的 matrix 这类嵌套列表时，可以使用链式索引（chained indexing）：matrix[0] [0]会得到第一行的第一个元素。不过在 NumPy 数组中，你要在一对方括号中同时提供两个维度的索引和切片参数：</p>
<pre tabindex="0"><code>numpy_array[row_selection, column_selection]
</code></pre><p>对于一维数组，上述代码简化成了 numpy_array[selection]。在选取单个元素时，你会得到一个标量，否则得到的就是一维或二维的数组。对二维数组的行或列进行切片，得到的是一个一维数组，而不是二维列向量或行向量。</p>
<center><img src="images\image-20250808174720415.png" width="100%" /></center>
<pre tabindex="0"><code>In [18]: array1[2] # 返回标量
Out[18]: 1000.0
In [19]: array2[0, 0] # 返回标量
Out[19]: 1.0
In [20]: array2[:, 1:] # 返回二维数组
Out[20]: array([[2., 3.],
 				[5., 6.]])
In [21]: array2[:, 1] # 返回一维数组
Out[21]: array([2., 5.])
In [22]: array2[1, :2] # 返回一维数组
Out[22]: array([4., 5.])
</code></pre>
<h4 class="relative group">4.2.2 方便的数组构造器 
    <div id="422-方便的数组构造器" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#422-%e6%96%b9%e4%be%bf%e7%9a%84%e6%95%b0%e7%bb%84%e6%9e%84%e9%80%a0%e5%99%a8" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>通过 arange 和 reshape，可以快速生成指定维度的数组：</p>
<pre tabindex="0"><code>In [23]: np.arange(2 * 5).reshape(2, 5) # 2行，5列
Out[23]: array([[0, 1, 2, 3, 4],
 				[5, 6, 7, 8, 9]])
</code></pre><p>以蒙特卡罗模拟为例，一个常见需求是生成服从<strong>正态分布</strong>的伪随机数数组。NumPy 可以轻松做到：</p>
<pre tabindex="0"><code>In [24]: np.random.randn(2, 3) # 2行，3列
Out[24]: array([[-0.30047275, -1.19614685, -0.13652283],
 				[ 1.05769357, 0.03347978, -1.2153504 ]])
</code></pre><p>还有一些方便的构造器值得去发掘，比如 <strong>np.ones</strong> 和 <strong>np.zeros</strong>，它们分别可以创建全是 <strong>1</strong> 和 <strong>0</strong> 的数组。<strong>np.eye</strong> 可以创建<strong>单位矩阵</strong>。</p>

<h4 class="relative group">4.2.3 视图和副本 
    <div id="423-视图和副本" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#423-%e8%a7%86%e5%9b%be%e5%92%8c%e5%89%af%e6%9c%ac" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>在对 NumPy <strong>数组切片</strong>时，其<strong>返回值</strong>是<strong>视图</strong>（view）。这就意味着你是在<strong>操作</strong>原数组的一个子集，而<strong>没有发生数据的复制</strong>。因而<strong>设置视图的值也会改变原数组中的值</strong>：</p>
<pre tabindex="0"><code>In [25]: array2
Out[25]: array([[1., 2., 3.],
 				[4., 5., 6.]])
In [26]: subset = array2[:, :2]
 		 subset
Out[26]: array([[1., 2.],
 				[4., 5.]])
In [27]: subset[0, 0] = 1000
In [28]: subset
Out[28]: array([[1000., 2.],
 				[ 4., 5.]])
In [29]: array2
Out[29]: array([[1000., 2., 3.],
 				[ 4., 5., 6.]])
</code></pre><p>如果不想要这样的结果，那么可以把 In [26] 的代码改成下面这样：</p>
<pre tabindex="0"><code>subset = array2[:, :2].copy()
</code></pre><p>对副本进行操作不会影响原数组。</p>

<h2 class="relative group">第五章 使用 <strong>pandas</strong> 进行数据分析 
    <div id="第五章-使用-pandas-进行数据分析" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e7%ac%ac%e4%ba%94%e7%ab%a0-%e4%bd%bf%e7%94%a8-pandas-%e8%bf%9b%e8%a1%8c%e6%95%b0%e6%8d%ae%e5%88%86%e6%9e%90" aria-label="锚点">#</a>
    </span>        
    
</h2>
<p>pandas，即 <strong>Python 数据分析库</strong>（Python data analysis library），pandas 最主要的超能力就是<strong>向量化</strong>和<strong>数据对齐</strong>。首先会介绍如何<strong>清理和准备数据</strong>，然后你会了解到如何通过<strong>聚合、描述性统计量和可视化</strong>让大型数据集更易于理解。本章在结尾部分会介绍如何用 pandas <strong>导入和导出数据</strong>。不过首先，先来了解一下 pandas <strong>最主要的数据结构</strong>：<strong>DataFrame</strong> 和 <strong>Series</strong>。</p>

<h3 class="relative group">5.1 DataFrame 和 Series 
    <div id="51-dataframe-和-series" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#51-dataframe-%e5%92%8c-series" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>DataFrame（<strong>数据帧</strong>）和 Series（<strong>序列</strong>）是 pandas 的<strong>核心数据结构</strong>。本节会对 DataFrame 的主要组件——<strong>索引、列和数据</strong>逐一介绍。DataFrame 和<strong>二维的 NumPy 数组类似</strong>，但是它的行和列有对应的<strong>标签</strong>，并且每一列都可以<strong>存储不同类型的数据</strong>。从 DataFrame 中<strong>提取一行或一列时</strong>，你会得到一个<strong>一维的 Series</strong>。类似地，Series 相当于<strong>带标签的一维 NumPy 数组</strong>。</p>
<center><img src="images\image-20250808182319041.png" width="80%" /></center>
<p>从工作表到 DataFrame 的过渡非常简单，下图的 Excel 表格中展示了网课学员的基本信息及其分数。你可以在配套代码库的 xl 文件夹中找到对应的 course_participants.xlsx 文件。</p>
<center><img src="images\image-20250808182827930.png" width="90%" /></center>
<p>为了能在 Python 中使用这个 Excel 表格，首先要<strong>导入 pandas</strong>，然后使用 <strong>read_excel 函数</strong>通过 Excel 文件<strong>构造</strong>一个 <strong>DataFrame</strong>。</p>
<pre tabindex="0"><code>In [1]: import pandas as pd
In [2]: pd.read_excel(&#34;xl/course_participants.xlsx&#34;)
Out[2]: user_id name age country score continent
 	  0 1001    Mark  55   Italy   4.5   Europe
 	  1 1000    John  33   USA     6.7   America
 	  2 1002    Tim   41   USA     3.9   America
 	  3 1003    Jenny 12  Germany  9.0   Europe
</code></pre><p>在 Python 3.9 中使用 read_excel 函数如果你在 Python 3.9 或者更高版本中使用 pd.read_excel 函数，那么一定要确保 <strong>pandas 版本在 1.2 以上</strong>，否则会在读取 xlsx 文件时发生错误。</p>
<p><strong>参考</strong>：https://geek-docs.com/python/python-ask-answer/346_hk_1709853930.html</p>
<p>通过 Python 代码查看 Pandas 版本：</p>
<pre tabindex="0"><code>import pandas as pd

print(pd.__version__)
</code></pre><p>这里的<strong>报错处理如下</strong>：修改已经弃用的 np.float 为 float。</p>
<center><img src="images\image-20250809005347152.png" width="80%" /></center>
<p>创建 DataFrame 的方法之一是利用<strong>嵌套列表</strong>来提供数据，除了数据本身，还需要<strong>提供 columns 参数和 index 参数</strong>：</p>
<pre tabindex="0"><code>In [3]: data=[[&#34;Mark&#34;, 55, &#34;Italy&#34;, 4.5, &#34;Europe&#34;],
 			  [&#34;John&#34;, 33, &#34;USA&#34;, 6.7, &#34;America&#34;],
			  [&#34;Tim&#34;, 41, &#34;USA&#34;, 3.9, &#34;America&#34;],
			  [&#34;Jenny&#34;, 12, &#34;Germany&#34;, 9.0, &#34;Europe&#34;]]
	    df = pd.DataFrame(data=data,
	   					  columns=[&#34;name&#34;, &#34;age&#34;, &#34;country&#34;,
						  		   &#34;score&#34;, &#34;continent&#34;],
						  index=[1001, 1000, 1002, 1003])
	    df
Out[3]:			name	age	country	score	continent
        1001	Mark	55	Italy	4.5		Europe
        1000	John	33	USA		6.7		America
        1002	Tim		41	USA		3.9		America
        1003	Jenny	12	Germany	9.0		Europe
</code></pre><p>调用 <strong>info 方法</strong>可以获得 DataFrame 的一些<strong>基本信息</strong>，其中最重要的是<strong>数据点数量</strong>和<strong>每一列的数据类型</strong>：</p>
<pre tabindex="0"><code>In [4]: df.info()
</code></pre><pre tabindex="0"><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 4 entries, 1001 to 1003
Data columns (total 5 columns):
 #   Column     Non-Null Count  Dtype
---  ------     --------------  -----
 0   name       4 non-null      object
 1   age        4 non-null      int64
 2   country    4 non-null      object
 3   score      4 non-null      float64
 4   continent  4 non-null      object
dtypes: float64(1), int64(1), object(3)
memory usage: 192.0+ bytes
</code></pre><p>如果只对列的数据类型感兴趣，那么可以执行 df.dtypes。如果列含有字符串或者混合了不同数据类型，那么它的数据类型就是 object。</p>

<h4 class="relative group">5.1.1 索引 
    <div id="511-索引" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#511-%e7%b4%a2%e5%bc%95" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>DataFrame 的<strong>行标签被称为索引</strong>（index）。如果你找不到一个有意义的索引，那么在构造 DataFrame 时可以直接省略，pandas 会自动创建一个从 0 开始的整数索引。</p>
<p>获取索引对象：</p>
<pre tabindex="0"><code>In [5]: df.index
Out[5]: Int64Index([1001, 1000, 1002, 1003], dtype=&#39;int64&#39;)
</code></pre><p>可以的话，应该<strong>给索引取一个名字</strong>。根据 Excel 表格对应的列名，我们给索引取名为 user_id：</p>
<pre tabindex="0"><code>In [6]: df.index.name = &#34;user_id&#34;
	    df
Out[6]: 		  name age country score continent
     	user_id
     	1001 	  Mark 	55 Italy 	4.5   Europe
     	1000      John 	33 USA 		6.7   America
     	1002 	  Tim  	41 USA 		3.9   America
     	1003 	  Jenny 12 Germany 	9.0   Europe
</code></pre><p>和数据库中的主键不同，DataFrame 的<strong>索引可以重复</strong>，但是这种情况下查询速度可能会变慢。要将索引<strong>还原成普通的列</strong>，可以使用 <strong>reset_index</strong>，而 <strong>set_index</strong> 可以<strong>设置一个新的索引</strong>。如果在设置新索引时不想丢掉原本的索引，那么一定要先重置索引：</p>
<pre tabindex="0"><code>In [7]: # reset_index会将索引还原为普通列，同时用默认索引替换当前索引
 		# 最终结果就和刚从Excel文件中得到的DataFrame一样
 		df.reset_index()
Out[7]: 	user_id name 	age country score continent
         0  1001    Mark 	55 	Italy 	4.5 	Europe
         1  1000  	John 	33 	USA 	6.7 	America
         2  1002 	Tim  	41 	USA 	3.9 	America
         3  1003 	Jenny 	12 	Germany 9.0 	Europe
In [8]: # reset_index会将user_id还原成普通列
 		# set_index会将&#34;name&#34;列设置为索引
 		df.reset_index().set_index(&#34;name&#34;)
Out[8]: 	  user_id age country score continent
 		name
        Mark  1001 	  55   Italy   4.5   Europe
        John  1000    33   USA 	   6.7   America
        Tim   1002    41   USA     3.9   America
        Jenny 1003    12   Germany 9.0   Europe
</code></pre><p>df.reset_index().set_index(&ldquo;name&rdquo;) 这种形式的代码被称为链式方法调用（method chaining）：reset_index() 会返回一个 DataFrame，你可以直接在这个 DataFrame 上调用另一个方法而无须写出中间值。</p>
<p><strong>DataFrame 的方法返回的是副本</strong>：每当以 df.method_name() 的形式调用 DataFrame 的方法时，你都会得到一个应用了该方法的 DataFrame 副本，而原来的 DataFrame 没有任何变化。刚刚调用的 df.reset_index() 就是这样的。如果你想改变原来的 DataFrame，那么可以<strong>把返回值赋值给原来的变量</strong>：</p>
<pre tabindex="0"><code>df = df.reset_index()
</code></pre><p>用 <strong>reindex 方法</strong>更换索引：</p>
<pre tabindex="0"><code>In [9]: df.reindex([999, 1000, 1001, 1004])
Out[9]: 		name age country score continent
 		user_id
 		999 	NaN  NaN  NaN     NaN    NaN
 		1000 	John 33.0 USA     6.7    America
 		1001 	Mark 55.0 Italy   4.5    Europe
 		1004 	NaN  NaN  NaN     NaN    NaN
</code></pre><p>reindex 会接管所有能够匹配新索引的行，而无法匹配的索引会引入含有空值（NaN）的行。被忽略的索引所对应的行会被直接丢弃。最后，使用 <strong>sort_index</strong> 可以按索引进行排序：</p>
<pre tabindex="0"><code>In [10]: df.sort_index()
Out[10]: 		 name  age country score continent
         user_id
         1000 	 John  33   USA     6.7   America
         1001 	 Mark  55   Italy   4.5   Europe
         1002 	 Tim   41   USA     3.9   America
         1003 	 Jenny 12   Germany 9.0   Europe
</code></pre><p>如果你想按一列或多列进行排序，可以使用 <strong>sort_values</strong>：</p>
<pre tabindex="0"><code>In [11]: df.sort_values([&#34;continent&#34;, &#34;age&#34;])
Out[11]: 		 name 	age country score continent
         user_id
         1000 	 John 	33 	USA 	6.7 	America
         1002 	 Tim  	41 	USA 	3.9 	America
         1003 	 Jenny  12 	Germany 9.0 	Europe
         1001 	 Mark 	55 	Italy 	4.5 	Europe
</code></pre><p>如果只想按某一列进行排序，那么也可以用<strong>列名字符串</strong>作为参数：</p>
<pre tabindex="0"><code>df.sort_values(&#34;continent&#34;)
</code></pre>
<h4 class="relative group">5.1.2 列 
    <div id="512-列" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#512-%e5%88%97" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>执行如下代码可以获得 DataFrame 列的信息：</p>
<pre tabindex="0"><code>In [12]: df.columns
Out[12]: Index([&#39;name&#39;, &#39;age&#39;, &#39;country&#39;, &#39;score&#39;, &#39;continent&#39;], 					       dtype=&#39;object&#39;)
</code></pre><p>如果在构造 DataFrame 时没有提供列名，那么 pandas 会用从 0 开始的数字为列编号。不过在处理列的时候这并不是一个好主意，列代表着各种变量，要取个名字并非难事。为列命名与命名索引类似：</p>
<pre tabindex="0"><code>In [13]: df.columns.name = &#34;properties&#34;
 		 df
Out[13]: properties name 	age country score continent
         user_id
         1001 		Mark 	55 	Italy 	4.5 	Europe
         1000 		John 	33 	USA 	6.7 	America
         1002 		Tim  	41 	USA 	3.9 	America
         1003 		Jenny 	12 	Germany 9.0 	Europe
</code></pre><p>如果不喜欢某些列的列名，可以进行重命名：</p>
<pre tabindex="0"><code>In [14]: df.rename(columns={&#34;name&#34;: &#34;First Name&#34;, &#34;age&#34;: &#34;Age&#34;})
Out[14]: properties First Name Age country score continent
         user_id
         1001 			Mark 	55 	Italy 	4.5 	Europe
         1000 			John 	33 	USA 	6.7 	America
         1002 			Tim 	41 	USA 	3.9 	America
         1003 			Jenny 	12 	Germany 9.0 	Europe
</code></pre><p>如果想删除某些列，可以使用如下语法（这个例子还体现了如何在删除列的同时删除索引）：</p>
<pre tabindex="0"><code>In [15]: df.drop(columns=[&#34;name&#34;, &#34;country&#34;], index=[1000, 1003])
Out[15]: properties age score continent
 		 user_id
         1001 		55 	 4.5 	Europe
         1002 		41 	 3.9 	America
</code></pre><p>DataFrame 的列和索引都是由 Index 对象表示的，通过<strong>转置</strong>（transpose）DataFrame 可以将行和列对调：</p>
<pre tabindex="0"><code>In [16]: df.T # df.transpose()的简写
</code></pre><center><img src="images\image-20250809104653638.png" width="80%" /></center>
<p>要记住的是，我们的 DataFrame df 仍然<strong>原封不动</strong>，因为并没有将方法返回的 DataFrame 赋值给原来的 df 变量。如果需要更改 DataFrame 列的顺序，那么也可以使用用在索引上的 reindex 方法，不过<strong>直接给出所需要的列顺序</strong>通常会更直观：</p>
<pre tabindex="0"><code>In [17]: df.loc[:, [&#34;continent&#34;, &#34;country&#34;, &#34;name&#34;, &#34;age&#34;, &#34;score&#34;]]
</code></pre><center><img src="images\image-20250809104932709.png" width="80%" /></center>

<h3 class="relative group">5.2 数据操作 
    <div id="52-数据操作" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#52-%e6%95%b0%e6%8d%ae%e6%93%8d%e4%bd%9c" aria-label="锚点">#</a>
    </span>        
    
</h3>
<p>在使用数据之前，需要对其进行清理，使其更易于理解。如何从 DataFrame 中<strong>选取数据</strong>，如何<strong>修改数据</strong>，以及如何<strong>处理缺失和重复的数据</strong>。然后再对 DataFrame 进行一些运算，看看如何<strong>处理文本数据</strong>。</p>

<h4 class="relative group">5.2.1 选取数据 
    <div id="521-选取数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#521-%e9%80%89%e5%8f%96%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h4>

<h5 class="relative group">1. 使用标签选取数据 
    <div id="1-使用标签选取数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#1-%e4%bd%bf%e7%94%a8%e6%a0%87%e7%ad%be%e9%80%89%e5%8f%96%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>访问 DataFrame 数据的最常见方式是用它的标签来引用数据。使用 <strong>loc</strong> 属性（代表 location，位置）指定你想获取的行和列：</p>
<pre tabindex="0"><code>df.loc[row_selection, column_selection]
</code></pre><p>loc 支持切片语法，因此可以<strong>用冒号来选取所有的行或者列</strong>。你既可以提供保存标签的列表作为参数，也可以只提供单个行或者列的名称作为参数。</p>
<p>从 df 这个 DataFrame 中选取部分数据的方法：</p>
<center><img src="images\image-20250809174419314.png" width="100%" /></center>
<center><img src="images\image-20250809174541499.png" width="100%" /></center>
<p><strong>标签切片是闭区间</strong>：和 Python 内置的切片语法以及 pandas 的其他地方不同，在使用标签切片时，标签的区间<strong>包含区间首尾</strong>的两个标签。</p>
<pre tabindex="0"><code>In [18]: # 行和列都使用标量来选择，返回值也是标量
 		 df.loc[1001, &#34;name&#34;]
In [19]: # 只用标量选择行或列，返回值是Series
 		 df.loc[[1001, 1002], &#34;age&#34;]
In [20]: # 选取多行或多列，返回值是DataFrame
 		 df.loc[:1002, [&#34;name&#34;, &#34;country&#34;]]
</code></pre><center><img src="images\image-20250809175213983.png" width="70%" /></center>
<p>DataFrame（无论是一列还是多列）与 Series 之间是有<strong>区别</strong>的，理解这一点至关重要。即使只包含一列，DataFrame 也是二维的数据结构，而 Series 永远是一维的。DataFrame 和 Series 都有索引，但<strong>只有 DataFrame 有列标题</strong>。当你<strong>选取一列生成 Series</strong> 时，<strong>列标题就变成了 Series 的名称</strong>。</p>
<p><strong>列选择的捷径</strong>: 列的选取是十分常见的操作，pandas 为其提供了更简单的写法。除了这样写：</p>
<pre tabindex="0"><code>df.loc[:, column_selection]
</code></pre><p>也可以这样写：</p>
<pre tabindex="0"><code>df[column_selection]
</code></pre><p>例 如，df[&ldquo;country&rdquo;] 会从我们的示例 DataFrame 中返回一个 Series， 而 df[[&ldquo;name&rdquo;, &ldquo;country&rdquo;]] 会返回一个包含两列的 DataFrame。</p>
<center><img src="images\image-20250809175952293.png" width="70%" /></center>

<h5 class="relative group">2. 通过位置选取数据 
    <div id="2-通过位置选取数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#2-%e9%80%9a%e8%bf%87%e4%bd%8d%e7%bd%ae%e9%80%89%e5%8f%96%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>通过位置选取 DataFrame 的子集类似于本章开头在 NumPy 数组上进行的操作。不过对于 DataFrame 来说，需要使用 <strong>iloc 属性</strong>，它的意思是<strong>整数位置</strong>（integer location）：</p>
<pre tabindex="0"><code>df.iloc[row_selection, column_selection]
</code></pre><p>在使用切片时，iloc 使用的是<strong>标准的半开半闭区间</strong>。</p>
<center><img src="images\image-20250809180423684.png" width="90%" /></center>
<pre tabindex="0"><code>In [21]: df.iloc[0, 0] # 返回标量

In [22]: df.iloc[[0, 2], 1] # 返回Series

In [23]: df.iloc[:3, [0, 2]] # 返回DataFrame
</code></pre>
<h5 class="relative group">3. 使用布尔索引选取数据 
    <div id="3-使用布尔索引选取数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#3-%e4%bd%bf%e7%94%a8%e5%b8%83%e5%b0%94%e7%b4%a2%e5%bc%95%e9%80%89%e5%8f%96%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>布尔索引（boolean indexing）是借助只包含 True 或 False 的 Series 或 DataFrame 来<strong>选取</strong>一个 DataFrame 的<strong>子集</strong>。布尔 Series 可以用来选取 DataFrame 的特定列和行，布尔 DataFrame 则用来选取整个 DataFrame 中的某些值。布尔索引最<strong>常见的用例</strong>是用来<strong>筛选 DataFrame 的行</strong>。</p>
<pre tabindex="0"><code>In [24]: tf = (df[&#34;age&#34;] &gt; 40) &amp; (df[&#34;country&#34;] == &#34;USA&#34;)
 		 tf # 这个Series中只有True和False

In [25]: df.loc[tf, :]
</code></pre><center><img src="images\image-20250809182705248.png" width="70%" /></center>
<p>第一，由于技术上的限制，你无法在 DataFrame 中使用第 3 章讲到的 Python 布尔运算符。需要使用表 5-3 中的这些符号。</p>
<center><img src="images\image-20250809182848564.png" width="80%" /></center>
<p>第二，如果你的筛选条件不止一条，那么一定要在每条布尔表达式之间加上圆括号，这样可以防止<strong>运算符优先级</strong>造成的问题：例如，&amp; 运算符的优先级比 == 高。</p>
<p>对索引进行筛选，那么可以用 <strong>df.index</strong> 来引用索引对象：</p>
<pre tabindex="0"><code>In [26]: df.loc[df.index &gt; 1001, :]
</code></pre><center><img src="images\image-20250809183053086.png" width="70%" /></center>
<p>Python 的基本数据结构（如列表）可以使用 in 运算符判断是否包含某些对象，如果要在 <strong>Series</strong> 中进行类似的操作，就需要使用 <strong>isin 方法</strong>。可以像下面这样筛选出所有来自意大利和德国的学员：</p>
<pre tabindex="0"><code>In [27]: df.loc[df[&#34;country&#34;].isin([&#34;Italy&#34;, &#34;Germany&#34;]), :]
</code></pre><center><img src="images\image-20250809183321102.png" width="70%" /></center>
<p>DataFrame 还提供了一种特殊的语法，可以在不使用 loc 的情况下<strong>传递一整个布尔 DataFrame 作为参数</strong>：</p>
<pre tabindex="0"><code>df[boolean_df]
</code></pre><p>在 DataFrame <strong>只包含数字</strong>时这种语法特别有用。当提供这样一个布尔 DataFrame 作为参数时，返回的 DataFrame 会在原 DataFrame 的基础上，把对应着 False 的地方变成 NaN。下面先来创建一个新的示例 DataFrame，命名为 rainfall，它只包含数字：</p>
<pre tabindex="0"><code>In [28]: # 当作以毫米为单位的年降雨量
		 rainfall = pd.DataFrame(data={&#34;City 1&#34;: [300.1, 100.2],
									   &#34;City 2&#34;: [400.3, 300.4],
								 	   &#34;City 3&#34;: [1000.5, 1100.6]})
		rainfall

In [29]: rainfall &lt; 400

In [30]: rainfall[rainfall &lt; 400]
</code></pre><center><img src="images\image-20250809184127460.png" width="80%" /></center>
<p>要注意在这个例子中，我使用了<strong>字典</strong>来<strong>构造</strong>一个新的 DataFrame。如果数据本身就是这种形式的话，这是很方便的。布尔值的这种用法经常被用来排除某些值，比如异常值。</p>

<h5 class="relative group">4. 使用 MultiIndex 选取数据 
    <div id="4-使用-multiindex-选取数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#4-%e4%bd%bf%e7%94%a8-multiindex-%e9%80%89%e5%8f%96%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>MultiIndex 是一种多级索引。它可以将数据按层次分组，这样你就可以更方便地访问 DataFrame 的子集。如果将 continent 和 country 一起设置为 df 这个 DataFrame 的索引，那么你就可以轻松地通过某个大洲的名称来选取对应的所有行：</p>
<pre tabindex="0"><code>In [31]: # 待排序的MultiIndex
 		 df_multi = df.reset_index().set_index([&#34;continent&#34;, &#34;country&#34;])
		 df_multi = df_multi.sort_index()
		 df_multi

In [32]: df_multi.loc[&#34;Europe&#34;, :]
</code></pre><center><img src="images\image-20250810011415459.png" width="90%" /></center>
<p>通过多级索引选取数据需要提供一个元组作为参数：</p>
<pre tabindex="0"><code>In [33]: df_multi.loc[(&#34;Europe&#34;, &#34;Italy&#34;), :]
</code></pre><center><img src="images\image-20250810011552850.png" width="70%" /></center>
<p>想选择性地重置一部分 MultiIndex，那么可以为 reset_index 提供索引级别参数。索引级别从左至右从 0 开始：</p>
<pre tabindex="0"><code>In [34]: df_multi.reset_index(level=0)
</code></pre><center><img src="images\image-20250810011712170.png" width="70%" /></center>

<h4 class="relative group">5.2.2 设置数据 
    <div id="522-设置数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#522-%e8%ae%be%e7%bd%ae%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>修改 DataFrame 数据的最简单的方法是通过 <strong>loc</strong> 和 <strong>iloc 属性</strong>为某些元素赋值。</p>

<h5 class="relative group">1. 通过标签或位置设置值 
    <div id="1-通过标签或位置设置值" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#1-%e9%80%9a%e8%bf%87%e6%a0%87%e7%ad%be%e6%88%96%e4%bd%8d%e7%bd%ae%e8%ae%be%e7%bd%ae%e5%80%bc" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>当你以 df.reset_index() 的形式调用 DataFrame 的方法时，方法总是会被应用到一个副本上，而原本的 DataFrame 是原封不动的。然而通过 <strong>loc 属性</strong>和 <strong>iloc 属性</strong>赋值时，原本的 DataFrame 是会被修改的。由于不想修改 df 这个 DataFrame，因此在这里我创建了一个名为 df2 的<strong>副本</strong>。如果你想修改某一个值，那么可以像下面这样做：</p>
<pre tabindex="0"><code>In [35]: # 先复制DataFrame，保持原本的DataFrame不变
		 df2 = df.copy()
</code></pre><center><img src="images\image-20250810094835126.png" width="70%" /></center>
<p>下面是同时修改 ID 为 1000 和 1001 的两名用户分数的一种方法，这里使用了一个<strong>列表作为参数</strong>：</p>
<pre tabindex="0"><code>In [37]: df2.loc[[1000, 1001], &#34;score&#34;] = [3, 4]
		 df2
</code></pre><center><img src="images\image-20250810095116488.png" width="70%" /></center>

<h5 class="relative group">2. 通过布尔索引设置数据 
    <div id="2-通过布尔索引设置数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#2-%e9%80%9a%e8%bf%87%e5%b8%83%e5%b0%94%e7%b4%a2%e5%bc%95%e8%ae%be%e7%bd%ae%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>用来筛选行的布尔索引也可以用来为 DataFrame 赋值。假设你需要将所有来自美国或年龄在 20 岁以下的学员匿名：</p>
<pre tabindex="0"><code>In [38]: tf = (df2[&#34;age&#34;] &lt; 20) | (df2[&#34;country&#34;] == &#34;USA&#34;)
		 df2.loc[tf, &#34;name&#34;] = &#34;xxx&#34;
		 df2
</code></pre><center><img src="images\image-20250810095757382.png" width="70%" /></center>
<p>有时可能需要将整个数据集中的某个值完全替换，而不是只涉及特定的列。在这种情况下，可以再一次利用这种特殊语法，将一个布尔 DataFrame 作为参数（示例中再一次用到了 rainfall 这个 DataFrame）：</p>
<pre tabindex="0"><code>In [39]: # 先复制DataFrame，保持原本的DataFrame不变
		 rainfall2 = rainfall.copy()
		 rainfall2

In [40]: # 将小于400的值用0替换
		 rainfall2[rainfall2 &lt; 400] = 0
		 rainfall2
</code></pre><center><img src="images\image-20250810100216542.png" width="70%" /></center>

<h5 class="relative group">3. 通过替换值设置数据 
    <div id="3-通过替换值设置数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#3-%e9%80%9a%e8%bf%87%e6%9b%bf%e6%8d%a2%e5%80%bc%e8%ae%be%e7%bd%ae%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>如果想将整个 DataFrame（或者指定列）中的某个值全部替换成另一个值，那么可以使用 <strong>replace</strong> 方法：</p>
<pre tabindex="0"><code>In [41]: df2.replace(&#34;USA&#34;, &#34;U.S.&#34;)
</code></pre><center><img src="images\image-20250810100644745.png" width="70%" /></center>
<p>如果只想在 country 列上进行操作，则可以用这种语法：</p>
<pre tabindex="0"><code>df2.replace({&#34;country&#34;: {&#34;USA&#34;: &#34;U.S.&#34;}})
</code></pre>
<h5 class="relative group">4. 通过添加新列设置数据 
    <div id="4-通过添加新列设置数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#4-%e9%80%9a%e8%bf%87%e6%b7%bb%e5%8a%a0%e6%96%b0%e5%88%97%e8%ae%be%e7%bd%ae%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h5>
<p>为一个新的列名赋值时会为 DataFrame 添加一个新列。例如，利用一个标量或者列表可以为 DataFrame 添加新列：</p>
<pre tabindex="0"><code>In [42]: df2.loc[:, &#34;discount&#34;] = 0
		 df2.loc[:, &#34;price&#34;] = [49.9, 49.9, 99.9, 99.9]
		 df2
</code></pre><center><img src="images\image-20250810174455027.png" width="70%" /></center>
<p>添加新列时经常涉及向量化运算：</p>
<pre tabindex="0"><code>In [43]: df2 = df.copy() # 从一个新的副本开始
		 df2.loc[:, &#34;birth year&#34;] = 2021 - df2[&#34;age&#34;]
		 df2
</code></pre><center><img src="images\image-20250810174910857.png" width="100%" /></center>

<h4 class="relative group">5.2.3 缺失数据 
    <div id="523-缺失数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#523-%e7%bc%ba%e5%a4%b1%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>数据的缺失可能会对数据分析的结果造成影响，数据集中有空白是很常见的情况，并且你还不得不对其进行处理。在 Excel 中，你通常必须用空白单元格或者 #N/A 错误进行处理，不过 pandas 使用 NumPy 的 np.nan 代表缺失数据，显示为 NaN。NaN 是浮点数标准中的 <strong>Not-a-Number</strong>（非数字）。对于<strong>时间戳</strong>，则是使用 <strong>pd.NaT</strong>，而<strong>文本</strong>使用的是 <strong>None</strong>。可以使用 None 或者 np.nan 来表示缺失的值：</p>
<pre tabindex="0"><code>In [44]: df2 = df.copy() # 从一个新的副本开始
         df2.loc[1000, &#34;score&#34;] = None
         df2.loc[1003, :] = None
         df2
</code></pre><center><img src="images\image-20250810200155923.png" width="70%" /></center>
<p>在清理 DataFrame 时，你可能想要移除所有包含缺失数据的行。就这么简单：</p>
<pre tabindex="0"><code>In [45]: df2.dropna()
</code></pre><center><img src="images\image-20250810200433186.png" width="70%" /></center>
<p>如果只想移除所有值都缺失了的行，那么可以使用 how 参数：</p>
<pre tabindex="0"><code>In [46]: df2.dropna(how=&#34;all&#34;)
</code></pre><center><img src="images\image-20250810200607709.png" width="70%" /></center>
<p>想获得一个反映对应位置上是否是 NaN 的布尔 DataFrame 或 Series，可以使用 <strong>isna</strong> 方法：</p>
<pre tabindex="0"><code>In [47]: df2.isna()
</code></pre><center><img src="images\image-20250810200820311.png" width="70%" /></center>
<p>使用 fillna 来填补缺失的值。例如，将数据点数量列中的 NaN 替换为平均分：</p>
<pre tabindex="0"><code>In [48]: df2.fillna({&#34;score&#34;: df2[&#34;score&#34;].mean()})
</code></pre><center><img src="images\image-20250810201120896.png" width="70%" /></center>

<h4 class="relative group">5.2.4 重复数据 
    <div id="524-重复数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#524-%e9%87%8d%e5%a4%8d%e6%95%b0%e6%8d%ae" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>和缺失数据一样，重复数据也会对数据分析的可靠性造成负面影响。可以使用 <strong>drop_duplicates</strong> 方法来<strong>清理重复的行</strong>。也可以提供列的子集作为参数：</p>
<pre tabindex="0"><code>In [49]: df.drop_duplicates([&#34;country&#34;, &#34;continent&#34;])
</code></pre><center><img src="images\image-20250810201723093.png" width="70%" /></center>
<p>在默认情况下，<strong>第一次出现的数据会得以保留</strong>。<strong>is_unique</strong> 用于确认<strong>某一列是否包含重复数据</strong>，unique 则可以获得去重后的值。（如果想对索引进行此类操作，那么可以将 df[&ldquo;country&rdquo;] 换成 df.index。）</p>
<pre tabindex="0"><code>In [50]: df[&#34;country&#34;].is_unique

In [51]: df[&#34;country&#34;].unique()
</code></pre><center><img src="images\image-20250810202236059.png" width="70%" /></center>
<p>通过 <strong>duplicated 方法</strong>可以知道哪些行是<strong>重复</strong>的，它的返回值是一个<strong>布尔 Series</strong>。keep 参数的默认值是 &ldquo;first&rdquo;，意思是会保留第一次出现的数据，只将重复数据标记为 True。将 keep 设置为 False 时，所有的重复数据（包括第一次出现时）都会被标记为 True，这样就可以方便地得到一个包含所有重复行的 DataFrame。在下面的例子中，我们在找 country 列的重复数据，但在实际工作中，通常都是找重复的索引或者整行的重复数据。这个时候就要使用 df.index.duplicated() 或 df.duplicated()：</p>
<pre tabindex="0"><code>In [52]: # 在默认情况下，只有重复的行会被标记为True，
         # 即数据第一次出现时不会被标记为True
         df[&#34;country&#34;].duplicated()

In [53]: # 要找到所有&#34;country&#34;发生重复的行，
         # 可以将参数设置为keep=False
         df.loc[df[&#34;country&#34;].duplicated(keep=False), :]
</code></pre><center><img src="images\image-20250810202926848.png" width="70%" /></center>

<h4 class="relative group">5.2.5 算术运算 
    <div id="525-算术运算" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#525-%e7%ae%97%e6%9c%af%e8%bf%90%e7%ae%97" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>和 NumPy 数组一样，DataFrame 和 Series 也利用了<strong>向量化技术</strong>。例如，要为 rainfall 这个 DataFrame 中的每一个值加上一个数，只需像下面这样做：</p>
<pre tabindex="0"><code>In [54]: rainfall

In [55]: rainfall + 100
</code></pre><center><img src="images\image-20250810203227891.png" width="60%" /></center>
<p>不过 pandas 真正的强大之处是它的<strong>自动数据对齐</strong>（data alignment）机制：当你对多个 DataFrame 使用算术运算符时，pandas 会<strong>自动将它们按照列或行索引对齐</strong>。下面再创建一个和 rainfall 有相同行列标签的 DataFrame。然后求两者之和：</p>
<pre tabindex="0"><code>In [56]: more_rainfall = pd.DataFrame(data=[[100, 200], [300, 400]],
                                      index=[1,2],
                                      columns=[&#34;City 1&#34;, &#34;City 4&#34;])
         more_rainfall

In [57]: rainfall + more_rainfall
</code></pre><center><img src="images\image-20250810203751450.png" width="80%" /></center>
<p>结果 DataFrame 的索引和列是两个 DataFrame 的<strong>并集</strong>：两个 DataFrame 中<strong>都有的字段会被相加</strong>，而其他的部分会显示为 NaN。要让 pandas 和 Excel 以同样的方式处理这个问题，可以使用 <strong>add 方法</strong>，并将 fill_value 参数设置为 0 以代替默认的 NaN：</p>
<pre tabindex="0"><code>In [58]: rainfall.add(more_rainfall, fill_value=0)
</code></pre><center><img src="images\image-20250810204146297.png" width="80%" /></center>
<p>当算式的操作数是一个 DataFrame 和一个 Series 时，默认情况下 Series 会按<strong>索引</strong>进行<strong>广播</strong>：</p>
<pre tabindex="0"><code>In [59]: # 用一行数据生成一个Series
		 rainfall.loc[1, :]

In [60]: rainfall + rainfall.loc[1, :]
</code></pre><center><img src="images\image-20250810204618444.png" width="70%" /></center>
<p>如果要按列加上一个 Series，则需要在调用 add 方法时显式地提供 axis 参数：</p>
<pre tabindex="0"><code>In [61]: # 用一列数据生成一个Series
		 rainfall.loc[:, &#34;City 2&#34;]

In [62]: rainfall.add(rainfall.loc[:, &#34;City 2&#34;], axis=0)
</code></pre><center><img src="images\image-20250810205056384.png" width="80%" /></center>

<h4 class="relative group">5.2.6 处理文本列 
    <div id="526-处理文本列" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#526-%e5%a4%84%e7%90%86%e6%96%87%e6%9c%ac%e5%88%97" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>含有<strong>文本数据的列</strong>和含有<strong>不同类型数据的列</strong>的数据类型是 <strong>object</strong>。要在含有文本字符串的列上执行相关操作，需要使用 <strong>str 属性</strong>。str 属性可以访问 Python 的字符串方法。要<strong>移除字符串首尾的空白</strong>，可以使用 <strong>strip 方法</strong>；要<strong>将首字母大写</strong>，可以使用 <strong>capitalize 方法</strong>。将这些方法组合起来之后，可以将人工输入的乱七八糟的数据清理干净：</p>
<pre tabindex="0"><code>In [63]: # 来创建一个新的DataFrame
		 users = pd.DataFrame(data=[&#34; mArk &#34;, &#34;JOHN &#34;, &#34;Tim&#34;, &#34; jenny&#34;],
							  columns=[&#34;name&#34;])
		 users

In [64]: users_cleaned = users.loc[:,&#34;name&#34;].str.strip().str.capitalize()
		 users_cleaned
</code></pre><center><img src="images\image-20250811115530879.png" width="90%" /></center>
<p>可以像下面这样找到所有以“J”开头的名字：</p>
<pre tabindex="0"><code>In [65]: users_cleaned.str.startswith(&#34;J&#34;)
</code></pre><center><img src="images\image-20250811115813567.png" width="80%" /></center>
<p>字符串方法很好用，但是有时候要对 DataFrame 进行的操作可能并没有在对应的内置函数上。在这种情况下，你可以<strong>创建自己的函数</strong>，再将其应用到 DataFrame 上。</p>

<h4 class="relative group">5.2.7 应用函数 
    <div id="527-应用函数" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#527-%e5%ba%94%e7%94%a8%e5%87%bd%e6%95%b0" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>DataFrame 提供了 <strong>applymap 方法</strong>，它会将一个函数应用到每一个元素上，在 NumPy 没有提供所需的 ufunc 时，这是非常有用的。例如，NumPy 并没有提供<strong>字符串格式化的 ufunc</strong>，但可以像下面这样为 DataFrame 的每一个元素进行格式化：</p>
<pre tabindex="0"><code>In [66]: rainfall

In [67]: def format_string(x):
		 return f&#34;{x:,.2f}&#34;
In [68]: # 注意，我们并没有调用作为参数的函数，
         # 也就是说，这里写的是format_string而非format_string()！
         rainfall.applymap(format_string)
</code></pre><center><img src="images\image-20250811120731622.png" width="80%" /></center>
<p>这个 f 字符串会将 x 以字符串的形式返回：f&quot;{x}&quot;。要对其进行<strong>格式化</strong>，需要在变量后面加一个<strong>冒号</strong>，然后跟上具体的<strong>格式化字符串</strong>，这里使用的是 <strong>,.2f</strong>。这个<strong>逗号是千位上的分隔符</strong>，而 <strong>.2f 的意思是以浮点数格式显示，小数点后保留两位</strong>。</p>
<p>在这样的用例中会经常用到 <strong>lambda 表达式</strong>（参见“lambda 表达式”）。lambda 表达式可以让你<strong>在一行代码中编写一个函数，而不用单独去定义一个函数</strong>。通过 lambda 表达式，可以将前面的例子改写成下面这样。</p>
<pre tabindex="0"><code>In [69]: rainfall.applymap(lambda x: f&#34;{x:,.2f}&#34;)
</code></pre><center><img src="images\image-20250811173447170.png" width="80%" /></center>
<p><strong>lambda 表达式</strong>：lambda 表达式是一种<strong>匿名函数</strong>，也就是一种没有名称的函数。假设有这样一个函数：</p>
<pre tabindex="0"><code>def function_name(arg1, arg2, ...):
	return return_value
</code></pre><p>可以用 lambda 表达式重写这个函数：</p>
<pre tabindex="0"><code>lambda arg1, arg2, ...: return_value
</code></pre><p>简而言之，把 def 换成 lambda，省去 return 关键字，然后将函数的所有内容写到一行。</p>

<h4 class="relative group">5.2.8 视图和副本 
    <div id="528-视图和副本" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#528-%e8%a7%86%e5%9b%be%e5%92%8c%e5%89%af%e6%9c%ac" aria-label="锚点">#</a>
    </span>        
    
</h4>
<p>由于修改视图和修改副本有着本质的区别，因此当 pandas 认为你在<strong>无意中修改数据</strong>时，它会发出警告：<strong>SettingWithCopyWarning</strong>。关于如何规避这个相当难以捉摸的警告，下面是一些建议。</p>
<p>• 在原本的 DataFrame 中设置值，而不是在切片生成的 DataFrame 中操作。</p>
<p>• 如果你想在切片后获得一个单独的 DataFrame，则应该显式地调用 copy。</p>
<pre tabindex="0"><code>selection = df.loc[:, [&#34;country&#34;, &#34;continent&#34;]].copy()
</code></pre><p>虽然 loc 和 iloc 的情况很复杂，但是记得一点，诸如 df.dropna() 或 df.sort_value(&ldquo;column_name&rdquo;) 这样的 DataFrame 方法总是<strong>返回副本</strong>。</p>

          
          
          
        </div>
        
          
  
  
  
  
  
  

  

  
    
    
<div class="flex author">
  
    
    
      
    
    
      
        
      
      <img
        class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4"
        width="96"
        height="96"
        alt="Cloud_Shy"
        src="/img/Cloud_Shy_hu_6364bf0b0608bdf4.png">
    
  
  <div class="place-self-center">
    
      <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
        作者
      </div>
      <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
        Cloud_Shy
      </div>
    
    
      <div class="text-sm text-neutral-700 dark:text-neutral-400">Don&rsquo;t be shy, dare to share！</div>
    
    <div class="text-2xl sm:text-lg">
</div>
  </div>
</div>

  

  

  
    <div class="mb-10"></div>
  

        
        

        

        

      </div>

      
      
        
        
          
          
        
        
        
        <script
          type="text/javascript"
          src="/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js"
          integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA=="
          data-oid="views_posts\Excel Python：飞速搞定数据分析与处理之 Pandas 入门笔记\index.md"
          data-oid-likes="likes_posts\Excel Python：飞速搞定数据分析与处理之 Pandas 入门笔记\index.md"></script>
      
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600">
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/posts/excel-python%E9%A3%9E%E9%80%9F%E6%90%9E%E5%AE%9A%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%84%E7%90%86%E4%B9%8B-python-%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Excel Python:飞速搞定数据分析与处理之 Python 入门笔记</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-06-18T10:28:11&#43;08:00">2024-06-18</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/posts/vmware-workstation-%E5%AE%89%E8%A3%85%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%8C%87%E5%8D%97/">
              <span class="flex flex-col">
                <span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >VMware Workstation 安装虚拟机指南</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2025-04-15T10:28:11&#43;08:00">2025-04-15</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0 z-10">
  <a
    href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="返回顶部"
    title="返回顶部">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
      
      
        
          
          
      
      
      
      <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 ">
        <ul class="flex list-none flex-col sm:flex-row">
          
            <li class=" flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0 ">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href="/tags/"
                title="标签">
                
                标签
              </a>
            </li>
          
            <li class=" flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0 ">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href="/authors/"
                title="作者介绍">
                
                作者
              </a>
            </li>
          
        </ul>
      </nav>
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          &copy;
          2025
          Cloud_Shy
      </p>
    

    
    
      <p class="text-xs text-neutral-500 dark:text-neutral-400">
        
        
        由 <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a> 强力驱动
      </p>
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
  <script
    type="text/javascript"
    src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js"
    integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="https://teliduxingdimiao.github.io/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="搜索"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="关闭 (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>
